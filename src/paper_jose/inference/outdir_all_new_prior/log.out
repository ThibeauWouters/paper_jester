Sun Dec 29 17:33:11 CET 2024
NVIDIA A100-SXM4-40GB
2024-12-29 17:33:14.434322: W external/xla/xla/service/gpu/nvptx_compiler.cc:836] The NVIDIA driver's CUDA version is 12.5 which is older than the PTX compiler version (12.6.85). Because the driver is older than the PTX compiler version, XLA is disabling parallel compilation, which may slow down compilation. You should update your NVIDIA driver or use the NVIDIA-provided CUDA forward compatibility packages.
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Using the constrained EOS prior
Fixed params loaded inside the MicroToMacroTransform:
    Q_sym: 0.0
    Z_sym: 0.0
    E_sat: -16.0
    Q_sat: 0.0
    Z_sat: 0.0
Loading data necessary for the event GW170817
Loading data necessary for the event J0030 and sampling the with NICER masses
Loading data necessary for the event J0740 and sampling the with NICER masses
Not sampling PREX or CREX data now
Loading data necessary for the Chiral EFT
Sanity checking: likelihoods_list = [<paper_jose.utils.GWlikelihood_with_masses object at 0x14b6c3d2f8b0>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14b6c01f3940>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14b6c0ee6e00>, <paper_jose.utils.RadioTimingLikelihood object at 0x14bf4c3199c0>, <paper_jose.utils.RadioTimingLikelihood object at 0x14bf4c3198a0>, <paper_jose.utils.RadioTimingLikelihood object at 0x14bf4c319990>, <paper_jose.utils.ChiEFTLikelihood object at 0x14bf4c31b340>]
len(likelihoods_list) = 7
Fixed params loaded inside the MicroToMacroTransform:
    Q_sym: 0.0
    Z_sym: 0.0
    E_sat: -16.0
    Q_sat: 0.0
    Z_sat: 0.0
We are going to give these kwargs to Jim:
{'n_loop_training': 20, 'n_loop_production': 20, 'n_chains': 1000, 'n_local_steps': 2, 'n_global_steps': 100, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 5}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'K_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
log_prob
[-1.00001109e+07 -1.02689255e+02 -1.49650764e+02]
Sampling seed is set to: 11
Global Tuning:   0%|          | 0/20 [00:00<?, ?it/s]Global Tuning:   5%|▌         | 1/20 [03:20<1:03:32, 200.67s/it]Global Tuning:  10%|█         | 2/20 [04:47<40:04, 133.58s/it]  Global Tuning:  15%|█▌        | 3/20 [06:10<31:22, 110.75s/it]Global Tuning:  20%|██        | 4/20 [07:32<26:29, 99.35s/it] Global Tuning:  25%|██▌       | 5/20 [08:57<23:30, 94.02s/it]Global Tuning:  30%|███       | 6/20 [10:24<21:25, 91.85s/it]Global Tuning:  35%|███▌      | 7/20 [11:49<19:24, 89.60s/it]Global Tuning:  40%|████      | 8/20 [13:22<18:07, 90.66s/it]Global Tuning:  45%|████▌     | 9/20 [14:55<16:45, 91.41s/it]Global Tuning:  50%|█████     | 10/20 [16:32<15:29, 92.92s/it]Global Tuning:  55%|█████▌    | 11/20 [18:12<14:17, 95.27s/it]Global Tuning:  60%|██████    | 12/20 [20:02<13:17, 99.63s/it]Global Tuning:  65%|██████▌   | 13/20 [21:47<11:49, 101.29s/it]Global Tuning:  70%|███████   | 14/20 [23:17<09:46, 97.83s/it] Global Tuning:  75%|███████▌  | 15/20 [24:49<08:01, 96.23s/it]Global Tuning:  80%|████████  | 16/20 [26:21<06:19, 94.79s/it]Global Tuning:  85%|████████▌ | 17/20 [27:58<04:46, 95.58s/it]Global Tuning:  90%|█████████ | 18/20 [29:28<03:07, 93.73s/it]Global Tuning:  95%|█████████▌| 19/20 [30:57<01:32, 92.39s/it]Global Tuning: 100%|██████████| 20/20 [32:35<00:00, 94.09s/it]Global Tuning: 100%|██████████| 20/20 [32:35<00:00, 97.77s/it]
Compiling MALA body
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [01:35<30:22, 95.90s/it]Global Sampling:  10%|█         | 2/20 [03:18<29:53, 99.63s/it]Global Sampling:  15%|█▌        | 3/20 [04:51<27:27, 96.90s/it]Global Sampling:  20%|██        | 4/20 [06:23<25:16, 94.79s/it]Global Sampling:  25%|██▌       | 5/20 [07:57<23:38, 94.55s/it]Global Sampling:  30%|███       | 6/20 [09:29<21:51, 93.66s/it]Global Sampling:  35%|███▌      | 7/20 [10:59<20:04, 92.65s/it]Global Sampling:  40%|████      | 8/20 [12:30<18:21, 91.82s/it]Global Sampling:  45%|████▌     | 9/20 [14:04<16:58, 92.62s/it]Global Sampling:  50%|█████     | 10/20 [15:41<15:40, 94.09s/it]Global Sampling:  55%|█████▌    | 11/20 [17:31<14:48, 98.77s/it]Global Sampling:  60%|██████    | 12/20 [19:04<12:56, 97.07s/it]Global Sampling:  65%|██████▌   | 13/20 [20:37<11:11, 95.90s/it]Global Sampling:  70%|███████   | 14/20 [22:05<09:21, 93.52s/it]Global Sampling:  75%|███████▌  | 15/20 [23:35<07:42, 92.49s/it]Global Sampling:  80%|████████  | 16/20 [25:06<06:07, 91.94s/it]Global Sampling:  85%|████████▌ | 17/20 [26:58<04:54, 98.07s/it]Global Sampling:  90%|█████████ | 18/20 [28:26<03:10, 95.00s/it]Global Sampling:  95%|█████████▌| 19/20 [29:57<01:33, 93.69s/it]Global Sampling: 100%|██████████| 20/20 [31:26<00:00, 92.29s/it]Global Sampling: 100%|██████████| 20/20 [31:26<00:00, 94.31s/it]
Training summary
==========
E_sym: 35.005 +/- 0.564
L_sym: 59.052 +/- 6.245
K_sym: -0.446 +/- 5.676
K_sat: 229.541 +/- 5.717
nbreak: 0.236 +/- 0.045
n_CSE_0_u: 0.485 +/- 0.285
cs2_CSE_0: 0.648 +/- 0.226
n_CSE_1_u: 0.484 +/- 0.283
cs2_CSE_1: 0.537 +/- 0.279
n_CSE_2_u: 0.487 +/- 0.286
cs2_CSE_2: 0.503 +/- 0.283
n_CSE_3_u: 0.491 +/- 0.283
cs2_CSE_3: 0.501 +/- 0.285
n_CSE_4_u: 0.487 +/- 0.288
cs2_CSE_4: 0.491 +/- 0.280
n_CSE_5_u: 0.486 +/- 0.287
cs2_CSE_5: 0.505 +/- 0.285
n_CSE_6_u: 0.491 +/- 0.286
cs2_CSE_6: 0.499 +/- 0.284
n_CSE_7_u: 0.488 +/- 0.287
cs2_CSE_7: 0.492 +/- 0.284
cs2_CSE_8: 0.510 +/- 0.287
mass_1_GW170817: 1.505 +/- 0.105
mass_2_GW170817: 1.251 +/- 0.077
mass_J0030: 1.426 +/- 0.139
mass_J0740: 2.034 +/- 0.102
Log probability: -28705.498 +/- 610765.286
Local acceptance: 0.965 +/- 0.183
Global acceptance: 0.093 +/- 0.291
Max loss: 43.067, Min loss: 29.785
Production summary
==========
E_sym: 35.017 +/- 0.576
L_sym: 58.426 +/- 6.061
K_sym: -0.840 +/- 5.733
K_sat: 229.778 +/- 5.740
nbreak: 0.234 +/- 0.045
n_CSE_0_u: 0.493 +/- 0.285
cs2_CSE_0: 0.631 +/- 0.239
n_CSE_1_u: 0.489 +/- 0.288
cs2_CSE_1: 0.546 +/- 0.287
n_CSE_2_u: 0.484 +/- 0.288
cs2_CSE_2: 0.495 +/- 0.298
n_CSE_3_u: 0.482 +/- 0.288
cs2_CSE_3: 0.494 +/- 0.287
n_CSE_4_u: 0.481 +/- 0.287
cs2_CSE_4: 0.487 +/- 0.295
n_CSE_5_u: 0.495 +/- 0.285
cs2_CSE_5: 0.528 +/- 0.293
n_CSE_6_u: 0.514 +/- 0.295
cs2_CSE_6: 0.484 +/- 0.284
n_CSE_7_u: 0.481 +/- 0.290
cs2_CSE_7: 0.504 +/- 0.287
cs2_CSE_8: 0.529 +/- 0.291
mass_1_GW170817: 1.487 +/- 0.086
mass_2_GW170817: 1.259 +/- 0.068
mass_J0030: 1.423 +/- 0.117
mass_J0740: 2.046 +/- 0.073
Log probability: -30.680 +/- 2.074
Local acceptance: 0.949 +/- 0.219
Global acceptance: 0.067 +/- 0.249
S has been successful, now we will do some postprocessing. Sampling time: roughly 65 mins
Saving the final results
Number of samples generated in training: 420000
Number of samples generated in production: 420000
Number of samples generated: 840000
Time taken for TOV map: 49.58543300628662 s
DONE entire script
suffix
all_new_prior
Checking the convergence for outdir_all_new_prior
list(data.keys())
['log_prob', 'E_sym', 'L_sym', 'K_sym', 'K_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
Key: E_sym
    rhat = 1.076256771292224
    ess = 8318.55542388178
Key: L_sym
    rhat = 1.0715295659228115
    ess = 8579.070858824713
Key: K_sym
    rhat = 1.0841446165398203
    ess = 7488.578508945899
Key: K_sat
    rhat = 1.078114325854296
    ess = 8180.273267412223
Key: nbreak
    rhat = 1.0739943831251095
    ess = 8582.90469167052
Key: n_CSE_0_u
    rhat = 1.072967870708
    ess = 8446.009929327609
Key: cs2_CSE_0
    rhat = 1.121421283994701
    ess = 5289.139138446657
Key: n_CSE_1_u
    rhat = 1.0793799052465693
    ess = 7841.173856040542
Key: cs2_CSE_1
    rhat = 1.0843556314955964
    ess = 7486.251375464386
Key: n_CSE_2_u
    rhat = 1.0822850756182307
    ess = 8031.320238171513
Key: cs2_CSE_2
    rhat = 1.0959275750503197
    ess = 6603.8104283393495
Key: n_CSE_3_u
    rhat = 1.077561084079735
    ess = 8088.965658716366
Key: cs2_CSE_3
    rhat = 1.0711881521135957
    ess = 8963.327875724694
Key: n_CSE_4_u
    rhat = 1.083153861657639
    ess = 7489.394787496182
Key: cs2_CSE_4
    rhat = 1.082458201867482
    ess = 7669.427890848705
Key: n_CSE_5_u
    rhat = 1.0786008759946248
    ess = 7957.1518947765135
Key: cs2_CSE_5
    rhat = 1.0865697712656568
    ess = 7222.202614028915
Key: n_CSE_6_u
    rhat = 1.1004081029966362
    ess = 6289.267995296145
Key: cs2_CSE_6
    rhat = 1.0667684214792452
    ess = 9506.296241334274
Key: n_CSE_7_u
    rhat = 1.091787753024761
    ess = 6745.843091038016
Key: cs2_CSE_7
    rhat = 1.0746810362304802
    ess = 8541.180843968765
Key: cs2_CSE_8
    rhat = 1.082531159404762
    ess = 7709.88836797944
Key: mass_1_GW170817
    rhat = 1.0796929102966761
    ess = 7718.63574063739
Key: mass_2_GW170817
    rhat = 1.0822879331649478
    ess = 7491.57826370649
Key: mass_J0030
    rhat = 1.0885352331340201
    ess = 6996.802343243909
Key: mass_J0740
    rhat = 1.07088973427401
    ess = 9444.826110616927
Making plots for outdir_all_new_prior
Number of samples: 100000
Creating NS plot . . .
  0%|          | 0/3001 [00:00<?, ?it/s]  2%|▏         | 75/3001 [00:00<00:03, 744.90it/s]  5%|▌         | 153/3001 [00:00<00:03, 761.50it/s]  8%|▊         | 231/3001 [00:00<00:03, 767.99it/s] 10%|█         | 308/3001 [00:00<00:04, 596.83it/s] 13%|█▎        | 386/3001 [00:00<00:04, 652.27it/s] 15%|█▌        | 465/3001 [00:00<00:03, 691.69it/s] 18%|█▊        | 544/3001 [00:00<00:03, 720.57it/s] 21%|██        | 624/3001 [00:00<00:03, 743.23it/s] 23%|██▎       | 704/3001 [00:00<00:03, 757.66it/s] 26%|██▌       | 783/3001 [00:01<00:02, 766.35it/s] 29%|██▉       | 863/3001 [00:01<00:02, 774.62it/s] 31%|███▏      | 942/3001 [00:01<00:03, 620.35it/s] 34%|███▍      | 1021/3001 [00:01<00:02, 662.80it/s] 37%|███▋      | 1101/3001 [00:01<00:02, 698.21it/s] 39%|███▉      | 1181/3001 [00:01<00:02, 723.89it/s] 42%|████▏     | 1261/3001 [00:01<00:02, 743.52it/s] 45%|████▍     | 1341/3001 [00:01<00:02, 757.52it/s] 47%|████▋     | 1420/3001 [00:01<00:02, 766.02it/s] 50%|████▉     | 1500/3001 [00:02<00:01, 775.21it/s] 53%|█████▎    | 1580/3001 [00:02<00:01, 781.33it/s] 55%|█████▌    | 1659/3001 [00:02<00:02, 599.73it/s] 58%|█████▊    | 1739/3001 [00:02<00:01, 648.11it/s] 61%|██████    | 1819/3001 [00:02<00:01, 685.33it/s] 63%|██████▎   | 1899/3001 [00:02<00:01, 714.88it/s] 66%|██████▌   | 1979/3001 [00:02<00:01, 737.53it/s] 69%|██████▊   | 2059/3001 [00:02<00:01, 752.90it/s] 71%|███████▏  | 2139/3001 [00:02<00:01, 764.78it/s] 74%|███████▍  | 2219/3001 [00:03<00:01, 774.14it/s] 77%|███████▋  | 2299/3001 [00:03<00:00, 779.36it/s] 79%|███████▉  | 2379/3001 [00:03<00:00, 785.10it/s] 82%|████████▏ | 2459/3001 [00:03<00:00, 788.10it/s] 85%|████████▍ | 2539/3001 [00:03<00:00, 574.43it/s] 87%|████████▋ | 2619/3001 [00:03<00:00, 627.07it/s] 90%|████████▉ | 2698/3001 [00:03<00:00, 667.02it/s] 93%|█████████▎| 2778/3001 [00:03<00:00, 701.24it/s] 95%|█████████▌| 2859/3001 [00:04<00:00, 728.98it/s] 98%|█████████▊| 2939/3001 [00:04<00:00, 747.38it/s]100%|██████████| 3001/3001 [00:04<00:00, 716.26it/s]
Bad counter: 0
Creating NS plot . . . DONE
Reading Hauke data
Loading weights from /home/twouters2/hauke_eos/weights/all.txt
Weights at these bad indices
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
Shape of mtov_list: (99941,)
Shape of r14_list: (99941,)
Shape of l14_list: (99941,)
Shape of ntov_list: (0,)
Shape of p3nsat_list: (99941,)
np.shape(weights)
(99941,)
Reading Hauke data DONE
Creating histograms . . .
  0%|          | 0/100000 [00:00<?, ?it/s]  4%|▍         | 4121/100000 [00:00<00:02, 41207.29it/s]  8%|▊         | 8284/100000 [00:00<00:02, 41452.76it/s] 12%|█▏        | 12449/100000 [00:00<00:02, 41540.17it/s] 17%|█▋        | 16604/100000 [00:00<00:02, 41508.28it/s] 21%|██        | 20761/100000 [00:00<00:01, 41527.68it/s] 25%|██▍       | 24916/100000 [00:00<00:01, 41533.80it/s] 29%|██▉       | 29070/100000 [00:00<00:01, 41494.62it/s] 33%|███▎      | 33220/100000 [00:00<00:01, 41430.55it/s] 37%|███▋      | 37365/100000 [00:00<00:01, 41433.92it/s] 42%|████▏     | 41509/100000 [00:01<00:01, 41422.20it/s] 46%|████▌     | 45665/100000 [00:01<00:01, 41461.59it/s] 50%|████▉     | 49812/100000 [00:01<00:01, 41433.14it/s] 54%|█████▍    | 53956/100000 [00:01<00:01, 41412.16it/s] 58%|█████▊    | 58098/100000 [00:01<00:01, 41408.19it/s] 62%|██████▏   | 62245/100000 [00:01<00:00, 41424.47it/s] 66%|██████▋   | 66388/100000 [00:01<00:00, 41388.45it/s] 71%|███████   | 70527/100000 [00:01<00:00, 41339.34it/s] 75%|███████▍  | 74663/100000 [00:01<00:00, 41343.36it/s] 79%|███████▉  | 78800/100000 [00:01<00:00, 41348.20it/s] 83%|████████▎ | 82935/100000 [00:02<00:00, 41316.84it/s] 87%|████████▋ | 87078/100000 [00:02<00:00, 41349.42it/s] 91%|█████████ | 91213/100000 [00:02<00:00, 41287.91it/s] 95%|█████████▌| 95343/100000 [00:02<00:00, 41289.27it/s] 99%|█████████▉| 99472/100000 [00:02<00:00, 41261.58it/s]100%|██████████| 100000/100000 [00:02<00:00, 41380.27it/s]
/home/twouters2/miniconda3/envs/jose/lib/python3.10/site-packages/numpy/lib/function_base.py:2897: RuntimeWarning: invalid value encountered in divide
  c /= stddev[:, None]
/home/twouters2/miniconda3/envs/jose/lib/python3.10/site-packages/numpy/lib/function_base.py:2898: RuntimeWarning: invalid value encountered in divide
  c /= stddev[None, :]
Negative counter: 0
Mass at 2 nsat: 0.98-0.27+0.42
TOV mass: 2.22-0.22+0.37
R1.4: 13.24-0.59+0.73
n_TOV: 5.9537 - 1.6178 + 1.1728
p3nsat: 92.71-33.11+68.64
This is the all-constraints run. Therefore, we also make the master plot!
Percentage of EOS samples that are above 0.33: 99.94%
NEP Correlation coefficients:
    E_sym - L_sym: 0.004164298248338764
    E_sym - K_sym: -0.0056831765935600916
    E_sym - Q_sym: nan
    E_sym - Z_sym: nan
    E_sym - K_sat: -0.013391410996822402
    E_sym - Q_sat: nan
    E_sym - Z_sat: nan
    L_sym - K_sym: -0.002181825041474013
    L_sym - Q_sym: nan
    L_sym - Z_sym: nan
    L_sym - K_sat: 0.009867232368184415
    L_sym - Q_sat: nan
    L_sym - Z_sat: nan
    K_sym - Q_sym: nan
    K_sym - Z_sym: nan
    K_sym - K_sat: -0.016886009365753938
    K_sym - Q_sat: nan
    K_sym - Z_sat: nan
    Q_sym - Z_sym: nan
    Q_sym - K_sat: nan
    Q_sym - Q_sat: nan
    Q_sym - Z_sat: nan
    Z_sym - K_sat: nan
    Z_sym - Q_sat: nan
    Z_sym - Z_sat: nan
    K_sat - Q_sat: nan
    K_sat - Z_sat: nan
    Q_sat - Z_sat: nan
Maximal corrcoef: 0.009867232368184415
Minimal corrcoef: -0.016886009365753938
NEP Posterior to prior ratios:
Posterior to prior ratios
    E_sym: 0.1175066599785323
    L_sym: 0.15043270527739266
    K_sym: 0.049624943069960674
    Q_sym: 0.0
    Z_sym: 0.0
    K_sat: 0.13229972858136602
    Q_sat: 0.0
    Z_sat: 0.0
Maximal posterior to prior ratio: 0.15043270527739266
Minimal posterior to prior ratio: 0.0
E_sym: 35.02-0.91+0.98
L_sym: 57.18-7.17+12.92
K_sym: -1.10-8.90+9.81
Q_sym: 0.00-0.00+0.00
Z_sym: 0.00-0.00+0.00
K_sat: 229.44-8.29+10.56
Q_sat: 0.00-0.00+0.00
Z_sat: 0.00-0.00+0.00
Going to report the NEPs
DONE

JOB STATISTICS
==============
Job ID: 9181301
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 01:08:57
CPU Efficiency: 5.61% of 20:30:00 core-walltime
Job Wall-clock time: 01:08:20
Memory Utilized: 4.58 GB
Memory Efficiency: 15.27% of 30.00 GB
