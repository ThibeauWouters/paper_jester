Thu Mar  6 11:27:14 CET 2025
NVIDIA H100
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Using the broad EOS prior
Using the regular nbreak prior: U[1.0, 2.0] * 0.16
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Loading data necessary for the event GW170817
Using GW170817 inference with agnostic prior
Loading data necessary for the event J0030 and sampling the with NICER masses
Loading data necessary for the event J0740 and sampling the with NICER masses
Not sampling PREX or CREX data now
Loading data necessary for the Chiral EFT
Sanity checking: likelihoods_list = [<paper_jose.utils.GWlikelihood_with_masses object at 0x14c958863b50>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14b34eb3d0f0>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14b34e97d990>, <paper_jose.utils.RadioTimingLikelihood object at 0x14b34f7abb20>, <paper_jose.utils.RadioTimingLikelihood object at 0x14b34f65ff70>, <paper_jose.utils.RadioTimingLikelihood object at 0x14b34eb805e0>, <paper_jose.utils.ChiEFTLikelihood object at 0x14b34eb80370>]
len(likelihoods_list) = 7
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
We are going to give these kwargs to Jim:
{'n_loop_training': 20, 'n_loop_production': 20, 'n_chains': 1000, 'n_local_steps': 2, 'n_global_steps': 100, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 5}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT  cs2 grids square WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT 
log_prob
[-538.73058434 -378.88540923 -118.11355035]
Sampling seed is set to: 11
Global Tuning:   0%|          | 0/20 [00:00<?, ?it/s]Global Tuning:   5%|▌         | 1/20 [03:00<57:00, 180.05s/it]Global Tuning:  10%|█         | 2/20 [04:11<34:47, 115.97s/it]Global Tuning:  15%|█▌        | 3/20 [05:09<25:23, 89.59s/it] Global Tuning:  20%|██        | 4/20 [06:12<21:06, 79.13s/it]Global Tuning:  25%|██▌       | 5/20 [07:20<18:48, 75.24s/it]Global Tuning:  30%|███       | 6/20 [08:28<16:56, 72.63s/it]Global Tuning:  35%|███▌      | 7/20 [09:39<15:39, 72.27s/it]Global Tuning:  40%|████      | 8/20 [10:52<14:26, 72.23s/it]Global Tuning:  45%|████▌     | 9/20 [12:06<13:20, 72.81s/it]Global Tuning:  50%|█████     | 10/20 [13:27<12:33, 75.39s/it]Global Tuning:  55%|█████▌    | 11/20 [14:40<11:11, 74.60s/it]Global Tuning:  60%|██████    | 12/20 [16:05<10:23, 77.90s/it]Global Tuning:  65%|██████▌   | 13/20 [17:27<09:13, 79.12s/it]Global Tuning:  70%|███████   | 14/20 [18:45<07:52, 78.72s/it]Global Tuning:  75%|███████▌  | 15/20 [20:05<06:36, 79.28s/it]Global Tuning:  80%|████████  | 16/20 [21:30<05:23, 80.86s/it]Global Tuning:  85%|████████▌ | 17/20 [22:44<03:56, 78.90s/it]Global Tuning:  90%|█████████ | 18/20 [23:58<02:34, 77.42s/it]Global Tuning:  95%|█████████▌| 19/20 [25:13<01:16, 76.54s/it]Global Tuning: 100%|██████████| 20/20 [26:27<00:00, 76.01s/it]Global Tuning: 100%|██████████| 20/20 [26:27<00:00, 79.40s/it]
WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT  cs2 grids square WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT 
Compiling MALA body
WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT  cs2 grids square WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT 
WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT  cs2 grids square WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT 
WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT  cs2 grids square WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT 
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [01:12<22:59, 72.60s/it]Global Sampling:  10%|█         | 2/20 [02:27<22:09, 73.88s/it]Global Sampling:  15%|█▌        | 3/20 [03:40<20:50, 73.57s/it]Global Sampling:  20%|██        | 4/20 [04:55<19:44, 74.06s/it]Global Sampling:  25%|██▌       | 5/20 [06:12<18:46, 75.10s/it]Global Sampling:  30%|███       | 6/20 [07:28<17:35, 75.36s/it]Global Sampling:  35%|███▌      | 7/20 [08:47<16:36, 76.66s/it]Global Sampling:  40%|████      | 8/20 [10:07<15:30, 77.56s/it]Global Sampling:  45%|████▌     | 9/20 [11:25<14:16, 77.83s/it]Global Sampling:  50%|█████     | 10/20 [12:43<12:58, 77.81s/it]Global Sampling:  55%|█████▌    | 11/20 [13:58<11:32, 76.93s/it]Global Sampling:  60%|██████    | 12/20 [15:12<10:09, 76.17s/it]Global Sampling:  65%|██████▌   | 13/20 [16:28<08:51, 75.95s/it]Global Sampling:  70%|███████   | 14/20 [17:42<07:32, 75.40s/it]Global Sampling:  75%|███████▌  | 15/20 [18:55<06:13, 74.63s/it]Global Sampling:  80%|████████  | 16/20 [20:15<05:05, 76.38s/it]Global Sampling:  85%|████████▌ | 17/20 [21:29<03:46, 75.61s/it]Global Sampling:  90%|█████████ | 18/20 [22:49<02:33, 76.94s/it]Global Sampling:  95%|█████████▌| 19/20 [24:04<01:16, 76.56s/it]Global Sampling: 100%|██████████| 20/20 [25:16<00:00, 75.14s/it]Global Sampling: 100%|██████████| 20/20 [25:16<00:00, 75.84s/it]
Training summary
==========
E_sym: 36.671 +/- 4.794
L_sym: 50.045 +/- 28.132
K_sym: -129.376 +/- 106.200
Q_sym: 10.947 +/- 451.870
Z_sym: -513.991 +/- 1129.531
K_sat: 218.406 +/- 42.332
Q_sat: 290.003 +/- 447.834
Z_sat: -495.902 +/- 1132.526
nbreak: 0.248 +/- 0.043
n_CSE_0_u: 0.487 +/- 0.288
cs2_CSE_0: 0.790 +/- 0.160
n_CSE_1_u: 0.484 +/- 0.290
cs2_CSE_1: 0.564 +/- 0.281
n_CSE_2_u: 0.476 +/- 0.291
cs2_CSE_2: 0.509 +/- 0.285
n_CSE_3_u: 0.472 +/- 0.289
cs2_CSE_3: 0.501 +/- 0.282
n_CSE_4_u: 0.475 +/- 0.292
cs2_CSE_4: 0.509 +/- 0.280
n_CSE_5_u: 0.473 +/- 0.295
cs2_CSE_5: 0.504 +/- 0.283
n_CSE_6_u: 0.469 +/- 0.291
cs2_CSE_6: 0.496 +/- 0.280
n_CSE_7_u: 0.473 +/- 0.289
cs2_CSE_7: 0.501 +/- 0.281
cs2_CSE_8: 0.495 +/- 0.284
mass_1_GW170817: 1.512 +/- 0.110
mass_2_GW170817: 1.248 +/- 0.080
mass_J0030: 1.373 +/- 0.151
mass_J0740: 2.029 +/- 0.107
Log probability: -73801.805 +/- 1065241.574
Local acceptance: 0.956 +/- 0.204
Global acceptance: 0.068 +/- 0.252
Max loss: 51.034, Min loss: 34.384
Production summary
==========
E_sym: 36.767 +/- 4.922
L_sym: 45.956 +/- 24.513
K_sym: -138.047 +/- 107.372
Q_sym: -20.740 +/- 472.959
Z_sym: -534.061 +/- 1160.324
K_sat: 220.349 +/- 43.578
Q_sat: 253.321 +/- 451.942
Z_sat: -495.865 +/- 1155.620
nbreak: 0.245 +/- 0.045
n_CSE_0_u: 0.493 +/- 0.303
cs2_CSE_0: 0.766 +/- 0.184
n_CSE_1_u: 0.473 +/- 0.298
cs2_CSE_1: 0.590 +/- 0.298
n_CSE_2_u: 0.480 +/- 0.299
cs2_CSE_2: 0.501 +/- 0.287
n_CSE_3_u: 0.481 +/- 0.295
cs2_CSE_3: 0.492 +/- 0.290
n_CSE_4_u: 0.476 +/- 0.292
cs2_CSE_4: 0.495 +/- 0.289
n_CSE_5_u: 0.471 +/- 0.297
cs2_CSE_5: 0.501 +/- 0.288
n_CSE_6_u: 0.479 +/- 0.295
cs2_CSE_6: 0.502 +/- 0.286
n_CSE_7_u: 0.483 +/- 0.293
cs2_CSE_7: 0.525 +/- 0.292
cs2_CSE_8: 0.490 +/- 0.287
mass_1_GW170817: 1.507 +/- 0.099
mass_2_GW170817: 1.245 +/- 0.076
mass_J0030: 1.362 +/- 0.123
mass_J0740: 2.042 +/- 0.075
Log probability: -69.631 +/- 1.985
Local acceptance: 0.935 +/- 0.247
Global acceptance: 0.044 +/- 0.206
S has been successful, now we will do some postprocessing. Sampling time: roughly 53 mins
Saving the final results
Number of samples generated in training: 420000
Number of samples generated in production: 420000
Number of samples generated: 840000
WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT  cs2 grids square WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT WATCH OUT 
Time taken for TOV map: 2.912961483001709 s
DONE entire script
suffix
all
Checking the convergence for outdir_all
list(data.keys())
['log_prob', 'E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
Key: E_sym
    rhat = 1.1132424380624657
    ess = 5719.246089771814
Key: L_sym
    rhat = 1.1296239741277618
    ess = 5020.188931466028
Key: K_sym
    rhat = 1.123699292633066
    ess = 5282.237751933165
Key: Q_sym
    rhat = 1.143070657329339
    ess = 4599.49090433475
Key: Z_sym
    rhat = 1.1195660108963124
    ess = 5404.608719733733
Key: K_sat
    rhat = 1.1166013995261594
    ess = 5623.985717951906
Key: Q_sat
    rhat = 1.1072474766418325
    ess = 6072.372166968357
Key: Z_sat
    rhat = 1.1155007106263646
    ess = 5892.032332983719
Key: nbreak
    rhat = 1.122721794155946
    ess = 5329.565245605013
Key: n_CSE_0_u
    rhat = 1.1254713555159734
    ess = 5178.6167666493375
Key: cs2_CSE_0
    rhat = 1.1610093615741954
    ess = 4207.1707305196815
Key: n_CSE_1_u
    rhat = 1.1232110065165897
    ess = 5247.2289461061755
Key: cs2_CSE_1
    rhat = 1.139463189163261
    ess = 4729.988373794989
Key: n_CSE_2_u
    rhat = 1.1251009450811866
    ess = 5289.470350837964
Key: cs2_CSE_2
    rhat = 1.1024866419594364
    ess = 6252.36361323097
Key: n_CSE_3_u
    rhat = 1.11194771703438
    ess = 5763.118906355536
Key: cs2_CSE_3
    rhat = 1.117784915244096
    ess = 5429.148081990963
Key: n_CSE_4_u
    rhat = 1.1096065720985415
    ess = 5791.417345601157
Key: cs2_CSE_4
    rhat = 1.1177179866467912
    ess = 5536.184486861023
Key: n_CSE_5_u
    rhat = 1.1328088195440054
    ess = 4916.525192872976
Key: cs2_CSE_5
    rhat = 1.1042224430679708
    ess = 6306.873279717689
Key: n_CSE_6_u
    rhat = 1.1171058687362723
    ess = 5531.216745480548
Key: cs2_CSE_6
    rhat = 1.107324948134822
    ess = 5994.819690511138
Key: n_CSE_7_u
    rhat = 1.1131484815979762
    ess = 5674.799832151131
Key: cs2_CSE_7
    rhat = 1.1191479844375292
    ess = 5418.268687221909
Key: cs2_CSE_8
    rhat = 1.1128812871547114
    ess = 6248.876474059131
Key: mass_1_GW170817
    rhat = 1.104473782661242
    ess = 6361.736626113404
Key: mass_2_GW170817
    rhat = 1.1067648732476587
    ess = 6047.299789243506
Key: mass_J0030
    rhat = 1.1150161456567735
    ess = 5624.336157131706
Key: mass_J0740
    rhat = 1.1067040854059345
    ess = 6179.208109201903
Making plots for outdir_all
Number of samples: 10000
Creating NS plot . . .
  0%|          | 0/3001 [00:00<?, ?it/s]  4%|▎         | 110/3001 [00:00<00:02, 1093.63it/s]  7%|▋         | 222/3001 [00:00<00:02, 1106.10it/s] 11%|█         | 333/3001 [00:00<00:03, 822.26it/s]  15%|█▍        | 447/3001 [00:00<00:02, 924.32it/s] 19%|█▊        | 560/3001 [00:00<00:02, 988.04it/s] 22%|██▏       | 674/3001 [00:00<00:02, 1033.07it/s] 26%|██▋       | 788/3001 [00:00<00:02, 1063.84it/s] 30%|██▉       | 897/3001 [00:00<00:02, 839.81it/s]  34%|███▎      | 1011/3001 [00:01<00:02, 914.97it/s] 37%|███▋      | 1121/3001 [00:01<00:01, 963.11it/s] 41%|████      | 1235/3001 [00:01<00:01, 1010.78it/s] 45%|████▍     | 1350/3001 [00:01<00:01, 1048.30it/s] 49%|████▉     | 1465/3001 [00:01<00:01, 1075.00it/s] 53%|█████▎    | 1576/3001 [00:01<00:01, 767.25it/s]  56%|█████▋    | 1690/3001 [00:01<00:01, 851.49it/s] 60%|██████    | 1804/3001 [00:01<00:01, 920.82it/s] 64%|██████▍   | 1919/3001 [00:02<00:01, 978.14it/s] 68%|██████▊   | 2033/3001 [00:02<00:00, 1021.45it/s] 72%|███████▏  | 2148/3001 [00:02<00:00, 1056.02it/s] 75%|███████▌  | 2262/3001 [00:02<00:00, 1079.32it/s] 79%|███████▉  | 2377/3001 [00:02<00:00, 1098.72it/s] 83%|████████▎ | 2490/3001 [00:02<00:00, 731.91it/s]  87%|████████▋ | 2605/3001 [00:02<00:00, 821.27it/s] 91%|█████████ | 2719/3001 [00:02<00:00, 896.13it/s] 94%|█████████▍| 2834/3001 [00:02<00:00, 958.36it/s] 98%|█████████▊| 2949/3001 [00:03<00:00, 1006.98it/s]100%|██████████| 3001/3001 [00:03<00:00, 955.13it/s] 
Bad counter: 3
Creating NS plot . . . DONE
Making histograms . . .
Reading Hauke data
Loading weights from /home/twouters2/hauke_eos/weights/all.txt
Weights at these bad indices
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
Shape of mtov_list: (99941,)
Shape of r14_list: (99941,)
Shape of l14_list: (99941,)
Shape of ntov_list: (0,)
Shape of p3nsat_list: (99941,)
np.shape(weights)
(99941,)
Reading Hauke data DONE
Creating histograms . . .
  0%|          | 0/10000 [00:00<?, ?it/s] 51%|█████     | 5088/10000 [00:00<00:00, 50868.41it/s]100%|██████████| 10000/10000 [00:00<00:00, 50886.43it/s]
Negative counter: 8
Mass at 2 nsat: 0.77-0.51+0.53
MTOV credible interval for Jester



2.22-0.22+0.35 (at 0.95 HDI prob)



R1.4 credible interval for Jester



12.65-1.14+1.05 (at 0.95 HDI prob)



R1.4 credible interval for Jester



12.65-1.14+1.05 (at 0.95 HDI prob)



R1.4: 12.65-1.14+1.05
n_TOV: 5.8459 - 1.5206 + 1.4725
p3nsat credible interval for Jester



93.99-39.31+61.13 (at 0.95 HDI prob)



p3nsat: 93.99-39.31+61.13
This is the all-constraints run. Therefore, we also make the master plot!
Percentage of EOS samples that are above 0.33: 99.96%
Going to make the Hauke combination plot for outdir = outdir_all
  0%|          | 0/3001 [00:00<?, ?it/s]  9%|▉         | 275/3001 [00:00<00:00, 2740.35it/s] 18%|█▊        | 550/3001 [00:00<00:00, 2732.87it/s] 27%|██▋       | 825/3001 [00:00<00:00, 2738.19it/s] 37%|███▋      | 1099/3001 [00:00<00:00, 2737.61it/s] 46%|████▌     | 1373/3001 [00:01<00:01, 944.56it/s]  55%|█████▌    | 1652/3001 [00:01<00:01, 1222.19it/s] 64%|██████▍   | 1932/3001 [00:01<00:00, 1501.08it/s] 74%|███████▎  | 2212/3001 [00:01<00:00, 1762.83it/s] 83%|████████▎ | 2491/3001 [00:01<00:00, 1992.63it/s] 92%|█████████▏| 2772/3001 [00:01<00:00, 2188.93it/s]100%|██████████| 3001/3001 [00:01<00:00, 1718.96it/s]
DONE

JOB STATISTICS
==============
Job ID: 10331211
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 00:55:45
CPU Efficiency: 6.32% of 14:42:40 core-walltime
Job Wall-clock time: 00:55:10
Memory Utilized: 3.15 GB
Memory Efficiency: 15.77% of 20.00 GB
