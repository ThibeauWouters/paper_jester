Fri Dec 27 10:21:01 CET 2024
NVIDIA A100-SXM4-40GB
2024-12-27 10:21:06.653530: W external/xla/xla/service/gpu/nvptx_compiler.cc:836] The NVIDIA driver's CUDA version is 12.5 which is older than the PTX compiler version (12.6.85). Because the driver is older than the PTX compiler version, XLA is disabling parallel compilation, which may slow down compilation. You should update your NVIDIA driver or use the NVIDIA-provided CUDA forward compatibility packages.
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Loading data necessary for the event GW170817
Loading data necessary for the event J0030 and sampling the with NICER masses
Loading data necessary for the event J0740 and sampling the with NICER masses
Not sampling PREX or CREX data now
Loading data necessary for the Chiral EFT
Sanity checking: likelihoods_list = [<paper_jose.utils.GWlikelihood_with_masses object at 0x14cd07ebfa90>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14c349f8be20>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14c3520b0a90>, <paper_jose.utils.RadioTimingLikelihood object at 0x14cbdde893f0>, <paper_jose.utils.RadioTimingLikelihood object at 0x14cbdde8a230>, <paper_jose.utils.RadioTimingLikelihood object at 0x14cbdde89fc0>, <paper_jose.utils.ChiEFTLikelihood object at 0x14cbdde8a8c0>]
len(likelihoods_list) = 7
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
We are going to give these kwargs to Jim:
{'n_loop_training': 20, 'n_loop_production': 20, 'n_chains': 1000, 'n_local_steps': 2, 'n_global_steps': 100, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 5}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
log_prob
[-531.39682591 -379.75051766 -118.1953805 ]
Global Tuning:   0%|          | 0/20 [00:00<?, ?it/s]Global Tuning:   5%|▌         | 1/20 [03:55<1:14:36, 235.59s/it]Global Tuning:  10%|█         | 2/20 [05:58<50:50, 169.45s/it]  Global Tuning:  15%|█▌        | 3/20 [07:48<40:18, 142.27s/it]Global Tuning:  20%|██        | 4/20 [09:40<34:43, 130.24s/it]Global Tuning:  25%|██▌       | 5/20 [11:33<30:59, 123.95s/it]Global Tuning:  30%|███       | 6/20 [13:28<28:15, 121.09s/it]Global Tuning:  35%|███▌      | 7/20 [15:33<26:27, 122.14s/it]Global Tuning:  40%|████      | 8/20 [17:34<24:24, 122.04s/it]Global Tuning:  45%|████▌     | 9/20 [19:39<22:31, 122.87s/it]Global Tuning:  50%|█████     | 10/20 [21:43<20:32, 123.27s/it]Global Tuning:  55%|█████▌    | 11/20 [23:52<18:43, 124.87s/it]Global Tuning:  60%|██████    | 12/20 [25:50<16:21, 122.74s/it]Global Tuning:  65%|██████▌   | 13/20 [27:56<14:26, 123.78s/it]Global Tuning:  70%|███████   | 14/20 [29:56<12:16, 122.71s/it]Global Tuning:  75%|███████▌  | 15/20 [31:59<10:14, 122.90s/it]Global Tuning:  80%|████████  | 16/20 [34:06<08:16, 124.02s/it]Global Tuning:  85%|████████▌ | 17/20 [36:09<06:11, 123.73s/it]Global Tuning:  90%|█████████ | 18/20 [38:12<04:06, 123.39s/it]Global Tuning:  95%|█████████▌| 19/20 [40:14<02:02, 122.96s/it]Global Tuning: 100%|██████████| 20/20 [42:13<00:00, 121.92s/it]Global Tuning: 100%|██████████| 20/20 [42:13<00:00, 126.68s/it]
Compiling MALA body
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [01:58<37:28, 118.33s/it]Global Sampling:  10%|█         | 2/20 [03:53<34:59, 116.63s/it]Global Sampling:  15%|█▌        | 3/20 [05:56<33:53, 119.63s/it]Global Sampling:  20%|██        | 4/20 [07:58<32:05, 120.36s/it]Global Sampling:  25%|██▌       | 5/20 [10:00<30:14, 120.93s/it]Global Sampling:  30%|███       | 6/20 [12:03<28:23, 121.70s/it]Global Sampling:  35%|███▌      | 7/20 [14:01<26:08, 120.63s/it]Global Sampling:  40%|████      | 8/20 [16:00<23:59, 119.96s/it]Global Sampling:  45%|████▌     | 9/20 [17:58<21:53, 119.41s/it]Global Sampling:  50%|█████     | 10/20 [19:58<19:56, 119.67s/it]Global Sampling:  55%|█████▌    | 11/20 [22:00<18:02, 120.32s/it]Global Sampling:  60%|██████    | 12/20 [24:02<16:05, 120.67s/it]Global Sampling:  65%|██████▌   | 13/20 [26:06<14:11, 121.64s/it]Global Sampling:  70%|███████   | 14/20 [28:05<12:05, 120.94s/it]Global Sampling:  75%|███████▌  | 15/20 [30:05<10:03, 120.73s/it]Global Sampling:  80%|████████  | 16/20 [32:03<07:58, 119.73s/it]Global Sampling:  85%|████████▌ | 17/20 [34:04<06:00, 120.30s/it]Global Sampling:  90%|█████████ | 18/20 [36:02<03:59, 119.67s/it]Global Sampling:  95%|█████████▌| 19/20 [38:01<01:59, 119.27s/it]Global Sampling: 100%|██████████| 20/20 [40:04<00:00, 120.33s/it]Global Sampling: 100%|██████████| 20/20 [40:04<00:00, 120.20s/it]
Training summary
==========
E_sym: 36.735 +/- 4.785
L_sym: 49.117 +/- 27.374
K_sym: -132.489 +/- 105.565
Q_sym: 1.797 +/- 454.159
Z_sym: -510.920 +/- 1126.338
K_sat: 218.666 +/- 41.942
Q_sat: 271.149 +/- 449.551
Z_sat: -497.584 +/- 1138.916
nbreak: 0.248 +/- 0.043
n_CSE_0_u: 0.479 +/- 0.288
cs2_CSE_0: 0.654 +/- 0.220
n_CSE_1_u: 0.480 +/- 0.292
cs2_CSE_1: 0.532 +/- 0.276
n_CSE_2_u: 0.469 +/- 0.292
cs2_CSE_2: 0.508 +/- 0.282
n_CSE_3_u: 0.476 +/- 0.291
cs2_CSE_3: 0.498 +/- 0.285
n_CSE_4_u: 0.473 +/- 0.291
cs2_CSE_4: 0.506 +/- 0.280
n_CSE_5_u: 0.475 +/- 0.294
cs2_CSE_5: 0.500 +/- 0.284
n_CSE_6_u: 0.471 +/- 0.292
cs2_CSE_6: 0.499 +/- 0.282
n_CSE_7_u: 0.474 +/- 0.291
cs2_CSE_7: 0.505 +/- 0.283
cs2_CSE_8: 0.495 +/- 0.285
mass_1_GW170817: 1.512 +/- 0.108
mass_2_GW170817: 1.247 +/- 0.079
mass_J0030: 1.369 +/- 0.148
mass_J0740: 2.032 +/- 0.103
Log probability: -36555.925 +/- 702493.153
Local acceptance: 0.956 +/- 0.206
Global acceptance: 0.082 +/- 0.275
Max loss: 51.034, Min loss: 34.624
Production summary
==========
E_sym: 36.682 +/- 4.861
L_sym: 45.789 +/- 23.503
K_sym: -138.354 +/- 106.986
Q_sym: -21.234 +/- 470.257
Z_sym: -508.594 +/- 1144.030
K_sat: 220.048 +/- 42.469
Q_sat: 245.348 +/- 462.378
Z_sat: -427.555 +/- 1209.341
nbreak: 0.247 +/- 0.045
n_CSE_0_u: 0.480 +/- 0.294
cs2_CSE_0: 0.625 +/- 0.240
n_CSE_1_u: 0.471 +/- 0.298
cs2_CSE_1: 0.531 +/- 0.285
n_CSE_2_u: 0.476 +/- 0.294
cs2_CSE_2: 0.500 +/- 0.287
n_CSE_3_u: 0.488 +/- 0.293
cs2_CSE_3: 0.500 +/- 0.286
n_CSE_4_u: 0.472 +/- 0.293
cs2_CSE_4: 0.497 +/- 0.293
n_CSE_5_u: 0.479 +/- 0.293
cs2_CSE_5: 0.503 +/- 0.283
n_CSE_6_u: 0.474 +/- 0.299
cs2_CSE_6: 0.505 +/- 0.286
n_CSE_7_u: 0.478 +/- 0.295
cs2_CSE_7: 0.507 +/- 0.285
cs2_CSE_8: 0.500 +/- 0.286
mass_1_GW170817: 1.503 +/- 0.095
mass_2_GW170817: 1.247 +/- 0.073
mass_J0030: 1.357 +/- 0.120
mass_J0740: 2.042 +/- 0.076
Log probability: -69.572 +/- 1.898
Local acceptance: 0.939 +/- 0.239
Global acceptance: 0.053 +/- 0.223
S has been successful, now we will do some postprocessing. Sampling time: roughly 84 mins
Saving the final results
Number of samples generated in training: 420000
Number of samples generated in production: 420000
Number of samples generated: 840000
Time taken for TOV map: 59.66449046134949 s
DONE entire script
suffix
all
Checking the convergence for outdir_all
list(data.keys())
['log_prob', 'E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
Key: E_sym
    rhat = 1.0816359046209885
    ess = 8013.419613485172
Key: L_sym
    rhat = 1.0884934523086727
    ess = 7106.564163868869
Key: K_sym
    rhat = 1.0969300310851622
    ess = 6580.2936298127015
Key: Q_sym
    rhat = 1.107732443310672
    ess = 5961.284194678791
Key: Z_sym
    rhat = 1.0748998251110577
    ess = 8433.09182731147
Key: K_sat
    rhat = 1.080708443492466
    ess = 7861.948361426532
Key: Q_sat
    rhat = 1.096833611625531
    ess = 6612.272739332542
Key: Z_sat
    rhat = 1.1343629639061052
    ess = 4892.378456753045
Key: nbreak
    rhat = 1.0955356647051846
    ess = 6697.439685434315
Key: n_CSE_0_u
    rhat = 1.0886879006742738
    ess = 7078.900469067171
Key: cs2_CSE_0
    rhat = 1.1237458766086355
    ess = 5272.344318183511
Key: n_CSE_1_u
    rhat = 1.0898501803873863
    ess = 7085.688433780216
Key: cs2_CSE_1
    rhat = 1.0841533566206631
    ess = 7410.957833643189
Key: n_CSE_2_u
    rhat = 1.083294564292965
    ess = 7648.440140490515
Key: cs2_CSE_2
    rhat = 1.0906335954564434
    ess = 7380.960757250135
Key: n_CSE_3_u
    rhat = 1.0906151011071628
    ess = 6895.492758096365
Key: cs2_CSE_3
    rhat = 1.0808993891049847
    ess = 7702.591103086708
Key: n_CSE_4_u
    rhat = 1.0934959645971052
    ess = 6705.973030478188
Key: cs2_CSE_4
    rhat = 1.0950306652118509
    ess = 6826.340508149535
Key: n_CSE_5_u
    rhat = 1.087311210296401
    ess = 7246.88977553185
Key: cs2_CSE_5
    rhat = 1.0821652798416284
    ess = 8307.923794994242
Key: n_CSE_6_u
    rhat = 1.1102122088373854
    ess = 5829.907978342337
Key: cs2_CSE_6
    rhat = 1.0772612832882136
    ess = 8194.859641818814
Key: n_CSE_7_u
    rhat = 1.0980854994721696
    ess = 6459.062507496885
Key: cs2_CSE_7
    rhat = 1.0803226677389683
    ess = 7912.140212526024
Key: cs2_CSE_8
    rhat = 1.0766838245470096
    ess = 8350.60681969329
Key: mass_1_GW170817
    rhat = 1.0871369491853353
    ess = 7338.903501431958
Key: mass_2_GW170817
    rhat = 1.0873658073267929
    ess = 7374.999482949421
Key: mass_J0030
    rhat = 1.082091589000084
    ess = 7608.521684627289
Key: mass_J0740
    rhat = 1.0825833095784438
    ess = 7617.242076915
Making plots for outdir_all
Number of samples: 100000
Creating NS plot . . .
  0%|          | 0/3001 [00:00<?, ?it/s]  3%|▎         | 77/3001 [00:00<00:03, 768.53it/s]  5%|▌         | 156/3001 [00:00<00:03, 777.26it/s]  8%|▊         | 235/3001 [00:00<00:03, 781.55it/s] 10%|█         | 314/3001 [00:00<00:03, 782.82it/s] 13%|█▎        | 393/3001 [00:00<00:03, 779.41it/s] 16%|█▌        | 471/3001 [00:00<00:04, 626.40it/s] 18%|█▊        | 551/3001 [00:00<00:03, 673.46it/s] 21%|██        | 630/3001 [00:00<00:03, 706.54it/s] 24%|██▎       | 710/3001 [00:00<00:03, 732.91it/s] 26%|██▋       | 790/3001 [00:01<00:02, 750.40it/s] 29%|██▉       | 870/3001 [00:01<00:02, 764.40it/s] 32%|███▏      | 950/3001 [00:01<00:02, 774.31it/s] 34%|███▍      | 1030/3001 [00:01<00:02, 779.08it/s] 37%|███▋      | 1109/3001 [00:01<00:02, 646.05it/s] 40%|███▉      | 1189/3001 [00:01<00:02, 684.47it/s] 42%|████▏     | 1269/3001 [00:01<00:02, 715.64it/s] 45%|████▍     | 1350/3001 [00:01<00:02, 739.59it/s] 48%|████▊     | 1430/3001 [00:01<00:02, 755.26it/s] 50%|█████     | 1510/3001 [00:02<00:01, 768.00it/s] 53%|█████▎    | 1590/3001 [00:02<00:01, 776.13it/s] 56%|█████▌    | 1671/3001 [00:02<00:01, 783.43it/s] 58%|█████▊    | 1752/3001 [00:02<00:01, 788.54it/s] 61%|██████    | 1832/3001 [00:02<00:01, 622.52it/s] 64%|██████▎   | 1912/3001 [00:02<00:01, 666.69it/s] 66%|██████▋   | 1992/3001 [00:02<00:01, 699.93it/s] 69%|██████▉   | 2073/3001 [00:02<00:01, 728.18it/s] 72%|███████▏  | 2153/3001 [00:02<00:01, 747.32it/s] 74%|███████▍  | 2233/3001 [00:03<00:01, 760.96it/s] 77%|███████▋  | 2313/3001 [00:03<00:00, 771.25it/s] 80%|███████▉  | 2393/3001 [00:03<00:00, 777.55it/s] 82%|████████▏ | 2473/3001 [00:03<00:00, 783.22it/s] 85%|████████▌ | 2553/3001 [00:03<00:00, 786.73it/s] 88%|████████▊ | 2633/3001 [00:03<00:00, 571.15it/s] 90%|█████████ | 2712/3001 [00:03<00:00, 622.31it/s] 93%|█████████▎| 2792/3001 [00:03<00:00, 666.12it/s] 96%|█████████▌| 2872/3001 [00:03<00:00, 699.81it/s] 98%|█████████▊| 2952/3001 [00:04<00:00, 726.68it/s]100%|██████████| 3001/3001 [00:04<00:00, 723.55it/s]
Bad counter: 4
Creating NS plot . . . DONE
Reading Hauke data
Loading weights from /home/twouters2/hauke_eos/weights/all.txt
Weights at these bad indices
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
Shape of mtov_list: (99941,)
Shape of r14_list: (99941,)
Shape of l14_list: (99941,)
Shape of ntov_list: (0,)
Shape of p3nsat_list: (99941,)
np.shape(weights)
(99941,)
Reading Hauke data DONE
Creating histograms . . .
  0%|          | 0/100000 [00:00<?, ?it/s]  4%|▍         | 4049/100000 [00:00<00:02, 40486.66it/s]  8%|▊         | 8155/100000 [00:00<00:02, 40821.98it/s] 12%|█▏        | 12263/100000 [00:00<00:02, 40936.51it/s] 16%|█▋        | 16371/100000 [00:00<00:02, 40991.47it/s] 20%|██        | 20482/100000 [00:00<00:01, 41030.49it/s] 25%|██▍       | 24587/100000 [00:00<00:01, 41033.61it/s] 29%|██▊       | 28691/100000 [00:00<00:01, 40996.92it/s] 33%|███▎      | 32791/100000 [00:00<00:01, 40959.05it/s] 37%|███▋      | 36887/100000 [00:00<00:01, 40941.04it/s] 41%|████      | 40982/100000 [00:01<00:01, 40901.38it/s] 45%|████▌     | 45078/100000 [00:01<00:01, 40916.78it/s] 49%|████▉     | 49170/100000 [00:01<00:01, 40910.83it/s] 53%|█████▎    | 53262/100000 [00:01<00:01, 40864.90it/s] 57%|█████▋    | 57349/100000 [00:01<00:01, 40826.23it/s] 61%|██████▏   | 61432/100000 [00:01<00:00, 40767.50it/s] 66%|██████▌   | 65509/100000 [00:01<00:00, 40733.47it/s] 70%|██████▉   | 69583/100000 [00:01<00:00, 40730.34it/s] 74%|███████▎  | 73657/100000 [00:01<00:00, 40707.51it/s] 78%|███████▊  | 77735/100000 [00:01<00:00, 40728.44it/s] 82%|████████▏ | 81813/100000 [00:02<00:00, 40741.56it/s] 86%|████████▌ | 85888/100000 [00:02<00:00, 40740.17it/s] 90%|████████▉ | 89965/100000 [00:02<00:00, 40746.21it/s] 94%|█████████▍| 94040/100000 [00:02<00:00, 40722.67it/s] 98%|█████████▊| 98113/100000 [00:02<00:00, 40714.84it/s]100%|██████████| 100000/100000 [00:02<00:00, 40799.60it/s]
Negative counter: 41
Mass at 2 nsat: 0.76-0.52+0.46
TOV mass: 2.23-0.23+0.36
R1.4: 12.62-1.07+1.01
n_TOV: 5.9403 - 1.5026 + 1.3078
p3nsat: 91.82-39.05+62.25
This is the all-constraints run. Therefore, we also make the master plot!
Percentage of EOS samples that are above 0.33: 99.94%
NEP Correlation coefficients:
    E_sym - L_sym: 0.038281430160876075
    E_sym - K_sym: 0.0008651462437987478
    E_sym - Q_sym: 0.009924687692167334
    E_sym - Z_sym: 0.0077591060835985205
    E_sym - K_sat: -0.02422023353908381
    E_sym - Q_sat: 0.007674893649000197
    E_sym - Z_sat: -0.020307948838734116
    L_sym - K_sym: -0.3488831190922449
    L_sym - Q_sym: 0.03525554749369647
    L_sym - Z_sym: -0.018562798240145322
    L_sym - K_sat: -0.17707712801765807
    L_sym - Q_sat: 0.026112473203763604
    L_sym - Z_sat: -0.014657712636667798
    K_sym - Q_sym: -0.06261766873762724
    K_sym - Z_sym: -0.012380001303028259
    K_sym - K_sat: -0.12290293530130808
    K_sym - Q_sat: -0.05920419963275184
    K_sym - Z_sat: -0.02866221272524391
    Q_sym - Z_sym: 0.033436251594478224
    Q_sym - K_sat: -0.01840825725969114
    Q_sym - Q_sat: -0.04723594697119951
    Q_sym - Z_sat: -0.00041265060125606385
    Z_sym - K_sat: -0.005519373217354231
    Z_sym - Q_sat: -0.011902266627422511
    Z_sym - Z_sat: -0.02679801894854935
    K_sat - Q_sat: -0.046243443544739825
    K_sat - Z_sat: -0.015636642958065793
    Q_sat - Z_sat: -0.00018134518214454233
Maximal corrcoef: 0.038281430160876075
Minimal corrcoef: -0.3488831190922449
NEP Posterior to prior ratios:
Traceback (most recent call last):
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/inference/postprocessing.py", line 881, in <module>
    main()
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/inference/postprocessing.py", line 878, in main
    report_NEPs(suffix)
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/inference/postprocessing.py", line 776, in report_NEPs
    for prior in prior_list:
NameError: name 'prior_list' is not defined. Did you mean: 'prior_width'?
DONE

JOB STATISTICS
==============
Job ID: 9166130
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 01:27:53
CPU Efficiency: 5.59% of 1-02:11:24 core-walltime
Job Wall-clock time: 01:27:18
Memory Utilized: 4.65 GB
Memory Efficiency: 23.24% of 20.00 GB
