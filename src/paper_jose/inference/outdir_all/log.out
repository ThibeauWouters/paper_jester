Fri Mar 14 20:42:55 CET 2025
NVIDIA H100
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Using the broad EOS prior
Ignoring the Q and Z NEP parameters
Using the regular nbreak prior: U[1.0, 2.0] * 0.16
Fixed params loaded inside the MicroToMacroTransform:
    Q_sym: 0.0
    Z_sym: 0.0
    E_sat: -16.0
    Q_sat: 0.0
    Z_sat: 0.0
Loading data necessary for the event GW170817
Using GW170817 inference with agnostic prior
Loading data necessary for the event J0030 and sampling the with NICER masses
Loading data necessary for the event J0740 and sampling the with NICER masses
Not sampling PREX or CREX data now
Loading data necessary for the Chiral EFT
Sanity checking: likelihoods_list = [<paper_jose.utils.GWlikelihood_with_masses object at 0x14debce156f0>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14deb9565810>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14deba033d30>, <paper_jose.utils.RadioTimingLikelihood object at 0x14deb962ff10>, <paper_jose.utils.RadioTimingLikelihood object at 0x14deb94a2fb0>, <paper_jose.utils.RadioTimingLikelihood object at 0x14deba17b970>, <paper_jose.utils.ChiEFTLikelihood object at 0x14deb948bb80>]
len(likelihoods_list) = 7
Fixed params loaded inside the MicroToMacroTransform:
    Q_sym: 0.0
    Z_sym: 0.0
    E_sat: -16.0
    Q_sat: 0.0
    Z_sat: 0.0
We are going to give these kwargs to Jim:
{'n_loop_training': 20, 'n_loop_production': 20, 'n_chains': 1000, 'n_local_steps': 2, 'n_global_steps': 100, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 5}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'K_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
log_prob
[-1.00001203e+07 -1.03506214e+02 -1.36963774e+02]
Sampling seed is set to: 11
Global Tuning:   0%|          | 0/20 [00:00<?, ?it/s]Global Tuning:   5%|▌         | 1/20 [02:42<51:23, 162.30s/it]Global Tuning:  10%|█         | 2/20 [03:51<32:11, 107.31s/it]Global Tuning:  15%|█▌        | 3/20 [04:49<24:04, 84.95s/it] Global Tuning:  20%|██        | 4/20 [05:41<19:12, 72.05s/it]Global Tuning:  25%|██▌       | 5/20 [06:44<17:12, 68.83s/it]Global Tuning:  30%|███       | 6/20 [07:48<15:40, 67.21s/it]Global Tuning:  35%|███▌      | 7/20 [08:57<14:37, 67.51s/it]Global Tuning:  40%|████      | 8/20 [10:04<13:29, 67.47s/it]Global Tuning:  45%|████▌     | 9/20 [11:14<12:29, 68.13s/it]Global Tuning:  50%|█████     | 10/20 [12:22<11:22, 68.22s/it]Global Tuning:  55%|█████▌    | 11/20 [13:27<10:04, 67.18s/it]Global Tuning:  60%|██████    | 12/20 [14:33<08:54, 66.86s/it]Global Tuning:  65%|██████▌   | 13/20 [15:30<07:28, 64.03s/it]Global Tuning:  70%|███████   | 14/20 [16:40<06:34, 65.78s/it]Global Tuning:  75%|███████▌  | 15/20 [17:43<05:23, 64.77s/it]Global Tuning:  80%|████████  | 16/20 [18:51<04:23, 65.94s/it]Global Tuning:  85%|████████▌ | 17/20 [19:58<03:18, 66.03s/it]Global Tuning:  90%|█████████ | 18/20 [20:57<02:08, 64.17s/it]Global Tuning:  95%|█████████▌| 19/20 [22:05<01:05, 65.30s/it]Global Tuning: 100%|██████████| 20/20 [23:06<00:00, 63.78s/it]Global Tuning: 100%|██████████| 20/20 [23:06<00:00, 69.30s/it]
Compiling MALA body
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [01:07<21:28, 67.83s/it]Global Sampling:  10%|█         | 2/20 [02:13<19:55, 66.44s/it]Global Sampling:  15%|█▌        | 3/20 [03:23<19:15, 67.94s/it]Global Sampling:  20%|██        | 4/20 [04:26<17:36, 66.05s/it]Global Sampling:  25%|██▌       | 5/20 [05:33<16:35, 66.37s/it]Global Sampling:  30%|███       | 6/20 [06:41<15:37, 66.98s/it]Global Sampling:  35%|███▌      | 7/20 [07:47<14:26, 66.63s/it]Global Sampling:  40%|████      | 8/20 [08:54<13:23, 66.97s/it]Global Sampling:  45%|████▌     | 9/20 [10:03<12:23, 67.59s/it]Global Sampling:  50%|█████     | 10/20 [11:13<11:21, 68.13s/it]Global Sampling:  55%|█████▌    | 11/20 [12:20<10:11, 67.97s/it]Global Sampling:  60%|██████    | 12/20 [13:18<08:39, 64.89s/it]Global Sampling:  65%|██████▌   | 13/20 [14:17<07:20, 62.98s/it]Global Sampling:  70%|███████   | 14/20 [15:15<06:09, 61.56s/it]Global Sampling:  75%|███████▌  | 15/20 [16:23<05:18, 63.64s/it]Global Sampling:  80%|████████  | 16/20 [17:27<04:14, 63.72s/it]Global Sampling:  85%|████████▌ | 17/20 [18:38<03:17, 65.68s/it]Global Sampling:  90%|█████████ | 18/20 [19:38<02:08, 64.04s/it]Global Sampling:  95%|█████████▌| 19/20 [20:36<01:02, 62.14s/it]Global Sampling: 100%|██████████| 20/20 [21:39<00:00, 62.64s/it]Global Sampling: 100%|██████████| 20/20 [21:39<00:00, 64.99s/it]
Training summary
==========
E_sym: 36.717 +/- 4.798
L_sym: 46.221 +/- 23.397
K_sym: -127.614 +/- 106.126
K_sat: 219.431 +/- 42.521
nbreak: 0.250 +/- 0.043
n_CSE_0_u: 0.473 +/- 0.292
cs2_CSE_0: 0.675 +/- 0.214
n_CSE_1_u: 0.473 +/- 0.289
cs2_CSE_1: 0.530 +/- 0.277
n_CSE_2_u: 0.479 +/- 0.292
cs2_CSE_2: 0.501 +/- 0.282
n_CSE_3_u: 0.482 +/- 0.290
cs2_CSE_3: 0.511 +/- 0.285
n_CSE_4_u: 0.476 +/- 0.293
cs2_CSE_4: 0.494 +/- 0.283
n_CSE_5_u: 0.470 +/- 0.293
cs2_CSE_5: 0.507 +/- 0.284
n_CSE_6_u: 0.480 +/- 0.291
cs2_CSE_6: 0.497 +/- 0.283
n_CSE_7_u: 0.476 +/- 0.295
cs2_CSE_7: 0.494 +/- 0.283
cs2_CSE_8: 0.505 +/- 0.286
mass_1_GW170817: 1.514 +/- 0.108
mass_2_GW170817: 1.244 +/- 0.079
mass_J0030: 1.362 +/- 0.145
mass_J0740: 2.029 +/- 0.103
Log probability: -33356.509 +/- 671278.265
Local acceptance: 0.965 +/- 0.184
Global acceptance: 0.085 +/- 0.279
Max loss: 43.067, Min loss: 29.730
Production summary
==========
E_sym: 36.624 +/- 4.928
L_sym: 44.675 +/- 22.444
K_sym: -135.724 +/- 104.771
K_sat: 219.380 +/- 42.747
nbreak: 0.251 +/- 0.044
n_CSE_0_u: 0.475 +/- 0.300
cs2_CSE_0: 0.637 +/- 0.236
n_CSE_1_u: 0.476 +/- 0.302
cs2_CSE_1: 0.549 +/- 0.279
n_CSE_2_u: 0.461 +/- 0.296
cs2_CSE_2: 0.487 +/- 0.298
n_CSE_3_u: 0.485 +/- 0.298
cs2_CSE_3: 0.517 +/- 0.296
n_CSE_4_u: 0.447 +/- 0.295
cs2_CSE_4: 0.490 +/- 0.289
n_CSE_5_u: 0.479 +/- 0.295
cs2_CSE_5: 0.504 +/- 0.287
n_CSE_6_u: 0.469 +/- 0.301
cs2_CSE_6: 0.501 +/- 0.288
n_CSE_7_u: 0.482 +/- 0.292
cs2_CSE_7: 0.493 +/- 0.292
cs2_CSE_8: 0.506 +/- 0.287
mass_1_GW170817: 1.513 +/- 0.102
mass_2_GW170817: 1.240 +/- 0.078
mass_J0030: 1.345 +/- 0.124
mass_J0740: 2.039 +/- 0.077
Log probability: -38.215 +/- 2.076
Local acceptance: 0.943 +/- 0.232
Global acceptance: 0.071 +/- 0.258
S has been successful, now we will do some postprocessing. Sampling time: roughly 46 mins
Saving the final results
Number of samples generated in training: 420000
Number of samples generated in production: 420000
Number of samples generated: 840000
Time taken for TOV map: 2.252777576446533 s
DONE entire script
suffix
all
Checking the convergence for outdir_all
list(data.keys())
['log_prob', 'E_sym', 'L_sym', 'K_sym', 'K_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
Key: E_sym
    rhat = 1.0798448373303136
    ess = 7998.907716850612
Key: L_sym
    rhat = 1.080478932240116
    ess = 7682.415510859745
Key: K_sym
    rhat = 1.0764853325678192
    ess = 8196.34270024778
Key: K_sat
    rhat = 1.080571061332498
    ess = 7628.62050313971
Key: nbreak
    rhat = 1.087994649841825
    ess = 7085.380855723214
Key: n_CSE_0_u
    rhat = 1.1079785091409298
    ess = 5884.96588588521
Key: cs2_CSE_0
    rhat = 1.1123652641398143
    ess = 5715.730180479267
Key: n_CSE_1_u
    rhat = 1.0963257235480584
    ess = 6501.405807115759
Key: cs2_CSE_1
    rhat = 1.079709066135288
    ess = 7972.549200654871
Key: n_CSE_2_u
    rhat = 1.0855690766395152
    ess = 7517.503738589633
Key: cs2_CSE_2
    rhat = 1.1097256015756156
    ess = 5897.49627705371
Key: n_CSE_3_u
    rhat = 1.0807639408418195
    ess = 7674.2657351953885
Key: cs2_CSE_3
    rhat = 1.0914294778829334
    ess = 6840.323844917806
Key: n_CSE_4_u
    rhat = 1.0753223745127
    ess = 8436.773662748927
Key: cs2_CSE_4
    rhat = 1.0774667806417721
    ess = 8021.192998440786
Key: n_CSE_5_u
    rhat = 1.0807158689191387
    ess = 7614.970338304925
Key: cs2_CSE_5
    rhat = 1.0751299401495116
    ess = 8479.427337068499
Key: n_CSE_6_u
    rhat = 1.0836609275839322
    ess = 7444.4292619468515
Key: cs2_CSE_6
    rhat = 1.083213613725055
    ess = 7933.876294681922
Key: n_CSE_7_u
    rhat = 1.0792142893347418
    ess = 7794.439316005158
Key: cs2_CSE_7
    rhat = 1.078038669388051
    ess = 7975.318846501947
Key: cs2_CSE_8
    rhat = 1.0816475973473925
    ess = 7684.200779318181
Key: mass_1_GW170817
    rhat = 1.0951512970660258
    ess = 6681.988050089919
Key: mass_2_GW170817
    rhat = 1.095727229016739
    ess = 6654.313271401113
Key: mass_J0030
    rhat = 1.0844380744934796
    ess = 7335.529642005792
Key: mass_J0740
    rhat = 1.0847518559974456
    ess = 7415.2033393713045
Making plots for outdir_all
Number of samples: 10000
Creating NS plot . . .
  0%|          | 0/3001 [00:00<?, ?it/s]  4%|▎         | 111/3001 [00:00<00:02, 1103.72it/s]  7%|▋         | 225/3001 [00:00<00:02, 1120.05it/s] 11%|█▏        | 338/3001 [00:00<00:03, 824.11it/s]  15%|█▌        | 452/3001 [00:00<00:02, 924.00it/s] 19%|█▉        | 566/3001 [00:00<00:02, 990.36it/s] 23%|██▎       | 681/3001 [00:00<00:02, 1037.14it/s] 26%|██▋       | 795/3001 [00:00<00:02, 1068.22it/s] 30%|███       | 905/3001 [00:00<00:02, 835.21it/s]  34%|███▍      | 1020/3001 [00:01<00:02, 912.82it/s] 38%|███▊      | 1135/3001 [00:01<00:01, 974.34it/s] 42%|████▏     | 1250/3001 [00:01<00:01, 1021.79it/s] 45%|████▌     | 1364/3001 [00:01<00:01, 1054.74it/s] 49%|████▉     | 1479/3001 [00:01<00:01, 1080.18it/s] 53%|█████▎    | 1590/3001 [00:01<00:01, 799.04it/s]  57%|█████▋    | 1702/3001 [00:01<00:01, 872.86it/s] 60%|██████    | 1815/3001 [00:01<00:01, 936.95it/s] 64%|██████▍   | 1930/3001 [00:02<00:01, 991.48it/s] 68%|██████▊   | 2045/3001 [00:02<00:00, 1033.03it/s] 72%|███████▏  | 2159/3001 [00:02<00:00, 1062.82it/s] 76%|███████▌  | 2273/3001 [00:02<00:00, 1083.66it/s] 80%|███████▉  | 2387/3001 [00:02<00:00, 1099.24it/s] 83%|████████▎ | 2499/3001 [00:02<00:00, 727.04it/s]  87%|████████▋ | 2613/3001 [00:02<00:00, 815.72it/s] 91%|█████████ | 2727/3001 [00:02<00:00, 891.65it/s] 95%|█████████▍| 2842/3001 [00:02<00:00, 954.82it/s] 99%|█████████▊| 2957/3001 [00:03<00:00, 1004.84it/s]100%|██████████| 3001/3001 [00:03<00:00, 959.68it/s] 
Bad counter: 0
Creating NS plot . . . DONE
Making histograms . . .
Reading Hauke data
Loading weights from /home/twouters2/hauke_eos/weights/all.txt
Weights at these bad indices
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
Shape of mtov_list: (99941,)
Shape of r14_list: (99941,)
Shape of l14_list: (99941,)
Shape of ntov_list: (0,)
Shape of p3nsat_list: (99941,)
np.shape(weights)
(99941,)
Reading Hauke data DONE
Creating histograms . . .
  0%|          | 0/10000 [00:00<?, ?it/s] 51%|█████     | 5108/10000 [00:00<00:00, 51070.31it/s]100%|██████████| 10000/10000 [00:00<00:00, 50995.38it/s]
Negative counter: 0
Mass at 2 nsat: 0.73-0.50+0.53
MTOV credible interval for Jester



2.24-0.23+0.37 (at 0.95 HDI prob)



R1.4 credible interval for Jester



12.58-1.10+1.03 (at 0.95 HDI prob)



R1.4 credible interval for Jester



12.58-1.10+1.03 (at 0.95 HDI prob)



R1.4: 12.58-1.10+1.03
n_TOV: 5.8871 - 1.5197 + 1.3899
p3nsat credible interval for Jester



93.43-39.57+66.87 (at 0.95 HDI prob)



p3nsat: 93.43-39.57+66.87
This is the all-constraints run. Therefore, we also make the master plot!
Percentage of EOS samples that are above 0.33: 99.98%
Going to make the Hauke combination plot for outdir = outdir_all
  0%|          | 0/3001 [00:00<?, ?it/s]  9%|▉         | 274/3001 [00:00<00:00, 2734.68it/s] 18%|█▊        | 548/3001 [00:00<00:00, 2724.03it/s] 27%|██▋       | 822/3001 [00:00<00:00, 2730.82it/s] 37%|███▋      | 1096/3001 [00:00<00:00, 2728.41it/s] 46%|████▌     | 1369/3001 [00:00<00:01, 1057.42it/s] 55%|█████▍    | 1649/3001 [00:01<00:01, 1346.50it/s] 64%|██████▍   | 1928/3001 [00:01<00:00, 1623.02it/s] 74%|███████▎  | 2210/3001 [00:01<00:00, 1879.87it/s] 82%|████████▏ | 2473/3001 [00:01<00:00, 2054.78it/s] 92%|█████████▏| 2751/3001 [00:01<00:00, 2236.86it/s]100%|██████████| 3001/3001 [00:01<00:00, 1783.68it/s]
DONE

JOB STATISTICS
==============
Job ID: 10516462
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 00:48:24
CPU Efficiency: 6.32% of 12:46:08 core-walltime
Job Wall-clock time: 00:47:53
Memory Utilized: 3.15 GB
Memory Efficiency: 15.75% of 20.00 GB
