Wed Mar  5 17:58:32 CET 2025
NVIDIA H100
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Using the broad EOS prior
Using the regular nbreak prior: U[1.0, 2.0] * 0.16
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Loading data necessary for the event GW170817
Using GW170817 inference with agnostic prior
Loading data necessary for the event J0030 and sampling the with NICER masses
Loading data necessary for the event J0740 and sampling the with NICER masses
Not sampling PREX or CREX data now
Loading data necessary for the Chiral EFT
Sanity checking: likelihoods_list = [<paper_jose.utils.GWlikelihood_with_masses object at 0x14d91f8b7b50>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14c3166ee9e0>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14c3167fbb50>, <paper_jose.utils.RadioTimingLikelihood object at 0x14c3159c3e50>, <paper_jose.utils.RadioTimingLikelihood object at 0x14c315a05720>, <paper_jose.utils.RadioTimingLikelihood object at 0x14c315a04790>, <paper_jose.utils.ChiEFTLikelihood object at 0x14c315a05840>]
len(likelihoods_list) = 7
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
We are going to give these kwargs to Jim:
{'n_loop_training': 20, 'n_loop_production': 20, 'n_chains': 1000, 'n_local_steps': 2, 'n_global_steps': 100, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 5}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
log_prob
[-531.39682591 -379.75051766 -118.1953805 ]
Sampling seed is set to: 11
Global Tuning:   0%|          | 0/20 [00:00<?, ?it/s]Global Tuning:   5%|▌         | 1/20 [02:46<52:40, 166.35s/it]Global Tuning:  10%|█         | 2/20 [03:58<33:13, 110.77s/it]Global Tuning:  15%|█▌        | 3/20 [05:02<25:20, 89.44s/it] Global Tuning:  20%|██        | 4/20 [06:08<21:25, 80.32s/it]Global Tuning:  25%|██▌       | 5/20 [07:15<18:51, 75.45s/it]Global Tuning:  30%|███       | 6/20 [08:23<17:01, 72.94s/it]Global Tuning:  35%|███▌      | 7/20 [09:34<15:38, 72.22s/it]Global Tuning:  40%|████      | 8/20 [10:43<14:17, 71.43s/it]Global Tuning:  45%|████▌     | 9/20 [11:54<13:01, 71.09s/it]Global Tuning:  50%|█████     | 10/20 [13:05<11:49, 70.99s/it]Global Tuning:  55%|█████▌    | 11/20 [14:20<10:50, 72.33s/it]Global Tuning:  60%|██████    | 12/20 [15:31<09:35, 72.00s/it]Global Tuning:  65%|██████▌   | 13/20 [16:43<08:23, 71.95s/it]Global Tuning:  70%|███████   | 14/20 [17:57<07:15, 72.61s/it]Global Tuning:  75%|███████▌  | 15/20 [19:09<06:01, 72.26s/it]Global Tuning:  80%|████████  | 16/20 [20:20<04:47, 71.97s/it]Global Tuning:  85%|████████▌ | 17/20 [21:30<03:34, 71.36s/it]Global Tuning:  90%|█████████ | 18/20 [22:40<02:21, 70.87s/it]Global Tuning:  95%|█████████▌| 19/20 [23:50<01:10, 70.85s/it]Global Tuning: 100%|██████████| 20/20 [25:01<00:00, 70.87s/it]Global Tuning: 100%|██████████| 20/20 [25:01<00:00, 75.09s/it]
Compiling MALA body
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [01:13<23:20, 73.70s/it]Global Sampling:  10%|█         | 2/20 [02:25<21:47, 72.65s/it]Global Sampling:  15%|█▌        | 3/20 [03:38<20:40, 72.95s/it]Global Sampling:  20%|██        | 4/20 [04:46<18:54, 70.92s/it]Global Sampling:  25%|██▌       | 5/20 [05:56<17:39, 70.61s/it]Global Sampling:  30%|███       | 6/20 [07:07<16:27, 70.54s/it]Global Sampling:  35%|███▌      | 7/20 [08:19<15:24, 71.15s/it]Global Sampling:  40%|████      | 8/20 [09:29<14:09, 70.79s/it]Global Sampling:  45%|████▌     | 9/20 [10:38<12:52, 70.20s/it]Global Sampling:  50%|█████     | 10/20 [11:50<11:48, 70.84s/it]Global Sampling:  55%|█████▌    | 11/20 [13:01<10:36, 70.75s/it]Global Sampling:  60%|██████    | 12/20 [14:11<09:25, 70.65s/it]Global Sampling:  65%|██████▌   | 13/20 [15:24<08:17, 71.13s/it]Global Sampling:  70%|███████   | 14/20 [16:38<07:13, 72.25s/it]Global Sampling:  75%|███████▌  | 15/20 [17:49<05:59, 71.87s/it]Global Sampling:  80%|████████  | 16/20 [18:58<04:43, 70.96s/it]Global Sampling:  85%|████████▌ | 17/20 [20:08<03:31, 70.48s/it]Global Sampling:  90%|█████████ | 18/20 [21:18<02:21, 70.58s/it]Global Sampling:  95%|█████████▌| 19/20 [22:30<01:10, 70.88s/it]Global Sampling: 100%|██████████| 20/20 [23:47<00:00, 72.81s/it]Global Sampling: 100%|██████████| 20/20 [23:47<00:00, 71.39s/it]
Training summary
==========
E_sym: 36.771 +/- 4.773
L_sym: 49.466 +/- 27.326
K_sym: -131.581 +/- 105.899
Q_sym: 5.288 +/- 454.329
Z_sym: -511.949 +/- 1122.293
K_sat: 218.976 +/- 41.773
Q_sat: 271.566 +/- 448.336
Z_sat: -513.431 +/- 1134.883
nbreak: 0.248 +/- 0.043
n_CSE_0_u: 0.479 +/- 0.288
cs2_CSE_0: 0.653 +/- 0.221
n_CSE_1_u: 0.479 +/- 0.292
cs2_CSE_1: 0.534 +/- 0.276
n_CSE_2_u: 0.474 +/- 0.292
cs2_CSE_2: 0.507 +/- 0.283
n_CSE_3_u: 0.475 +/- 0.291
cs2_CSE_3: 0.500 +/- 0.285
n_CSE_4_u: 0.477 +/- 0.292
cs2_CSE_4: 0.504 +/- 0.280
n_CSE_5_u: 0.473 +/- 0.293
cs2_CSE_5: 0.498 +/- 0.283
n_CSE_6_u: 0.472 +/- 0.292
cs2_CSE_6: 0.497 +/- 0.282
n_CSE_7_u: 0.478 +/- 0.292
cs2_CSE_7: 0.502 +/- 0.281
cs2_CSE_8: 0.493 +/- 0.285
mass_1_GW170817: 1.513 +/- 0.108
mass_2_GW170817: 1.247 +/- 0.079
mass_J0030: 1.367 +/- 0.149
mass_J0740: 2.032 +/- 0.103
Log probability: -36555.937 +/- 702493.152
Local acceptance: 0.959 +/- 0.198
Global acceptance: 0.080 +/- 0.271
Max loss: 51.034, Min loss: 34.701
Production summary
==========
E_sym: 37.090 +/- 4.909
L_sym: 46.047 +/- 24.412
K_sym: -136.987 +/- 105.402
Q_sym: -16.946 +/- 454.901
Z_sym: -490.543 +/- 1133.499
K_sat: 217.150 +/- 42.430
Q_sat: 268.586 +/- 459.578
Z_sat: -514.287 +/- 1160.602
nbreak: 0.247 +/- 0.045
n_CSE_0_u: 0.472 +/- 0.292
cs2_CSE_0: 0.625 +/- 0.237
n_CSE_1_u: 0.470 +/- 0.295
cs2_CSE_1: 0.535 +/- 0.283
n_CSE_2_u: 0.491 +/- 0.295
cs2_CSE_2: 0.505 +/- 0.291
n_CSE_3_u: 0.492 +/- 0.298
cs2_CSE_3: 0.511 +/- 0.287
n_CSE_4_u: 0.483 +/- 0.303
cs2_CSE_4: 0.508 +/- 0.287
n_CSE_5_u: 0.472 +/- 0.295
cs2_CSE_5: 0.508 +/- 0.285
n_CSE_6_u: 0.473 +/- 0.299
cs2_CSE_6: 0.512 +/- 0.289
n_CSE_7_u: 0.491 +/- 0.291
cs2_CSE_7: 0.501 +/- 0.290
cs2_CSE_8: 0.505 +/- 0.294
mass_1_GW170817: 1.509 +/- 0.103
mass_2_GW170817: 1.244 +/- 0.078
mass_J0030: 1.352 +/- 0.125
mass_J0740: 2.040 +/- 0.076
Log probability: -69.669 +/- 1.975
Local acceptance: 0.934 +/- 0.248
Global acceptance: 0.060 +/- 0.238
S has been successful, now we will do some postprocessing. Sampling time: roughly 50 mins
Saving the final results
Number of samples generated in training: 420000
Number of samples generated in production: 420000
Number of samples generated: 840000
Time taken for TOV map: 2.474992275238037 s
DONE entire script
suffix
all
Checking the convergence for outdir_all
list(data.keys())
['log_prob', 'E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
Key: E_sym
    rhat = 1.0784148578333528
    ess = 8073.519767965015
Key: L_sym
    rhat = 1.0883737370818785
    ess = 7204.384291325235
Key: K_sym
    rhat = 1.084625603206015
    ess = 7371.446218147491
Key: Q_sym
    rhat = 1.0842959973151547
    ess = 7436.302878865901
Key: Z_sym
    rhat = 1.0679956204672578
    ess = 9246.539419982915
Key: K_sat
    rhat = 1.0772995820821403
    ess = 8479.804639518416
Key: Q_sat
    rhat = 1.0821678835556183
    ess = 7610.6583692989225
Key: Z_sat
    rhat = 1.0804584687979482
    ess = 7871.530950897406
Key: nbreak
    rhat = 1.083442208181175
    ess = 7487.834566607258
Key: n_CSE_0_u
    rhat = 1.0762083386852346
    ess = 8349.58230130246
Key: cs2_CSE_0
    rhat = 1.0992130173952865
    ess = 6433.432166964804
Key: n_CSE_1_u
    rhat = 1.0809315596368443
    ess = 7782.522730397827
Key: cs2_CSE_1
    rhat = 1.0804564117892888
    ess = 7916.119255114486
Key: n_CSE_2_u
    rhat = 1.0799016276456863
    ess = 7925.811635079814
Key: cs2_CSE_2
    rhat = 1.088318356527206
    ess = 7120.476227889588
Key: n_CSE_3_u
    rhat = 1.0813170518035755
    ess = 7858.807068467439
Key: cs2_CSE_3
    rhat = 1.0803827711145768
    ess = 7844.157844573133
Key: n_CSE_4_u
    rhat = 1.1063586427559697
    ess = 6009.10665352192
Key: cs2_CSE_4
    rhat = 1.075363366603585
    ess = 8355.159978728889
Key: n_CSE_5_u
    rhat = 1.0823155449166055
    ess = 7603.0921115032415
Key: cs2_CSE_5
    rhat = 1.0764859728792089
    ess = 8199.590446373366
Key: n_CSE_6_u
    rhat = 1.0892516728268902
    ess = 7022.63373173571
Key: cs2_CSE_6
    rhat = 1.0753950009913629
    ess = 8391.825081471605
Key: n_CSE_7_u
    rhat = 1.0780851050560316
    ess = 8243.632888824859
Key: cs2_CSE_7
    rhat = 1.0795759098290432
    ess = 7908.795898043342
Key: cs2_CSE_8
    rhat = 1.0858146295586208
    ess = 7414.967495924214
Key: mass_1_GW170817
    rhat = 1.0930230327233108
    ess = 6830.48283219932
Key: mass_2_GW170817
    rhat = 1.092333497012556
    ess = 6877.671925256679
Key: mass_J0030
    rhat = 1.0758023786396242
    ess = 8372.797711306092
Key: mass_J0740
    rhat = 1.0758279252061915
    ess = 8310.38388942409
Making plots for outdir_all
Number of samples: 10000
Creating NS plot . . .
  0%|          | 0/3001 [00:00<?, ?it/s]  4%|▎         | 111/3001 [00:00<00:02, 1109.76it/s]  7%|▋         | 225/3001 [00:00<00:02, 1127.44it/s] 11%|█▏        | 338/3001 [00:00<00:03, 825.51it/s]  15%|█▌        | 453/3001 [00:00<00:02, 929.62it/s] 19%|█▉        | 568/3001 [00:00<00:02, 997.03it/s] 23%|██▎       | 683/3001 [00:00<00:02, 1042.66it/s] 27%|██▋       | 798/3001 [00:00<00:02, 1073.45it/s] 30%|███       | 909/3001 [00:01<00:02, 789.34it/s]  34%|███▍      | 1026/3001 [00:01<00:02, 879.40it/s] 38%|███▊      | 1142/3001 [00:01<00:01, 949.18it/s] 42%|████▏     | 1258/3001 [00:01<00:01, 1003.63it/s] 46%|████▌     | 1373/3001 [00:01<00:01, 1043.22it/s] 50%|████▉     | 1489/3001 [00:01<00:01, 1074.99it/s] 53%|█████▎    | 1601/3001 [00:01<00:01, 749.57it/s]  57%|█████▋    | 1715/3001 [00:01<00:01, 835.41it/s] 61%|██████    | 1829/3001 [00:01<00:01, 908.20it/s] 65%|██████▍   | 1944/3001 [00:02<00:01, 967.89it/s] 69%|██████▊   | 2059/3001 [00:02<00:00, 1014.59it/s] 72%|███████▏  | 2174/3001 [00:02<00:00, 1051.05it/s] 76%|███████▋  | 2289/3001 [00:02<00:00, 1078.05it/s] 80%|████████  | 2404/3001 [00:02<00:00, 1098.02it/s] 84%|████████▍ | 2517/3001 [00:02<00:00, 678.96it/s]  88%|████████▊ | 2631/3001 [00:02<00:00, 772.17it/s] 92%|█████████▏| 2746/3001 [00:02<00:00, 855.81it/s] 95%|█████████▌| 2862/3001 [00:03<00:00, 928.96it/s] 99%|█████████▉| 2977/3001 [00:03<00:00, 984.21it/s]100%|██████████| 3001/3001 [00:03<00:00, 935.41it/s]
Bad counter: 6
Creating NS plot . . . DONE
Making histograms . . .
Reading Hauke data
Loading weights from /home/twouters2/hauke_eos/weights/all.txt
Weights at these bad indices
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
Shape of mtov_list: (99941,)
Shape of r14_list: (99941,)
Shape of l14_list: (99941,)
Shape of ntov_list: (0,)
Shape of p3nsat_list: (99941,)
np.shape(weights)
(99941,)
Reading Hauke data DONE
Creating histograms . . .
  0%|          | 0/10000 [00:00<?, ?it/s] 52%|█████▏    | 5158/10000 [00:00<00:00, 51569.11it/s]100%|██████████| 10000/10000 [00:00<00:00, 51310.36it/s]
Negative counter: 10
Mass at 2 nsat: 0.77-0.50+0.49
MTOV credible interval for Jester



2.23-0.22+0.35 (at 0.95 HDI prob)



MTOV credible interval for Hauke



2.17-1.01+0.97 (at 0.95 HDI prob)



R1.4 credible interval for Jester



12.62-1.03+1.06 (at 0.95 HDI prob)



R1.4 credible interval for Jester



12.62-1.03+1.06 (at 0.95 HDI prob)



R1.4 credible interval for Koehn+



12.25-0.93+0.79 (at 0.95 HDI prob)



R1.4: 12.62-1.03+1.06
n_TOV: 5.9331 - 1.4248 + 1.3342
p3nsat credible interval for Jester



92.13-37.95+60.47 (at 0.95 HDI prob)



p3nsat credible interval for Koehn+



90.86-39.50+51.21 (at 0.95 HDI prob)



p3nsat: 92.13-37.95+60.47
This is the all-constraints run. Therefore, we also make the master plot!
Percentage of EOS samples that are above 0.33: 99.85%
Going to make the Hauke combination plot for outdir = outdir_all
  0%|          | 0/3001 [00:00<?, ?it/s]  9%|▉         | 276/3001 [00:00<00:00, 2750.51it/s] 18%|█▊        | 552/3001 [00:00<00:00, 2739.15it/s] 28%|██▊       | 826/3001 [00:00<00:00, 2737.32it/s] 37%|███▋      | 1102/3001 [00:00<00:00, 2743.63it/s] 46%|████▌     | 1377/3001 [00:01<00:01, 906.79it/s]  55%|█████▌    | 1657/3001 [00:01<00:01, 1181.00it/s] 65%|██████▍   | 1937/3001 [00:01<00:00, 1458.22it/s] 74%|███████▍  | 2219/3001 [00:01<00:00, 1725.45it/s] 83%|████████▎ | 2497/3001 [00:01<00:00, 1955.50it/s] 93%|█████████▎| 2778/3001 [00:01<00:00, 2158.24it/s]100%|██████████| 3001/3001 [00:01<00:00, 1673.53it/s]
DONE

JOB STATISTICS
==============
Job ID: 10321471
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 00:52:45
CPU Efficiency: 6.30% of 13:57:20 core-walltime
Job Wall-clock time: 00:52:20
Memory Utilized: 3.49 GB
Memory Efficiency: 17.47% of 20.00 GB
