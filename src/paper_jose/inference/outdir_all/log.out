Fri Mar 14 15:33:31 CET 2025
NVIDIA H100
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Using the broad EOS prior
Using the regular nbreak prior: U[1.0, 2.0] * 0.16
Fixed params loaded inside the MicroToMacroTransform:
    Q_sym: 0.0
    Z_sym: 0.0
    E_sat: -16.0
    Q_sat: 0.0
    Z_sat: 0.0
Loading data necessary for the event GW170817
Using GW170817 inference with agnostic prior
Loading data necessary for the event J0030 and sampling the with NICER masses
Loading data necessary for the event J0740 and sampling the with NICER masses
Not sampling PREX or CREX data now
Loading data necessary for the Chiral EFT
Sanity checking: likelihoods_list = [<paper_jose.utils.GWlikelihood_with_masses object at 0x14ece3bcbb50>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14d6d1e71120>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14d6d1caff40>, <paper_jose.utils.RadioTimingLikelihood object at 0x14d6dab0fb50>, <paper_jose.utils.RadioTimingLikelihood object at 0x14d6da9c7fd0>, <paper_jose.utils.RadioTimingLikelihood object at 0x14d6d1eb4610>, <paper_jose.utils.ChiEFTLikelihood object at 0x14d6d1eb43a0>]
len(likelihoods_list) = 7
Fixed params loaded inside the MicroToMacroTransform:
    Q_sym: 0.0
    Z_sym: 0.0
    E_sat: -16.0
    Q_sat: 0.0
    Z_sat: 0.0
We are going to give these kwargs to Jim:
{'n_loop_training': 20, 'n_loop_production': 20, 'n_chains': 1000, 'n_local_steps': 2, 'n_global_steps': 100, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 5}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'K_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
log_prob
[-1.00001285e+07 -1.07952709e+02 -1.41069146e+02]
Sampling seed is set to: 11
Global Tuning:   0%|          | 0/20 [00:00<?, ?it/s]Global Tuning:   5%|▌         | 1/20 [02:40<50:41, 160.08s/it]Global Tuning:  10%|█         | 2/20 [03:49<32:00, 106.71s/it]Global Tuning:  15%|█▌        | 3/20 [04:42<23:18, 82.27s/it] Global Tuning:  20%|██        | 4/20 [05:44<19:49, 74.37s/it]Global Tuning:  25%|██▌       | 5/20 [06:37<16:39, 66.63s/it]Global Tuning:  30%|███       | 6/20 [07:43<15:28, 66.29s/it]Global Tuning:  35%|███▌      | 7/20 [08:55<14:48, 68.33s/it]Global Tuning:  40%|████      | 8/20 [10:08<13:54, 69.56s/it]Global Tuning:  45%|████▌     | 9/20 [11:15<12:38, 68.95s/it]Global Tuning:  50%|█████     | 10/20 [12:13<10:55, 65.56s/it]Global Tuning:  55%|█████▌    | 11/20 [13:13<09:34, 63.88s/it]Global Tuning:  60%|██████    | 12/20 [14:10<08:13, 61.66s/it]Global Tuning:  65%|██████▌   | 13/20 [15:17<07:23, 63.29s/it]Global Tuning:  70%|███████   | 14/20 [16:37<06:50, 68.49s/it]Global Tuning:  75%|███████▌  | 15/20 [17:40<05:34, 66.86s/it]Global Tuning:  80%|████████  | 16/20 [18:48<04:28, 67.02s/it]Global Tuning:  85%|████████▌ | 17/20 [19:56<03:21, 67.27s/it]Global Tuning:  90%|█████████ | 18/20 [21:00<02:12, 66.46s/it]Global Tuning:  95%|█████████▌| 19/20 [22:05<01:05, 65.86s/it]Global Tuning: 100%|██████████| 20/20 [23:15<00:00, 67.16s/it]Global Tuning: 100%|██████████| 20/20 [23:15<00:00, 69.77s/it]
Compiling MALA body
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [00:56<17:48, 56.24s/it]Global Sampling:  10%|█         | 2/20 [02:02<18:39, 62.20s/it]Global Sampling:  15%|█▌        | 3/20 [03:08<18:02, 63.68s/it]Global Sampling:  20%|██        | 4/20 [04:11<16:55, 63.47s/it]Global Sampling:  25%|██▌       | 5/20 [05:23<16:41, 66.74s/it]Global Sampling:  30%|███       | 6/20 [06:33<15:48, 67.78s/it]Global Sampling:  35%|███▌      | 7/20 [07:41<14:41, 67.82s/it]Global Sampling:  40%|████      | 8/20 [08:40<13:01, 65.14s/it]Global Sampling:  45%|████▌     | 9/20 [09:41<11:40, 63.66s/it]Global Sampling:  50%|█████     | 10/20 [10:51<10:58, 65.83s/it]Global Sampling:  55%|█████▌    | 11/20 [12:00<09:58, 66.54s/it]Global Sampling:  60%|██████    | 12/20 [13:09<08:59, 67.46s/it]Global Sampling:  65%|██████▌   | 13/20 [14:19<07:56, 68.07s/it]Global Sampling:  70%|███████   | 14/20 [15:31<06:55, 69.26s/it]Global Sampling:  75%|███████▌  | 15/20 [16:41<05:48, 69.61s/it]Global Sampling:  80%|████████  | 16/20 [17:44<04:30, 67.68s/it]Global Sampling:  85%|████████▌ | 17/20 [18:52<03:22, 67.58s/it]Global Sampling:  90%|█████████ | 18/20 [19:59<02:15, 67.65s/it]Global Sampling:  95%|█████████▌| 19/20 [21:03<01:06, 66.32s/it]Global Sampling: 100%|██████████| 20/20 [22:12<00:00, 67.36s/it]Global Sampling: 100%|██████████| 20/20 [22:12<00:00, 66.65s/it]
Training summary
==========
E_sym: 36.694 +/- 4.769
L_sym: 51.314 +/- 31.679
K_sym: -131.328 +/- 105.798
K_sat: 218.223 +/- 42.214
nbreak: 0.250 +/- 0.044
n_CSE_0_u: 0.470 +/- 0.293
cs2_CSE_0: 0.675 +/- 0.214
n_CSE_1_u: 0.470 +/- 0.289
cs2_CSE_1: 0.526 +/- 0.276
n_CSE_2_u: 0.472 +/- 0.290
cs2_CSE_2: 0.501 +/- 0.282
n_CSE_3_u: 0.481 +/- 0.290
cs2_CSE_3: 0.504 +/- 0.284
n_CSE_4_u: 0.477 +/- 0.295
cs2_CSE_4: 0.499 +/- 0.282
n_CSE_5_u: 0.476 +/- 0.293
cs2_CSE_5: 0.507 +/- 0.283
n_CSE_6_u: 0.478 +/- 0.292
cs2_CSE_6: 0.493 +/- 0.283
n_CSE_7_u: 0.474 +/- 0.295
cs2_CSE_7: 0.491 +/- 0.285
cs2_CSE_8: 0.506 +/- 0.285
mass_1_GW170817: 1.515 +/- 0.109
mass_2_GW170817: 1.244 +/- 0.079
mass_J0030: 1.364 +/- 0.148
mass_J0740: 2.030 +/- 0.103
Log probability: -29761.499 +/- 623832.254
Local acceptance: 0.963 +/- 0.188
Global acceptance: 0.087 +/- 0.282
Max loss: 43.067, Min loss: 29.659
Production summary
==========
E_sym: 36.897 +/- 4.795
L_sym: 45.448 +/- 23.939
K_sym: -142.188 +/- 105.748
K_sat: 217.987 +/- 42.349
nbreak: 0.250 +/- 0.045
n_CSE_0_u: 0.476 +/- 0.292
cs2_CSE_0: 0.664 +/- 0.227
n_CSE_1_u: 0.478 +/- 0.294
cs2_CSE_1: 0.524 +/- 0.282
n_CSE_2_u: 0.464 +/- 0.296
cs2_CSE_2: 0.511 +/- 0.284
n_CSE_3_u: 0.460 +/- 0.295
cs2_CSE_3: 0.510 +/- 0.295
n_CSE_4_u: 0.463 +/- 0.297
cs2_CSE_4: 0.483 +/- 0.289
n_CSE_5_u: 0.472 +/- 0.296
cs2_CSE_5: 0.498 +/- 0.286
n_CSE_6_u: 0.471 +/- 0.288
cs2_CSE_6: 0.488 +/- 0.289
n_CSE_7_u: 0.494 +/- 0.294
cs2_CSE_7: 0.488 +/- 0.284
cs2_CSE_8: 0.522 +/- 0.294
mass_1_GW170817: 1.499 +/- 0.090
mass_2_GW170817: 1.250 +/- 0.070
mass_J0030: 1.342 +/- 0.123
mass_J0740: 2.039 +/- 0.077
Log probability: -38.564 +/- 1.963
Local acceptance: 0.950 +/- 0.219
Global acceptance: 0.046 +/- 0.210
S has been successful, now we will do some postprocessing. Sampling time: roughly 46 mins
Saving the final results
Number of samples generated in training: 420000
Number of samples generated in production: 420000
Number of samples generated: 840000
Time taken for TOV map: 2.3719418048858643 s
DONE entire script
suffix
all
Checking the convergence for outdir_all
list(data.keys())
['log_prob', 'E_sym', 'L_sym', 'K_sym', 'K_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
Key: E_sym
    rhat = 1.0871074734328616
    ess = 7315.1753170899865
Key: L_sym
    rhat = 1.0914824583620144
    ess = 6971.9270277594
Key: K_sym
    rhat = 1.1052669920464198
    ess = 6237.048867845498
Key: K_sat
    rhat = 1.1038896876035753
    ess = 6167.088557582955
Key: nbreak
    rhat = 1.0970003194876008
    ess = 6603.244533110873
Key: n_CSE_0_u
    rhat = 1.0943712044074172
    ess = 6846.881701737938
Key: cs2_CSE_0
    rhat = 1.1299470628699686
    ess = 5119.626679846611
Key: n_CSE_1_u
    rhat = 1.1041923555840705
    ess = 6532.908661937207
Key: cs2_CSE_1
    rhat = 1.0962358892017319
    ess = 6652.152642147666
Key: n_CSE_2_u
    rhat = 1.1017648716834576
    ess = 6303.333647143602
Key: cs2_CSE_2
    rhat = 1.096588707621287
    ess = 6602.54376315729
Key: n_CSE_3_u
    rhat = 1.0969308776766518
    ess = 6679.843615877004
Key: cs2_CSE_3
    rhat = 1.1096706099380456
    ess = 5855.210420746007
Key: n_CSE_4_u
    rhat = 1.1026381460996515
    ess = 6180.521141869895
Key: cs2_CSE_4
    rhat = 1.0966625011533184
    ess = 6598.04978751893
Key: n_CSE_5_u
    rhat = 1.1059918921565424
    ess = 6123.531280710357
Key: cs2_CSE_5
    rhat = 1.0944660429619502
    ess = 6820.976800766683
Key: n_CSE_6_u
    rhat = 1.0845889245413576
    ess = 7441.0256159273395
Key: cs2_CSE_6
    rhat = 1.0996105853665437
    ess = 6449.219776057862
Key: n_CSE_7_u
    rhat = 1.0972368607343463
    ess = 6507.630093667952
Key: cs2_CSE_7
    rhat = 1.090204638519936
    ess = 7011.041665457457
Key: cs2_CSE_8
    rhat = 1.104361728980453
    ess = 6241.488111498862
Key: mass_1_GW170817
    rhat = 1.0942394492558096
    ess = 6726.24296278294
Key: mass_2_GW170817
    rhat = 1.0967235630193817
    ess = 6581.768655204822
Key: mass_J0030
    rhat = 1.0948576063812794
    ess = 6664.749970662652
Key: mass_J0740
    rhat = 1.1015647488884006
    ess = 6349.556766654738
Making plots for outdir_all
Number of samples: 10000
Creating NS plot . . .
  0%|          | 0/3001 [00:00<?, ?it/s]  4%|▎         | 112/3001 [00:00<00:02, 1119.13it/s]  8%|▊         | 227/3001 [00:00<00:02, 1133.25it/s] 11%|█▏        | 341/3001 [00:00<00:03, 836.90it/s]  15%|█▌        | 455/3001 [00:00<00:02, 935.08it/s] 19%|█▉        | 569/3001 [00:00<00:02, 998.83it/s] 23%|██▎       | 684/3001 [00:00<00:02, 1044.45it/s] 27%|██▋       | 799/3001 [00:00<00:02, 1076.38it/s] 30%|███       | 910/3001 [00:00<00:02, 842.90it/s]  34%|███▍      | 1026/3001 [00:01<00:02, 920.98it/s] 38%|███▊      | 1142/3001 [00:01<00:01, 982.36it/s] 42%|████▏     | 1257/3001 [00:01<00:01, 1027.85it/s] 46%|████▌     | 1373/3001 [00:01<00:01, 1063.09it/s] 50%|████▉     | 1489/3001 [00:01<00:01, 1089.74it/s] 53%|█████▎    | 1601/3001 [00:01<00:01, 804.95it/s]  57%|█████▋    | 1716/3001 [00:01<00:01, 885.29it/s] 61%|██████    | 1832/3001 [00:01<00:01, 951.91it/s] 65%|██████▍   | 1944/3001 [00:02<00:01, 994.07it/s] 69%|██████▊   | 2059/3001 [00:02<00:00, 1036.26it/s] 72%|███████▏  | 2174/3001 [00:02<00:00, 1067.21it/s] 76%|███████▋  | 2289/3001 [00:02<00:00, 1088.62it/s] 80%|████████  | 2404/3001 [00:02<00:00, 1105.79it/s] 84%|████████▍ | 2517/3001 [00:02<00:00, 731.72it/s]  88%|████████▊ | 2633/3001 [00:02<00:00, 822.77it/s] 92%|█████████▏| 2748/3001 [00:02<00:00, 899.44it/s] 95%|█████████▌| 2863/3001 [00:02<00:00, 961.60it/s] 99%|█████████▉| 2978/3001 [00:03<00:00, 1010.29it/s]100%|██████████| 3001/3001 [00:03<00:00, 965.93it/s] 
Bad counter: 0
Creating NS plot . . . DONE
Making histograms . . .
Reading Hauke data
Loading weights from /home/twouters2/hauke_eos/weights/all.txt
Weights at these bad indices
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
Shape of mtov_list: (99941,)
Shape of r14_list: (99941,)
Shape of l14_list: (99941,)
Shape of ntov_list: (0,)
Shape of p3nsat_list: (99941,)
np.shape(weights)
(99941,)
Reading Hauke data DONE
Creating histograms . . .
  0%|          | 0/10000 [00:00<?, ?it/s] 52%|█████▏    | 5154/10000 [00:00<00:00, 51536.36it/s]100%|██████████| 10000/10000 [00:00<00:00, 51212.63it/s]
Negative counter: 3
Mass at 2 nsat: 0.73-0.50+0.47
MTOV credible interval for Jester



2.23-0.25+0.35 (at 0.95 HDI prob)



R1.4 credible interval for Jester



12.55-1.03+1.01 (at 0.95 HDI prob)



R1.4 credible interval for Jester



12.55-1.03+1.01 (at 0.95 HDI prob)



R1.4: 12.55-1.03+1.01
n_TOV: 5.9326 - 1.5622 + 1.2723
p3nsat credible interval for Jester



91.31-38.58+64.51 (at 0.95 HDI prob)



p3nsat: 91.31-38.58+64.51
This is the all-constraints run. Therefore, we also make the master plot!
Percentage of EOS samples that are above 0.33: 99.99%
Going to make the Hauke combination plot for outdir = outdir_all
  0%|          | 0/3001 [00:00<?, ?it/s]  9%|▉         | 274/3001 [00:00<00:00, 2735.46it/s] 18%|█▊        | 548/3001 [00:00<00:00, 2732.65it/s] 27%|██▋       | 824/3001 [00:00<00:00, 2742.06it/s] 37%|███▋      | 1099/3001 [00:00<00:00, 2744.15it/s] 46%|████▌     | 1374/3001 [00:00<00:01, 1037.67it/s] 55%|█████▌    | 1654/3001 [00:01<00:01, 1324.09it/s] 64%|██████▍   | 1934/3001 [00:01<00:00, 1601.58it/s] 74%|███████▍  | 2216/3001 [00:01<00:00, 1859.07it/s] 83%|████████▎ | 2496/3001 [00:01<00:00, 2077.08it/s] 93%|█████████▎| 2778/3001 [00:01<00:00, 2261.40it/s]100%|██████████| 3001/3001 [00:01<00:00, 1769.82it/s]
DONE

JOB STATISTICS
==============
Job ID: 10512377
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 00:49:00
CPU Efficiency: 6.30% of 12:57:52 core-walltime
Job Wall-clock time: 00:48:37
Memory Utilized: 2.91 GB
Memory Efficiency: 14.56% of 20.00 GB
