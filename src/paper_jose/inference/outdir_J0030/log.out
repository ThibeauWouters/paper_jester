Mon Mar 10 11:03:34 CET 2025
NVIDIA H100
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Using the broad EOS prior
Using the regular nbreak prior: U[1.0, 2.0] * 0.16
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Loading data necessary for the event J0030 and sampling the with NICER masses
Not sampling PREX or CREX data now
Sanity checking: likelihoods_list = [<paper_jose.utils.NICERLikelihood_with_masses object at 0x1491ec0abb50>]
len(likelihoods_list) = 1
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
We are going to give these kwargs to Jim:
{'n_loop_training': 20, 'n_loop_production': 20, 'n_chains': 1000, 'n_local_steps': 2, 'n_global_steps': 100, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 5}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_J0030']
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
log_prob
[-1.7428655  -1.64728711 -2.67650906]
Sampling seed is set to: 11
Global Tuning:   0%|          | 0/20 [00:00<?, ?it/s]Global Tuning:   5%|▌         | 1/20 [02:27<46:46, 147.72s/it]Global Tuning:  10%|█         | 2/20 [03:37<30:37, 102.08s/it]Global Tuning:  15%|█▌        | 3/20 [04:40<23:45, 83.86s/it] Global Tuning:  20%|██        | 4/20 [05:48<20:47, 77.94s/it]Global Tuning:  25%|██▌       | 5/20 [06:54<18:22, 73.52s/it]Global Tuning:  30%|███       | 6/20 [08:01<16:38, 71.33s/it]Global Tuning:  35%|███▌      | 7/20 [09:15<15:36, 72.07s/it]Global Tuning:  40%|████      | 8/20 [10:25<14:16, 71.38s/it]Global Tuning:  45%|████▌     | 9/20 [11:35<13:02, 71.10s/it]Global Tuning:  50%|█████     | 10/20 [12:45<11:46, 70.65s/it]Global Tuning:  55%|█████▌    | 11/20 [13:52<10:25, 69.53s/it]Global Tuning:  60%|██████    | 12/20 [14:59<09:11, 68.98s/it]Global Tuning:  65%|██████▌   | 13/20 [16:09<08:03, 69.01s/it]Global Tuning:  70%|███████   | 14/20 [17:16<06:51, 68.61s/it]Global Tuning:  75%|███████▌  | 15/20 [18:22<05:38, 67.61s/it]Global Tuning:  80%|████████  | 16/20 [19:33<04:34, 68.63s/it]Global Tuning:  85%|████████▌ | 17/20 [20:41<03:25, 68.59s/it]Global Tuning:  90%|█████████ | 18/20 [21:49<02:16, 68.43s/it]Global Tuning:  95%|█████████▌| 19/20 [22:58<01:08, 68.68s/it]Global Tuning: 100%|██████████| 20/20 [24:07<00:00, 68.69s/it]Global Tuning: 100%|██████████| 20/20 [24:07<00:00, 72.38s/it]
Compiling MALA body
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [01:05<20:48, 65.72s/it]Global Sampling:  10%|█         | 2/20 [02:15<20:29, 68.32s/it]Global Sampling:  15%|█▌        | 3/20 [03:19<18:46, 66.27s/it]Global Sampling:  20%|██        | 4/20 [04:26<17:45, 66.58s/it]Global Sampling:  25%|██▌       | 5/20 [05:31<16:29, 65.98s/it]Global Sampling:  30%|███       | 6/20 [06:39<15:31, 66.53s/it]Global Sampling:  35%|███▌      | 7/20 [07:46<14:28, 66.78s/it]Global Sampling:  40%|████      | 8/20 [08:54<13:24, 67.03s/it]Global Sampling:  45%|████▌     | 9/20 [10:01<12:19, 67.26s/it]Global Sampling:  50%|█████     | 10/20 [11:09<11:14, 67.49s/it]Global Sampling:  55%|█████▌    | 11/20 [12:19<10:13, 68.15s/it]Global Sampling:  60%|██████    | 12/20 [13:26<09:01, 67.73s/it]Global Sampling:  65%|██████▌   | 13/20 [14:31<07:49, 67.04s/it]Global Sampling:  70%|███████   | 14/20 [15:39<06:44, 67.41s/it]Global Sampling:  75%|███████▌  | 15/20 [16:46<05:35, 67.20s/it]Global Sampling:  80%|████████  | 16/20 [17:56<04:31, 67.88s/it]Global Sampling:  85%|████████▌ | 17/20 [19:04<03:24, 68.03s/it]Global Sampling:  90%|█████████ | 18/20 [20:10<02:14, 67.33s/it]Global Sampling:  95%|█████████▌| 19/20 [21:08<01:04, 64.72s/it]Global Sampling: 100%|██████████| 20/20 [22:16<00:00, 65.52s/it]Global Sampling: 100%|██████████| 20/20 [22:16<00:00, 66.81s/it]
Training summary
==========
E_sym: 36.635 +/- 4.889
L_sym: 99.856 +/- 53.264
K_sym: -98.549 +/- 114.154
Q_sym: 14.953 +/- 459.801
Z_sym: -504.197 +/- 1144.727
K_sat: 224.132 +/- 43.284
Q_sat: 312.248 +/- 460.563
Z_sat: -508.463 +/- 1151.299
nbreak: 0.244 +/- 0.045
n_CSE_0_u: 0.494 +/- 0.291
cs2_CSE_0: 0.550 +/- 0.268
n_CSE_1_u: 0.492 +/- 0.290
cs2_CSE_1: 0.508 +/- 0.286
n_CSE_2_u: 0.495 +/- 0.288
cs2_CSE_2: 0.503 +/- 0.286
n_CSE_3_u: 0.497 +/- 0.290
cs2_CSE_3: 0.501 +/- 0.289
n_CSE_4_u: 0.497 +/- 0.290
cs2_CSE_4: 0.497 +/- 0.287
n_CSE_5_u: 0.497 +/- 0.291
cs2_CSE_5: 0.497 +/- 0.288
n_CSE_6_u: 0.484 +/- 0.292
cs2_CSE_6: 0.497 +/- 0.287
n_CSE_7_u: 0.489 +/- 0.290
cs2_CSE_7: 0.498 +/- 0.288
cs2_CSE_8: 0.493 +/- 0.288
mass_J0030: 1.430 +/- 0.149
Log probability: -50.489 +/- 36.235
Local acceptance: 0.968 +/- 0.176
Global acceptance: 0.160 +/- 0.367
Max loss: 42.682, Min loss: 33.833
Production summary
==========
E_sym: 36.593 +/- 4.939
L_sym: 97.239 +/- 52.907
K_sym: -100.320 +/- 113.665
Q_sym: -0.545 +/- 456.406
Z_sym: -530.916 +/- 1128.530
K_sat: 223.529 +/- 43.840
Q_sat: 359.928 +/- 474.489
Z_sat: -545.459 +/- 1157.794
nbreak: 0.244 +/- 0.046
n_CSE_0_u: 0.489 +/- 0.289
cs2_CSE_0: 0.552 +/- 0.268
n_CSE_1_u: 0.493 +/- 0.289
cs2_CSE_1: 0.496 +/- 0.294
n_CSE_2_u: 0.487 +/- 0.292
cs2_CSE_2: 0.490 +/- 0.284
n_CSE_3_u: 0.496 +/- 0.292
cs2_CSE_3: 0.497 +/- 0.286
n_CSE_4_u: 0.503 +/- 0.287
cs2_CSE_4: 0.510 +/- 0.296
n_CSE_5_u: 0.474 +/- 0.296
cs2_CSE_5: 0.496 +/- 0.288
n_CSE_6_u: 0.492 +/- 0.292
cs2_CSE_6: 0.500 +/- 0.286
n_CSE_7_u: 0.498 +/- 0.287
cs2_CSE_7: 0.493 +/- 0.284
cs2_CSE_8: 0.499 +/- 0.286
mass_J0030: 1.424 +/- 0.146
Log probability: -49.335 +/- 0.948
Local acceptance: 0.952 +/- 0.215
Global acceptance: 0.130 +/- 0.337
S has been successful, now we will do some postprocessing. Sampling time: roughly 47 mins
Saving the final results
Number of samples generated in training: 420000
Number of samples generated in production: 420000
Number of samples generated: 840000
Time taken for TOV map: 2.336472988128662 s
DONE entire script
suffix
J0030
Checking the convergence for outdir_J0030
list(data.keys())
['log_prob', 'E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_J0030']
Key: E_sym
    rhat = 1.0331068561002772
    ess = 18935.38302446858
Key: L_sym
    rhat = 1.0285028450927916
    ess = 22661.547262679807
Key: K_sym
    rhat = 1.0314828452848952
    ess = 19441.711259724718
Key: Q_sym
    rhat = 1.028889340874272
    ess = 21629.348193752765
Key: Z_sym
    rhat = 1.028107162719945
    ess = 22669.36272354504
Key: K_sat
    rhat = 1.037491129135293
    ess = 16533.73031505839
Key: Q_sat
    rhat = 1.039598808227563
    ess = 16228.84083161226
Key: Z_sat
    rhat = 1.0398122244129173
    ess = 15681.34964967922
Key: nbreak
    rhat = 1.036192435620961
    ess = 17242.926265599344
Key: n_CSE_0_u
    rhat = 1.0286175739859584
    ess = 22989.66551881063
Key: cs2_CSE_0
    rhat = 1.0354850024083384
    ess = 17863.852087813164
Key: n_CSE_1_u
    rhat = 1.0306973319087527
    ess = 19888.1291736705
Key: cs2_CSE_1
    rhat = 1.0391170214819683
    ess = 16103.98068564474
Key: n_CSE_2_u
    rhat = 1.0346929592185992
    ess = 17672.1922584193
Key: cs2_CSE_2
    rhat = 1.0298285863401084
    ess = 24268.73028704326
Key: n_CSE_3_u
    rhat = 1.0342673545228847
    ess = 18108.079973889897
Key: cs2_CSE_3
    rhat = 1.0292989915803978
    ess = 21513.251511901715
Key: n_CSE_4_u
    rhat = 1.0278001605896345
    ess = 23060.52484178473
Key: cs2_CSE_4
    rhat = 1.0404489097398284
    ess = 14990.448156103957
Key: n_CSE_5_u
    rhat = 1.0392621452016395
    ess = 15762.156505470271
Key: cs2_CSE_5
    rhat = 1.0318515232051018
    ess = 19139.12927850549
Key: n_CSE_6_u
    rhat = 1.0323279744883318
    ess = 19539.957564083907
Key: cs2_CSE_6
    rhat = 1.0331740253586057
    ess = 18700.059241411574
Key: n_CSE_7_u
    rhat = 1.0275908939116847
    ess = 22844.9657830615
Key: cs2_CSE_7
    rhat = 1.0259447226120715
    ess = 26493.499549599805
Key: cs2_CSE_8
    rhat = 1.0298420107552424
    ess = 21302.75780187013
Key: mass_J0030
    rhat = 1.0283075720950203
    ess = 22741.1044054286
Making plots for outdir_J0030
Number of samples: 10000
Creating NS plot . . .
  0%|          | 0/3001 [00:00<?, ?it/s]  4%|▎         | 110/3001 [00:00<00:02, 1091.83it/s]  7%|▋         | 222/3001 [00:00<00:02, 1105.18it/s] 11%|█         | 333/3001 [00:00<00:03, 821.96it/s]  15%|█▍        | 446/3001 [00:00<00:02, 920.84it/s] 19%|█▊        | 559/3001 [00:00<00:02, 985.05it/s] 22%|██▏       | 673/3001 [00:00<00:02, 1031.46it/s] 26%|██▋       | 788/3001 [00:00<00:02, 1066.72it/s] 30%|██▉       | 898/3001 [00:00<00:02, 839.84it/s]  34%|███▍      | 1013/3001 [00:01<00:02, 916.91it/s] 38%|███▊      | 1127/3001 [00:01<00:01, 975.56it/s] 41%|████▏     | 1241/3001 [00:01<00:01, 1020.53it/s] 45%|████▌     | 1355/3001 [00:01<00:01, 1053.90it/s] 49%|████▉     | 1466/3001 [00:01<00:01, 1068.26it/s] 53%|█████▎    | 1576/3001 [00:01<00:01, 776.39it/s]  56%|█████▋    | 1691/3001 [00:01<00:01, 860.79it/s] 60%|██████    | 1806/3001 [00:01<00:01, 931.54it/s] 64%|██████▍   | 1919/3001 [00:02<00:01, 983.27it/s] 68%|██████▊   | 2033/3001 [00:02<00:00, 1023.88it/s] 72%|███████▏  | 2146/3001 [00:02<00:00, 1052.52it/s] 75%|███████▌  | 2259/3001 [00:02<00:00, 1074.41it/s] 79%|███████▉  | 2373/3001 [00:02<00:00, 1091.08it/s] 83%|████████▎ | 2485/3001 [00:02<00:00, 738.78it/s]  87%|████████▋ | 2599/3001 [00:02<00:00, 825.08it/s] 90%|█████████ | 2713/3001 [00:02<00:00, 898.99it/s] 94%|█████████▍| 2828/3001 [00:02<00:00, 960.69it/s] 98%|█████████▊| 2942/3001 [00:03<00:00, 1007.53it/s]100%|██████████| 3001/3001 [00:03<00:00, 958.14it/s] 
Bad counter: 3
Creating NS plot . . . DONE
Making histograms . . .
Reading Hauke data
Loading weights from /home/twouters2/hauke_eos/weights/J0030.txt
Weights at these bad indices
[0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 1.24281996e-05
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 1.52483356e-05]
Shape of mtov_list: (99941,)
Shape of r14_list: (99941,)
Shape of l14_list: (99941,)
Shape of ntov_list: (0,)
Shape of p3nsat_list: (99941,)
np.shape(weights)
(99941,)
Reading Hauke data DONE
Creating histograms . . .
  0%|          | 0/10000 [00:00<?, ?it/s] 52%|█████▏    | 5164/10000 [00:00<00:00, 51627.86it/s]100%|██████████| 10000/10000 [00:00<00:00, 51555.89it/s]
Negative counter: 7
Mass at 2 nsat: 1.08-0.73+0.99
MTOV credible interval for Jester



2.19-0.76+0.78 (at 0.95 HDI prob)



R1.4 credible interval for Jester



13.48-2.15+1.42 (at 0.95 HDI prob)



R1.4 credible interval for Jester



13.48-2.15+1.42 (at 0.95 HDI prob)



R1.4: 13.48-2.15+1.42
n_TOV: 5.5993 - 2.5872 + 3.6548
p3nsat credible interval for Jester



93.95-62.41+134.54 (at 0.95 HDI prob)



p3nsat: 93.95-62.41+134.54
Going to make the Hauke combination plot for outdir = outdir_J0030
  0%|          | 0/3001 [00:00<?, ?it/s]  9%|▉         | 276/3001 [00:00<00:00, 2749.68it/s] 18%|█▊        | 551/3001 [00:00<00:00, 2747.61it/s] 28%|██▊       | 826/3001 [00:00<00:00, 2742.70it/s] 37%|███▋      | 1101/3001 [00:00<00:00, 2743.67it/s] 46%|████▌     | 1376/3001 [00:00<00:00, 2744.38it/s] 55%|█████▌    | 1651/3001 [00:00<00:00, 2735.19it/s] 64%|██████▍   | 1925/3001 [00:01<00:00, 1113.91it/s] 73%|███████▎  | 2203/3001 [00:01<00:00, 1379.07it/s] 83%|████████▎ | 2484/3001 [00:01<00:00, 1643.81it/s] 92%|█████████▏| 2765/3001 [00:01<00:00, 1886.85it/s]100%|██████████| 3001/3001 [00:01<00:00, 1953.81it/s]
DONE

JOB STATISTICS
==============
Job ID: 10413539
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 00:49:52
CPU Efficiency: 6.22% of 13:21:20 core-walltime
Job Wall-clock time: 00:50:05
Memory Utilized: 2.70 GB
Memory Efficiency: 13.48% of 20.00 GB
