Mon Mar 10 11:03:53 CET 2025
NVIDIA H100
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Using the broad EOS prior
Using the regular nbreak prior: U[1.0, 2.0] * 0.16
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Using the zero likelihood:
We are going to give these kwargs to Jim:
{'n_loop_training': 20, 'n_loop_production': 20, 'n_chains': 1000, 'n_local_steps': 2, 'n_global_steps': 100, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 5}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8']
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
log_prob
[0. 0. 0.]
Sampling seed is set to: 11
Global Tuning:   0%|          | 0/20 [00:00<?, ?it/s]Global Tuning:   5%|▌         | 1/20 [00:33<10:38, 33.60s/it]Global Tuning:  10%|█         | 2/20 [00:34<04:18, 14.35s/it]Global Tuning:  15%|█▌        | 3/20 [00:35<02:18,  8.17s/it]Global Tuning:  20%|██        | 4/20 [00:36<01:24,  5.27s/it]Global Tuning:  25%|██▌       | 5/20 [00:36<00:55,  3.67s/it]Global Tuning:  30%|███       | 6/20 [00:37<00:37,  2.70s/it]Global Tuning:  35%|███▌      | 7/20 [00:38<00:27,  2.09s/it]Global Tuning:  40%|████      | 8/20 [00:39<00:20,  1.69s/it]Global Tuning:  45%|████▌     | 9/20 [00:40<00:15,  1.41s/it]Global Tuning:  50%|█████     | 10/20 [00:41<00:12,  1.23s/it]Global Tuning:  55%|█████▌    | 11/20 [00:41<00:09,  1.11s/it]Global Tuning:  60%|██████    | 12/20 [00:42<00:08,  1.02s/it]Global Tuning:  65%|██████▌   | 13/20 [00:43<00:06,  1.04it/s]Global Tuning:  70%|███████   | 14/20 [00:44<00:05,  1.08it/s]Global Tuning:  75%|███████▌  | 15/20 [00:45<00:04,  1.12it/s]Global Tuning:  80%|████████  | 16/20 [00:46<00:03,  1.15it/s]Global Tuning:  85%|████████▌ | 17/20 [00:46<00:02,  1.17it/s]Global Tuning:  90%|█████████ | 18/20 [00:47<00:01,  1.18it/s]Global Tuning:  95%|█████████▌| 19/20 [00:48<00:00,  1.19it/s]Global Tuning: 100%|██████████| 20/20 [00:49<00:00,  1.20it/s]Global Tuning: 100%|██████████| 20/20 [00:49<00:00,  2.47s/it]
Compiling MALA body
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [00:00<00:03,  5.73it/s]Global Sampling:  10%|█         | 2/20 [00:00<00:02,  6.03it/s]Global Sampling:  15%|█▌        | 3/20 [00:00<00:02,  6.14it/s]Global Sampling:  20%|██        | 4/20 [00:00<00:02,  6.20it/s]Global Sampling:  25%|██▌       | 5/20 [00:00<00:02,  6.23it/s]Global Sampling:  30%|███       | 6/20 [00:00<00:02,  6.24it/s]Global Sampling:  35%|███▌      | 7/20 [00:01<00:02,  6.24it/s]Global Sampling:  40%|████      | 8/20 [00:01<00:01,  6.25it/s]Global Sampling:  45%|████▌     | 9/20 [00:01<00:01,  6.26it/s]Global Sampling:  50%|█████     | 10/20 [00:01<00:01,  6.28it/s]Global Sampling:  55%|█████▌    | 11/20 [00:01<00:01,  6.28it/s]Global Sampling:  60%|██████    | 12/20 [00:01<00:01,  6.28it/s]Global Sampling:  65%|██████▌   | 13/20 [00:02<00:01,  6.29it/s]Global Sampling:  70%|███████   | 14/20 [00:02<00:00,  6.30it/s]Global Sampling:  75%|███████▌  | 15/20 [00:02<00:00,  6.30it/s]Global Sampling:  80%|████████  | 16/20 [00:02<00:00,  6.30it/s]Global Sampling:  85%|████████▌ | 17/20 [00:02<00:00,  6.28it/s]Global Sampling:  90%|█████████ | 18/20 [00:02<00:00,  6.27it/s]Global Sampling:  95%|█████████▌| 19/20 [00:03<00:00,  6.28it/s]Global Sampling: 100%|██████████| 20/20 [00:03<00:00,  6.29it/s]Global Sampling: 100%|██████████| 20/20 [00:03<00:00,  6.25it/s]
Training summary
==========
E_sym: 36.517 +/- 4.893
L_sym: 104.944 +/- 54.792
K_sym: -101.715 +/- 115.103
Q_sym: -0.998 +/- 461.383
Z_sym: -514.576 +/- 1149.880
K_sat: 224.585 +/- 43.126
Q_sat: 307.254 +/- 462.558
Z_sat: -490.208 +/- 1153.836
nbreak: 0.241 +/- 0.046
n_CSE_0_u: 0.498 +/- 0.287
cs2_CSE_0: 0.494 +/- 0.288
n_CSE_1_u: 0.503 +/- 0.288
cs2_CSE_1: 0.501 +/- 0.289
n_CSE_2_u: 0.504 +/- 0.290
cs2_CSE_2: 0.496 +/- 0.288
n_CSE_3_u: 0.498 +/- 0.287
cs2_CSE_3: 0.501 +/- 0.288
n_CSE_4_u: 0.502 +/- 0.287
cs2_CSE_4: 0.496 +/- 0.288
n_CSE_5_u: 0.506 +/- 0.289
cs2_CSE_5: 0.495 +/- 0.287
n_CSE_6_u: 0.506 +/- 0.289
cs2_CSE_6: 0.501 +/- 0.287
n_CSE_7_u: 0.495 +/- 0.287
cs2_CSE_7: 0.504 +/- 0.288
cs2_CSE_8: 0.502 +/- 0.287
Log probability: -48.593 +/- 0.000
Local acceptance: 0.967 +/- 0.178
Global acceptance: 0.162 +/- 0.368
Max loss: 43.067, Min loss: 32.585
Production summary
==========
E_sym: 36.636 +/- 4.854
L_sym: 105.677 +/- 55.408
K_sym: -105.063 +/- 115.399
Q_sym: 4.301 +/- 450.965
Z_sym: -442.016 +/- 1144.959
K_sat: 224.500 +/- 42.629
Q_sat: 304.690 +/- 453.288
Z_sat: -490.258 +/- 1140.661
nbreak: 0.241 +/- 0.046
n_CSE_0_u: 0.497 +/- 0.283
cs2_CSE_0: 0.506 +/- 0.295
n_CSE_1_u: 0.505 +/- 0.288
cs2_CSE_1: 0.502 +/- 0.284
n_CSE_2_u: 0.504 +/- 0.289
cs2_CSE_2: 0.501 +/- 0.282
n_CSE_3_u: 0.495 +/- 0.286
cs2_CSE_3: 0.482 +/- 0.288
n_CSE_4_u: 0.495 +/- 0.281
cs2_CSE_4: 0.519 +/- 0.292
n_CSE_5_u: 0.504 +/- 0.291
cs2_CSE_5: 0.497 +/- 0.286
n_CSE_6_u: 0.507 +/- 0.285
cs2_CSE_6: 0.524 +/- 0.294
n_CSE_7_u: 0.495 +/- 0.281
cs2_CSE_7: 0.499 +/- 0.287
cs2_CSE_8: 0.504 +/- 0.281
Log probability: -48.593 +/- 0.000
Local acceptance: 0.963 +/- 0.189
Global acceptance: 0.118 +/- 0.322
S has been successful, now we will do some postprocessing. Sampling time: roughly 2 mins
Saving the final results
Number of samples generated in training: 420000
Number of samples generated in production: 420000
Number of samples generated: 840000
Time taken for TOV map: 2.568347930908203 s
DONE entire script
suffix
prior
Checking the convergence for outdir_prior
list(data.keys())
['log_prob', 'E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8']
Key: E_sym
    rhat = 1.0218508097211805
    ess = 29359.296994336073
Key: L_sym
    rhat = 1.027813756387102
    ess = 23325.79668307606
Key: K_sym
    rhat = 1.0268651690221853
    ess = 24909.327023742182
Key: Q_sym
    rhat = 1.022489406598632
    ess = 27751.13640249887
Key: Z_sym
    rhat = 1.026526232957465
    ess = 24630.77118380151
Key: K_sat
    rhat = 1.023280993389971
    ess = 28352.934010817546
Key: Q_sat
    rhat = 1.0213771320059073
    ess = 31998.58365117115
Key: Z_sat
    rhat = 1.0253355371801813
    ess = 26169.60058130502
Key: nbreak
    rhat = 1.0268355401612017
    ess = 24223.320639743444
Key: n_CSE_0_u
    rhat = 1.025730081220294
    ess = 24379.403455528383
Key: cs2_CSE_0
    rhat = 1.0322679786483684
    ess = 20069.561413112795
Key: n_CSE_1_u
    rhat = 1.0264602879443112
    ess = 23920.949433761558
Key: cs2_CSE_1
    rhat = 1.0247125761971367
    ess = 25429.27021361174
Key: n_CSE_2_u
    rhat = 1.0252910047824788
    ess = 25813.54492485722
Key: cs2_CSE_2
    rhat = 1.0217609109862509
    ess = 31635.172309351416
Key: n_CSE_3_u
    rhat = 1.0298710338096257
    ess = 22076.008545099365
Key: cs2_CSE_3
    rhat = 1.026856103516951
    ess = 23646.77009966328
Key: n_CSE_4_u
    rhat = 1.021114967475675
    ess = 30436.129308547126
Key: cs2_CSE_4
    rhat = 1.0300620412525567
    ess = 21345.644982529582
Key: n_CSE_5_u
    rhat = 1.0328430019788926
    ess = 19234.422456032986
Key: cs2_CSE_5
    rhat = 1.023601075305917
    ess = 28153.666422075617
Key: n_CSE_6_u
    rhat = 1.0228934541036927
    ess = 28336.369742733754
Key: cs2_CSE_6
    rhat = 1.0319244096414288
    ess = 19835.68900436949
Key: n_CSE_7_u
    rhat = 1.0215816278044267
    ess = 31097.19423093223
Key: cs2_CSE_7
    rhat = 1.0249646445050187
    ess = 26444.078300262277
Key: cs2_CSE_8
    rhat = 1.0223731798146216
    ess = 31371.319479811267
Making plots for outdir_prior
Number of samples: 10000
Creating NS plot . . .
  0%|          | 0/3001 [00:00<?, ?it/s]  4%|▍         | 113/3001 [00:00<00:02, 1128.98it/s]  8%|▊         | 227/3001 [00:00<00:02, 1133.94it/s] 11%|█▏        | 341/3001 [00:00<00:03, 831.77it/s]  15%|█▌        | 458/3001 [00:00<00:02, 938.94it/s] 19%|█▉        | 574/3001 [00:00<00:02, 1006.87it/s] 23%|██▎       | 693/3001 [00:00<00:02, 1062.41it/s] 27%|██▋       | 811/3001 [00:00<00:01, 1096.94it/s] 31%|███       | 924/3001 [00:00<00:02, 845.54it/s]  35%|███▍      | 1041/3001 [00:01<00:02, 925.60it/s] 39%|███▊      | 1161/3001 [00:01<00:01, 996.37it/s] 43%|████▎     | 1279/3001 [00:01<00:01, 1045.97it/s] 47%|████▋     | 1396/3001 [00:01<00:01, 1080.57it/s] 50%|█████     | 1513/3001 [00:01<00:01, 1104.97it/s] 54%|█████▍    | 1627/3001 [00:01<00:01, 812.93it/s]  58%|█████▊    | 1741/3001 [00:01<00:01, 888.36it/s] 62%|██████▏   | 1857/3001 [00:01<00:01, 954.86it/s] 66%|██████▌   | 1973/3001 [00:02<00:01, 1008.38it/s] 70%|██████▉   | 2090/3001 [00:02<00:00, 1051.25it/s] 74%|███████▎  | 2208/3001 [00:02<00:00, 1084.71it/s] 77%|███████▋  | 2324/3001 [00:02<00:00, 1105.06it/s] 81%|████████▏ | 2440/3001 [00:02<00:00, 1120.22it/s] 85%|████████▌ | 2555/3001 [00:02<00:00, 736.60it/s]  89%|████████▉ | 2672/3001 [00:02<00:00, 828.42it/s] 93%|█████████▎| 2788/3001 [00:02<00:00, 905.70it/s] 97%|█████████▋| 2904/3001 [00:03<00:00, 967.78it/s]100%|██████████| 3001/3001 [00:03<00:00, 973.32it/s]
Bad counter: 23
Creating NS plot . . . DONE
Making histograms . . .
Reading Hauke data
Loading weights from /home/twouters2/hauke_eos/weights/prior.txt
Weights at these bad indices
[1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05
 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05
 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05
 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05
 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05
 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05 1.e-05]
Shape of mtov_list: (99941,)
Shape of r14_list: (99941,)
Shape of l14_list: (99941,)
Shape of ntov_list: (0,)
Shape of p3nsat_list: (99941,)
np.shape(weights)
(99941,)
Reading Hauke data DONE
Creating histograms . . .
  0%|          | 0/10000 [00:00<?, ?it/s] 51%|█████▏    | 5127/10000 [00:00<00:00, 51264.92it/s]100%|██████████| 10000/10000 [00:00<00:00, 51306.72it/s]
Negative counter: 61
Mass at 2 nsat: 1.07-0.90+1.07
MTOV credible interval for Jester



2.10-0.97+0.95 (at 0.95 HDI prob)



R1.4 credible interval for Jester



13.58-3.41+1.67 (at 0.95 HDI prob)



R1.4 credible interval for Jester



13.58-3.41+1.67 (at 0.95 HDI prob)



R1.4: 13.58-3.41+1.67
n_TOV: 5.8363 - 3.3470 + 7.4800
p3nsat credible interval for Jester



85.26-74.26+152.80 (at 0.95 HDI prob)



p3nsat: 85.26-74.26+152.80
Going to make the Hauke combination plot for outdir = outdir_prior
  0%|          | 0/3001 [00:00<?, ?it/s]  9%|▉         | 278/3001 [00:00<00:00, 2774.72it/s] 19%|█▊        | 556/3001 [00:00<00:00, 2766.37it/s] 28%|██▊       | 833/3001 [00:00<00:00, 2761.85it/s] 37%|███▋      | 1110/3001 [00:00<00:00, 2752.73it/s] 46%|████▌     | 1386/3001 [00:00<00:00, 2746.27it/s] 55%|█████▌    | 1661/3001 [00:00<00:00, 2737.16it/s] 64%|██████▍   | 1935/3001 [00:01<00:00, 1106.18it/s] 74%|███████▍  | 2217/3001 [00:01<00:00, 1376.07it/s] 83%|████████▎ | 2496/3001 [00:01<00:00, 1636.11it/s] 93%|█████████▎| 2779/3001 [00:01<00:00, 1883.68it/s]100%|██████████| 3001/3001 [00:01<00:00, 1951.55it/s]
DONE

JOB STATISTICS
==============
Job ID: 10413558
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 00:03:42
CPU Efficiency: 3.30% of 01:52:00 core-walltime
Job Wall-clock time: 00:07:00
Memory Utilized: 2.09 GB
Memory Efficiency: 20.87% of 10.00 GB
