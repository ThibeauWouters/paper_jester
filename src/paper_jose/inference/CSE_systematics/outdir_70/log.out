Sat Dec 21 16:45:28 CET 2024
NVIDIA A100-SXM4-40GB
2024-12-21 16:45:30.980859: W external/xla/xla/service/gpu/nvptx_compiler.cc:836] The NVIDIA driver's CUDA version is 12.5 which is older than the PTX compiler version (12.6.85). Because the driver is older than the PTX compiler version, XLA is disabling parallel compilation, which may slow down compilation. You should update your NVIDIA driver or use the NVIDIA-provided CUDA forward compatibility packages.
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Loading data necessary for the event GW170817
Loading data necessary for the event J0030 and sampling the with NICER masses
Loading data necessary for the event J0740 and sampling the with NICER masses
Not sampling PREX or CREX data now
Loading data necessary for the Chiral EFT
Sanity checking: likelihoods_list = [<paper_jose.utils.GWlikelihood_with_masses object at 0x152cf5797a60>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x15233f948dc0>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x15233f7b02b0>, <paper_jose.utils.RadioTimingLikelihood object at 0x152be986ce50>, <paper_jose.utils.RadioTimingLikelihood object at 0x152be986da80>, <paper_jose.utils.RadioTimingLikelihood object at 0x152be986d810>, <paper_jose.utils.ChiEFTLikelihood object at 0x152be986e0b0>]
len(likelihoods_list) = 7
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
We are going to give these kwargs to Jim:
{'n_loop_training': 10, 'n_loop_production': 20, 'n_chains': 500, 'n_local_steps': 2, 'n_global_steps': 10, 'n_epochs': 10, 'train_thinning': 1, 'output_thinning': 1}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'n_CSE_8_u', 'cs2_CSE_8', 'n_CSE_9_u', 'cs2_CSE_9', 'n_CSE_10_u', 'cs2_CSE_10', 'n_CSE_11_u', 'cs2_CSE_11', 'n_CSE_12_u', 'cs2_CSE_12', 'n_CSE_13_u', 'cs2_CSE_13', 'n_CSE_14_u', 'cs2_CSE_14', 'n_CSE_15_u', 'cs2_CSE_15', 'n_CSE_16_u', 'cs2_CSE_16', 'n_CSE_17_u', 'cs2_CSE_17', 'n_CSE_18_u', 'cs2_CSE_18', 'n_CSE_19_u', 'cs2_CSE_19', 'n_CSE_20_u', 'cs2_CSE_20', 'n_CSE_21_u', 'cs2_CSE_21', 'n_CSE_22_u', 'cs2_CSE_22', 'n_CSE_23_u', 'cs2_CSE_23', 'n_CSE_24_u', 'cs2_CSE_24', 'n_CSE_25_u', 'cs2_CSE_25', 'n_CSE_26_u', 'cs2_CSE_26', 'n_CSE_27_u', 'cs2_CSE_27', 'n_CSE_28_u', 'cs2_CSE_28', 'n_CSE_29_u', 'cs2_CSE_29', 'n_CSE_30_u', 'cs2_CSE_30', 'n_CSE_31_u', 'cs2_CSE_31', 'n_CSE_32_u', 'cs2_CSE_32', 'n_CSE_33_u', 'cs2_CSE_33', 'n_CSE_34_u', 'cs2_CSE_34', 'n_CSE_35_u', 'cs2_CSE_35', 'n_CSE_36_u', 'cs2_CSE_36', 'n_CSE_37_u', 'cs2_CSE_37', 'n_CSE_38_u', 'cs2_CSE_38', 'n_CSE_39_u', 'cs2_CSE_39', 'n_CSE_40_u', 'cs2_CSE_40', 'n_CSE_41_u', 'cs2_CSE_41', 'n_CSE_42_u', 'cs2_CSE_42', 'n_CSE_43_u', 'cs2_CSE_43', 'n_CSE_44_u', 'cs2_CSE_44', 'n_CSE_45_u', 'cs2_CSE_45', 'n_CSE_46_u', 'cs2_CSE_46', 'n_CSE_47_u', 'cs2_CSE_47', 'n_CSE_48_u', 'cs2_CSE_48', 'n_CSE_49_u', 'cs2_CSE_49', 'n_CSE_50_u', 'cs2_CSE_50', 'n_CSE_51_u', 'cs2_CSE_51', 'n_CSE_52_u', 'cs2_CSE_52', 'n_CSE_53_u', 'cs2_CSE_53', 'n_CSE_54_u', 'cs2_CSE_54', 'n_CSE_55_u', 'cs2_CSE_55', 'n_CSE_56_u', 'cs2_CSE_56', 'n_CSE_57_u', 'cs2_CSE_57', 'n_CSE_58_u', 'cs2_CSE_58', 'n_CSE_59_u', 'cs2_CSE_59', 'n_CSE_60_u', 'cs2_CSE_60', 'n_CSE_61_u', 'cs2_CSE_61', 'n_CSE_62_u', 'cs2_CSE_62', 'n_CSE_63_u', 'cs2_CSE_63', 'n_CSE_64_u', 'cs2_CSE_64', 'n_CSE_65_u', 'cs2_CSE_65', 'n_CSE_66_u', 'cs2_CSE_66', 'n_CSE_67_u', 'cs2_CSE_67', 'n_CSE_68_u', 'cs2_CSE_68', 'n_CSE_69_u', 'cs2_CSE_69', 'cs2_CSE_70', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
log_prob
[-1.20955470e+02 -1.00001446e+07 -1.22706567e+02]
Global Tuning:   0%|          | 0/10 [00:00<?, ?it/s]Global Tuning:  10%|█         | 1/10 [04:01<36:10, 241.12s/it]Global Tuning:  20%|██        | 2/10 [04:42<16:28, 123.61s/it]Global Tuning:  30%|███       | 3/10 [05:23<10:00, 85.74s/it] Global Tuning:  40%|████      | 4/10 [06:03<06:47, 67.89s/it]Global Tuning:  50%|█████     | 5/10 [06:44<04:50, 58.03s/it]Global Tuning:  60%|██████    | 6/10 [07:25<03:29, 52.48s/it]Global Tuning:  70%|███████   | 7/10 [08:08<02:27, 49.28s/it]Global Tuning:  80%|████████  | 8/10 [08:49<01:33, 46.65s/it]Global Tuning:  90%|█████████ | 9/10 [09:30<00:44, 44.85s/it]Global Tuning: 100%|██████████| 10/10 [10:11<00:00, 43.66s/it]Global Tuning: 100%|██████████| 10/10 [10:11<00:00, 61.15s/it]
Compiling MALA body
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [00:38<12:20, 38.95s/it]Global Sampling:  10%|█         | 2/20 [01:18<11:46, 39.26s/it]Global Sampling:  15%|█▌        | 3/20 [01:57<11:05, 39.14s/it]Global Sampling:  20%|██        | 4/20 [02:36<10:25, 39.12s/it]Global Sampling:  25%|██▌       | 5/20 [03:17<09:54, 39.66s/it]Global Sampling:  30%|███       | 6/20 [03:57<09:16, 39.77s/it]Global Sampling:  35%|███▌      | 7/20 [04:36<08:36, 39.76s/it]Global Sampling:  40%|████      | 8/20 [05:17<07:59, 39.99s/it]Global Sampling:  45%|████▌     | 9/20 [05:58<07:24, 40.39s/it]Global Sampling:  50%|█████     | 10/20 [06:39<06:45, 40.60s/it]Global Sampling:  55%|█████▌    | 11/20 [07:20<06:05, 40.63s/it]Global Sampling:  60%|██████    | 12/20 [08:00<05:23, 40.39s/it]Global Sampling:  65%|██████▌   | 13/20 [08:41<04:45, 40.80s/it]Global Sampling:  70%|███████   | 14/20 [09:23<04:07, 41.17s/it]Global Sampling:  75%|███████▌  | 15/20 [10:05<03:25, 41.17s/it]Global Sampling:  80%|████████  | 16/20 [10:48<02:47, 41.78s/it]Global Sampling:  85%|████████▌ | 17/20 [11:27<02:03, 41.10s/it]Global Sampling:  90%|█████████ | 18/20 [12:07<01:21, 40.76s/it]Global Sampling:  95%|█████████▌| 19/20 [12:48<00:40, 40.80s/it]Global Sampling: 100%|██████████| 20/20 [13:28<00:00, 40.42s/it]Global Sampling: 100%|██████████| 20/20 [13:28<00:00, 40.41s/it]
/var/spool/slurm/slurmd/job9132235/slurm_script: line 35: 1398272 Killed                  python inference.py --outdir ./CSE_systematics/outdir_70/ --nb-cse 70 --sample-chiEFT True --sample-GW170817 True --use-GW170817-posterior-agnostic-prior True --sample-radio True --sample-J0030 True --sample-J0740 True --sample-NICER-masses True



Postprocessing now
Error: There is no run with the suffix '70'. Allowed suffixes are: ['all_test', 'GW170817_injection', 'GW170817_BL', 'chiEFT', 'all_no_chiEFT', 'J0030_m', 'PREX', 'GW170817_agnostic', 'GW170817_Hauke', 'all', 'GW170817', 'radio', 'CREX', 'J0740_m', 'J0740', 'J0030', 'prior']



Postprocessing done
DONE
slurmstepd: error: Detected 1 oom_kill event in StepId=9132235.batch. Some of the step tasks have been OOM Killed.

JOB STATISTICS
==============
Job ID: 9132235
Cluster: snellius
User/Group: twouters2/twouters2
State: OUT_OF_MEMORY (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 00:40:40
CPU Efficiency: 5.84% of 11:36:00 core-walltime
Job Wall-clock time: 00:38:40
Memory Utilized: 15.18 GB
Memory Efficiency: 75.89% of 20.00 GB
