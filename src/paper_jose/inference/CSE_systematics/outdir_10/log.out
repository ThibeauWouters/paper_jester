Mon Mar 17 17:22:43 CET 2025
NVIDIA H100
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Using the broad EOS prior
Using the regular nbreak prior: U[1.0, 2.0] * 0.16
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Loading data necessary for the event GW170817
Using GW170817 inference with agnostic prior
Not sampling PREX or CREX data now
Sanity checking: likelihoods_list = [<paper_jose.utils.GWlikelihood_with_masses object at 0x1486c2c6d9c0>]
len(likelihoods_list) = 1
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
We are going to give these kwargs to Jim:
{'n_loop_training': 20, 'n_loop_production': 20, 'n_chains': 1000, 'n_local_steps': 2, 'n_global_steps': 100, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 5}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'n_CSE_8_u', 'cs2_CSE_8', 'n_CSE_9_u', 'cs2_CSE_9', 'cs2_CSE_10', 'mass_1_GW170817', 'mass_2_GW170817']
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
log_prob
[-5.88096510e+01 -1.00001406e+07 -8.40971411e+01]
Sampling seed is set to: 11
Global Tuning:   0%|          | 0/20 [00:00<?, ?it/s]Global Tuning:   5%|▌         | 1/20 [02:44<52:04, 164.46s/it]Global Tuning:  10%|█         | 2/20 [03:56<33:00, 110.04s/it]Global Tuning:  15%|█▌        | 3/20 [05:05<25:51, 91.29s/it] Global Tuning:  20%|██        | 4/20 [06:15<22:08, 83.01s/it]Global Tuning:  25%|██▌       | 5/20 [07:28<19:47, 79.19s/it]Global Tuning:  30%|███       | 6/20 [08:46<18:23, 78.84s/it]Global Tuning:  35%|███▌      | 7/20 [10:03<16:57, 78.24s/it]Global Tuning:  40%|████      | 8/20 [11:18<15:26, 77.22s/it]Global Tuning:  45%|████▌     | 9/20 [12:36<14:11, 77.40s/it]Global Tuning:  50%|█████     | 10/20 [13:50<12:45, 76.53s/it]Global Tuning:  55%|█████▌    | 11/20 [15:04<11:20, 75.65s/it]Global Tuning:  60%|██████    | 12/20 [16:16<09:56, 74.60s/it]Global Tuning:  65%|██████▌   | 13/20 [17:30<08:40, 74.33s/it]Global Tuning:  70%|███████   | 14/20 [18:51<07:37, 76.32s/it]Global Tuning:  75%|███████▌  | 15/20 [20:07<06:21, 76.25s/it]Global Tuning:  80%|████████  | 16/20 [21:22<05:03, 75.86s/it]Global Tuning:  85%|████████▌ | 17/20 [22:40<03:50, 76.74s/it]Global Tuning:  90%|█████████ | 18/20 [23:58<02:33, 76.82s/it]Global Tuning:  95%|█████████▌| 19/20 [25:12<01:16, 76.10s/it]Global Tuning: 100%|██████████| 20/20 [26:26<00:00, 75.49s/it]Global Tuning: 100%|██████████| 20/20 [26:26<00:00, 79.33s/it]
Compiling MALA body
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [01:13<23:18, 73.63s/it]Global Sampling:  10%|█         | 2/20 [02:28<22:20, 74.46s/it]Global Sampling:  15%|█▌        | 3/20 [03:41<20:53, 73.75s/it]Global Sampling:  20%|██        | 4/20 [04:56<19:48, 74.26s/it]Global Sampling:  25%|██▌       | 5/20 [06:12<18:44, 74.97s/it]Global Sampling:  30%|███       | 6/20 [07:27<17:26, 74.77s/it]Global Sampling:  35%|███▌      | 7/20 [08:42<16:13, 74.85s/it]Global Sampling:  40%|████      | 8/20 [09:59<15:09, 75.77s/it]Global Sampling:  45%|████▌     | 9/20 [11:18<14:01, 76.48s/it]Global Sampling:  50%|█████     | 10/20 [12:38<12:55, 77.59s/it]Global Sampling:  55%|█████▌    | 11/20 [13:52<11:29, 76.64s/it]Global Sampling:  60%|██████    | 12/20 [15:09<10:12, 76.60s/it]Global Sampling:  65%|██████▌   | 13/20 [16:29<09:03, 77.68s/it]Global Sampling:  70%|███████   | 14/20 [17:43<07:39, 76.53s/it]Global Sampling:  75%|███████▌  | 15/20 [18:59<06:22, 76.44s/it]Global Sampling:  80%|████████  | 16/20 [20:14<05:04, 76.15s/it]Global Sampling:  85%|████████▌ | 17/20 [21:30<03:47, 75.94s/it]Global Sampling:  90%|█████████ | 18/20 [22:44<02:30, 75.33s/it]Global Sampling:  95%|█████████▌| 19/20 [23:57<01:14, 74.77s/it]Global Sampling: 100%|██████████| 20/20 [25:19<00:00, 76.92s/it]Global Sampling: 100%|██████████| 20/20 [25:19<00:00, 75.98s/it]
Training summary
==========
E_sym: 36.554 +/- 4.836
L_sym: 76.309 +/- 48.172
K_sym: -131.442 +/- 110.709
Q_sym: -56.103 +/- 452.831
Z_sym: -519.797 +/- 1135.971
K_sat: 216.105 +/- 42.366
Q_sat: 218.771 +/- 448.294
Z_sat: -554.352 +/- 1134.215
nbreak: 0.246 +/- 0.045
n_CSE_0_u: 0.508 +/- 0.282
cs2_CSE_0: 0.477 +/- 0.277
n_CSE_1_u: 0.508 +/- 0.284
cs2_CSE_1: 0.535 +/- 0.284
n_CSE_2_u: 0.501 +/- 0.283
cs2_CSE_2: 0.522 +/- 0.283
n_CSE_3_u: 0.502 +/- 0.281
cs2_CSE_3: 0.505 +/- 0.284
n_CSE_4_u: 0.511 +/- 0.284
cs2_CSE_4: 0.492 +/- 0.284
n_CSE_5_u: 0.497 +/- 0.283
cs2_CSE_5: 0.492 +/- 0.285
n_CSE_6_u: 0.507 +/- 0.285
cs2_CSE_6: 0.507 +/- 0.285
n_CSE_7_u: 0.496 +/- 0.282
cs2_CSE_7: 0.490 +/- 0.283
n_CSE_8_u: 0.501 +/- 0.285
cs2_CSE_8: 0.490 +/- 0.286
n_CSE_9_u: 0.505 +/- 0.283
cs2_CSE_9: 0.500 +/- 0.284
cs2_CSE_10: 0.507 +/- 0.284
mass_1_GW170817: 1.502 +/- 0.100
mass_2_GW170817: 1.253 +/- 0.075
Log probability: -34704.327 +/- 664045.341
Local acceptance: 0.941 +/- 0.235
Global acceptance: 0.093 +/- 0.291
Max loss: 51.734, Min loss: 37.241
Production summary
==========
E_sym: 36.541 +/- 4.874
L_sym: 75.876 +/- 48.808
K_sym: -136.687 +/- 107.363
Q_sym: -82.378 +/- 459.552
Z_sym: -552.933 +/- 1172.292
K_sat: 214.454 +/- 42.001
Q_sat: 202.043 +/- 448.566
Z_sat: -486.290 +/- 1153.288
nbreak: 0.248 +/- 0.045
n_CSE_0_u: 0.511 +/- 0.283
cs2_CSE_0: 0.465 +/- 0.281
n_CSE_1_u: 0.504 +/- 0.283
cs2_CSE_1: 0.549 +/- 0.285
n_CSE_2_u: 0.505 +/- 0.285
cs2_CSE_2: 0.519 +/- 0.290
n_CSE_3_u: 0.480 +/- 0.288
cs2_CSE_3: 0.501 +/- 0.289
n_CSE_4_u: 0.497 +/- 0.290
cs2_CSE_4: 0.477 +/- 0.286
n_CSE_5_u: 0.502 +/- 0.282
cs2_CSE_5: 0.507 +/- 0.290
n_CSE_6_u: 0.512 +/- 0.283
cs2_CSE_6: 0.536 +/- 0.302
n_CSE_7_u: 0.495 +/- 0.287
cs2_CSE_7: 0.503 +/- 0.289
n_CSE_8_u: 0.504 +/- 0.284
cs2_CSE_8: 0.472 +/- 0.289
n_CSE_9_u: 0.499 +/- 0.298
cs2_CSE_9: 0.510 +/- 0.285
cs2_CSE_10: 0.498 +/- 0.292
mass_1_GW170817: 1.498 +/- 0.091
mass_2_GW170817: 1.251 +/- 0.071
Log probability: -56.896 +/- 1.326
Local acceptance: 0.913 +/- 0.282
Global acceptance: 0.062 +/- 0.241
S has been successful, now we will do some postprocessing. Sampling time: roughly 53 mins
Saving the final results
Number of samples generated in training: 420000
Number of samples generated in production: 420000
Number of samples generated: 840000
Time taken for TOV map: 2.382889747619629 s
DONE entire script



Postprocessing now
suffix
10
Note: the given suffix is a number, therefore we assume this is a CSE systematics run, so we will make all plots
Checking the convergence for ./CSE_systematics/outdir_10/
list(data.keys())
['log_prob', 'E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'n_CSE_8_u', 'cs2_CSE_8', 'n_CSE_9_u', 'cs2_CSE_9', 'cs2_CSE_10', 'mass_1_GW170817', 'mass_2_GW170817']
Key: E_sym
    rhat = 1.0741123460707651
    ess = 8369.374222040393
Key: L_sym
    rhat = 1.078759364480106
    ess = 7942.61339576039
Key: K_sym
    rhat = 1.0701457947859578
    ess = 8986.175548905729
Key: Q_sym
    rhat = 1.0786458508228398
    ess = 7865.053482921076
Key: Z_sym
    rhat = 1.0869070860516408
    ess = 7187.443747597768
Key: K_sat
    rhat = 1.0764663920186694
    ess = 8313.860993108377
Key: Q_sat
    rhat = 1.0762309778223997
    ess = 8128.082883339603
Key: Z_sat
    rhat = 1.084095532137612
    ess = 7496.636802058485
Key: nbreak
    rhat = 1.0737455694228089
    ess = 8431.090311530661
Key: n_CSE_0_u
    rhat = 1.08190671951368
    ess = 7568.877988961082
Key: cs2_CSE_0
    rhat = 1.0953872380991425
    ess = 6553.0595527451205
Key: n_CSE_1_u
    rhat = 1.077274950930319
    ess = 8385.941584747194
Key: cs2_CSE_1
    rhat = 1.0887948180983098
    ess = 7161.9266822689915
Key: n_CSE_2_u
    rhat = 1.0743690090060969
    ess = 8524.354304144752
Key: cs2_CSE_2
    rhat = 1.0854361954996143
    ess = 7363.672727214979
Key: n_CSE_3_u
    rhat = 1.0902058343714276
    ess = 6962.162572062921
Key: cs2_CSE_3
    rhat = 1.0817875142962716
    ess = 7653.531954584342
Key: n_CSE_4_u
    rhat = 1.0847643453159341
    ess = 7410.288848495905
Key: cs2_CSE_4
    rhat = 1.0805365308435666
    ess = 7819.4327403263105
Key: n_CSE_5_u
    rhat = 1.082787439122737
    ess = 7891.266052746026
Key: cs2_CSE_5
    rhat = 1.093329292631399
    ess = 6715.089660719945
Key: n_CSE_6_u
    rhat = 1.0796413271883454
    ess = 7744.352465558371
Key: cs2_CSE_6
    rhat = 1.1199466733895906
    ess = 5343.665723320448
Key: n_CSE_7_u
    rhat = 1.0780805982717598
    ess = 7995.592991892332
Key: cs2_CSE_7
    rhat = 1.0762029074140655
    ess = 8278.677187300667
Key: n_CSE_8_u
    rhat = 1.0769503958455684
    ess = 8629.78771841861
Key: cs2_CSE_8
    rhat = 1.0805408771350173
    ess = 8374.347701634311
Key: n_CSE_9_u
    rhat = 1.1059360625388537
    ess = 6073.953696560416
Key: cs2_CSE_9
    rhat = 1.0822501889378282
    ess = 7519.919440024554
Key: cs2_CSE_10
    rhat = 1.090799567521969
    ess = 6844.67638911968
Key: mass_1_GW170817
    rhat = 1.0803644562049879
    ess = 7748.538694527019
Key: mass_2_GW170817
    rhat = 1.0800287730019218
    ess = 7791.2254058021945
Making plots for ./CSE_systematics/outdir_10/
Number of samples: 10000
Creating NS plot . . .
  0%|          | 0/3001 [00:00<?, ?it/s]  4%|▎         | 112/3001 [00:00<00:02, 1114.28it/s]  8%|▊         | 227/3001 [00:00<00:02, 1129.95it/s] 11%|█▏        | 340/3001 [00:00<00:03, 834.90it/s]  15%|█▌        | 451/3001 [00:00<00:02, 923.96it/s] 19%|█▉        | 565/3001 [00:00<00:02, 990.52it/s] 23%|██▎       | 681/3001 [00:00<00:02, 1040.69it/s] 27%|██▋       | 797/3001 [00:00<00:02, 1074.58it/s] 30%|███       | 908/3001 [00:00<00:02, 826.55it/s]  34%|███▍      | 1023/3001 [00:01<00:02, 906.14it/s] 38%|███▊      | 1139/3001 [00:01<00:01, 971.44it/s] 42%|████▏     | 1255/3001 [00:01<00:01, 1021.51it/s] 46%|████▌     | 1372/3001 [00:01<00:01, 1061.72it/s] 50%|████▉     | 1488/3001 [00:01<00:01, 1089.14it/s] 53%|█████▎    | 1601/3001 [00:01<00:01, 792.26it/s]  57%|█████▋    | 1717/3001 [00:01<00:01, 875.55it/s] 61%|██████    | 1832/3001 [00:01<00:01, 943.00it/s] 65%|██████▍   | 1947/3001 [00:02<00:01, 996.63it/s] 69%|██████▊   | 2063/3001 [00:02<00:00, 1038.82it/s] 73%|███████▎  | 2180/3001 [00:02<00:00, 1073.59it/s] 77%|███████▋  | 2297/3001 [00:02<00:00, 1100.80it/s] 80%|████████  | 2413/3001 [00:02<00:00, 1117.71it/s] 84%|████████▍ | 2528/3001 [00:02<00:00, 747.08it/s]  88%|████████▊ | 2644/3001 [00:02<00:00, 835.60it/s] 92%|█████████▏| 2760/3001 [00:02<00:00, 910.40it/s] 96%|█████████▌| 2877/3001 [00:02<00:00, 973.85it/s]100%|█████████▉| 2994/3001 [00:03<00:00, 1024.08it/s]100%|██████████| 3001/3001 [00:03<00:00, 966.17it/s] 
Bad counter: 12
Creating NS plot . . . DONE
Making histograms . . .
Reading Hauke data
Loading weights from /home/twouters2/hauke_eos/weights/all.txt
Weights at these bad indices
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
Shape of mtov_list: (99941,)
Shape of r14_list: (99941,)
Shape of l14_list: (99941,)
Shape of ntov_list: (0,)
Shape of p3nsat_list: (99941,)
np.shape(weights)
(99941,)
Reading Hauke data DONE
Creating histograms . . .
  0%|          | 0/10000 [00:00<?, ?it/s] 52%|█████▏    | 5232/10000 [00:00<00:00, 52314.94it/s]100%|██████████| 10000/10000 [00:00<00:00, 52270.03it/s]
Negative counter: 61
Mass at 2 nsat: 0.79-0.61+0.61
MTOV credible interval for Jester



1.99-0.52+0.75 (at 0.95 HDI prob)



R1.4 credible interval for Jester



12.39-2.34+1.87 (at 0.95 HDI prob)



R1.4 credible interval for Jester



12.39-2.34+1.87 (at 0.95 HDI prob)



R1.4: 12.39-2.34+1.87
n_TOV: 6.9390 - 3.1418 + 3.8276
p3nsat credible interval for Jester



65.72-46.09+116.92 (at 0.95 HDI prob)



p3nsat: 65.72-46.09+116.92
This is the all-constraints run. Therefore, we also make the master plot!
Percentage of EOS samples that are above 0.33: 75.47%
Going to make the Hauke combination plot for outdir = ./CSE_systematics/outdir_10/
  0%|          | 0/3001 [00:00<?, ?it/s]  9%|▉         | 275/3001 [00:00<00:00, 2748.12it/s] 18%|█▊        | 550/3001 [00:00<00:00, 2738.11it/s] 27%|██▋       | 824/3001 [00:00<00:00, 2733.42it/s] 37%|███▋      | 1098/3001 [00:00<00:00, 2734.36it/s] 46%|████▌     | 1372/3001 [00:00<00:01, 1023.40it/s] 55%|█████▌    | 1655/3001 [00:01<00:01, 1314.27it/s] 65%|██████▍   | 1938/3001 [00:01<00:00, 1596.84it/s] 74%|███████▍  | 2222/3001 [00:01<00:00, 1857.70it/s] 83%|████████▎ | 2504/3001 [00:01<00:00, 2079.74it/s] 93%|█████████▎| 2789/3001 [00:01<00:00, 2270.38it/s]100%|██████████| 3001/3001 [00:01<00:00, 1790.52it/s]



Postprocessing done
DONE

JOB STATISTICS
==============
Job ID: 10551883
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 00:55:58
CPU Efficiency: 6.30% of 14:47:44 core-walltime
Job Wall-clock time: 00:55:29
Memory Utilized: 3.01 GB
Memory Efficiency: 15.06% of 20.00 GB
