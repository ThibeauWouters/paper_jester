Fri Dec 20 11:41:23 CET 2024
NVIDIA A100-SXM4-40GB
2024-12-20 11:41:25.766302: W external/xla/xla/service/gpu/nvptx_compiler.cc:836] The NVIDIA driver's CUDA version is 12.5 which is older than the PTX compiler version (12.6.85). Because the driver is older than the PTX compiler version, XLA is disabling parallel compilation, which may slow down compilation. You should update your NVIDIA driver or use the NVIDIA-provided CUDA forward compatibility packages.
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Loading data necessary for the event GW170817
Loading data necessary for the event J0030 and sampling the with NICER masses
Loading data necessary for the event J0740 and sampling the with NICER masses
Not sampling PREX or CREX data now
Sanity checking: likelihoods_list = [<paper_jose.utils.GWlikelihood_with_masses object at 0x149c824ea740>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x149c818511e0>, <paper_jose.utils.NICERLikelihood_with_masses object at 0x14a50d4b89d0>, <paper_jose.utils.RadioTimingLikelihood object at 0x14a50d4b88e0>, <paper_jose.utils.RadioTimingLikelihood object at 0x14a50d4b89a0>, <paper_jose.utils.RadioTimingLikelihood object at 0x14a50d4ba6b0>]
len(likelihoods_list) = 6
We are going to give these kwargs to Jim:
{'n_loop_training': 20, 'n_loop_production': 20, 'n_chains': 500, 'n_local_steps': 2, 'n_global_steps': 10, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 1}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'n_CSE_8_u', 'cs2_CSE_8', 'n_CSE_9_u', 'cs2_CSE_9', 'n_CSE_10_u', 'cs2_CSE_10', 'n_CSE_11_u', 'cs2_CSE_11', 'n_CSE_12_u', 'cs2_CSE_12', 'n_CSE_13_u', 'cs2_CSE_13', 'n_CSE_14_u', 'cs2_CSE_14', 'n_CSE_15_u', 'cs2_CSE_15', 'n_CSE_16_u', 'cs2_CSE_16', 'n_CSE_17_u', 'cs2_CSE_17', 'n_CSE_18_u', 'cs2_CSE_18', 'n_CSE_19_u', 'cs2_CSE_19', 'n_CSE_20_u', 'cs2_CSE_20', 'n_CSE_21_u', 'cs2_CSE_21', 'n_CSE_22_u', 'cs2_CSE_22', 'n_CSE_23_u', 'cs2_CSE_23', 'n_CSE_24_u', 'cs2_CSE_24', 'n_CSE_25_u', 'cs2_CSE_25', 'n_CSE_26_u', 'cs2_CSE_26', 'n_CSE_27_u', 'cs2_CSE_27', 'n_CSE_28_u', 'cs2_CSE_28', 'n_CSE_29_u', 'cs2_CSE_29', 'n_CSE_30_u', 'cs2_CSE_30', 'n_CSE_31_u', 'cs2_CSE_31', 'n_CSE_32_u', 'cs2_CSE_32', 'n_CSE_33_u', 'cs2_CSE_33', 'n_CSE_34_u', 'cs2_CSE_34', 'n_CSE_35_u', 'cs2_CSE_35', 'n_CSE_36_u', 'cs2_CSE_36', 'n_CSE_37_u', 'cs2_CSE_37', 'n_CSE_38_u', 'cs2_CSE_38', 'n_CSE_39_u', 'cs2_CSE_39', 'cs2_CSE_40', 'mass_1_GW170817', 'mass_2_GW170817', 'mass_J0030', 'mass_J0740']
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
Global Tuning:   0%|          | 0/20 [00:00<?, ?it/s]Global Tuning:   5%|▌         | 1/20 [03:14<1:01:38, 194.66s/it]Global Tuning:  10%|█         | 2/20 [03:58<31:48, 106.04s/it]  Global Tuning:  15%|█▌        | 3/20 [04:41<21:49, 77.04s/it] Global Tuning:  20%|██        | 4/20 [05:24<17:00, 63.76s/it]Global Tuning:  25%|██▌       | 5/20 [06:06<13:59, 55.98s/it]Global Tuning:  30%|███       | 6/20 [06:49<12:00, 51.44s/it]Global Tuning:  35%|███▌      | 7/20 [07:32<10:31, 48.56s/it]Global Tuning:  40%|████      | 8/20 [08:13<09:16, 46.34s/it]Global Tuning:  45%|████▌     | 9/20 [08:55<08:14, 44.99s/it]Global Tuning:  50%|█████     | 10/20 [09:36<07:17, 43.78s/it]Global Tuning:  55%|█████▌    | 11/20 [10:14<06:16, 41.83s/it]Global Tuning:  60%|██████    | 12/20 [10:50<05:20, 40.04s/it]Global Tuning:  65%|██████▌   | 13/20 [11:24<04:29, 38.45s/it]Global Tuning:  70%|███████   | 14/20 [12:01<03:46, 37.80s/it]Global Tuning:  75%|███████▌  | 15/20 [12:38<03:07, 37.56s/it]Global Tuning:  80%|████████  | 16/20 [13:15<02:29, 37.46s/it]Global Tuning:  85%|████████▌ | 17/20 [13:51<01:50, 36.98s/it]Global Tuning:  90%|█████████ | 18/20 [14:27<01:13, 36.79s/it]Global Tuning:  95%|█████████▌| 19/20 [15:05<00:36, 36.99s/it]Global Tuning: 100%|██████████| 20/20 [15:40<00:00, 36.56s/it]Global Tuning: 100%|██████████| 20/20 [15:40<00:00, 47.03s/it]
Compiling MALA body
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [00:38<12:05, 38.16s/it]Global Sampling:  10%|█         | 2/20 [01:14<11:10, 37.25s/it]Global Sampling:  15%|█▌        | 3/20 [01:50<10:24, 36.74s/it]Global Sampling:  20%|██        | 4/20 [02:27<09:45, 36.57s/it]Global Sampling:  25%|██▌       | 5/20 [03:00<08:49, 35.33s/it]Global Sampling:  30%|███       | 6/20 [03:35<08:12, 35.16s/it]Global Sampling:  35%|███▌      | 7/20 [04:09<07:34, 34.97s/it]Global Sampling:  40%|████      | 8/20 [04:45<07:01, 35.15s/it]Global Sampling:  45%|████▌     | 9/20 [05:20<06:26, 35.14s/it]Global Sampling:  50%|█████     | 10/20 [05:56<05:52, 35.29s/it]Global Sampling:  55%|█████▌    | 11/20 [06:29<05:13, 34.83s/it]Global Sampling:  60%|██████    | 12/20 [07:05<04:41, 35.19s/it]Global Sampling:  65%|██████▌   | 13/20 [07:43<04:11, 35.95s/it]Global Sampling:  70%|███████   | 14/20 [08:19<03:34, 35.82s/it]Global Sampling:  75%|███████▌  | 15/20 [08:54<02:58, 35.75s/it]Global Sampling:  80%|████████  | 16/20 [09:30<02:22, 35.69s/it]Global Sampling:  85%|████████▌ | 17/20 [10:06<01:47, 36.00s/it]Global Sampling:  90%|█████████ | 18/20 [10:42<01:11, 35.82s/it]Global Sampling:  95%|█████████▌| 19/20 [11:18<00:35, 35.90s/it]Global Sampling: 100%|██████████| 20/20 [11:54<00:00, 35.92s/it]Global Sampling: 100%|██████████| 20/20 [11:54<00:00, 35.72s/it]
Training summary
==========
E_sym: 36.418 +/- 4.567
L_sym: 99.819 +/- 53.262
K_sym: -93.852 +/- 109.604
Q_sym: 25.778 +/- 449.536
Z_sym: -531.146 +/- 1054.664
K_sat: 228.802 +/- 42.147
Q_sat: 234.760 +/- 450.254
Z_sat: -643.173 +/- 1118.785
nbreak: 0.241 +/- 0.045
n_CSE_0_u: 0.496 +/- 0.274
cs2_CSE_0: 0.554 +/- 0.270
n_CSE_1_u: 0.479 +/- 0.283
cs2_CSE_1: 0.561 +/- 0.276
n_CSE_2_u: 0.509 +/- 0.270
cs2_CSE_2: 0.487 +/- 0.279
n_CSE_3_u: 0.482 +/- 0.270
cs2_CSE_3: 0.522 +/- 0.264
n_CSE_4_u: 0.469 +/- 0.281
cs2_CSE_4: 0.481 +/- 0.270
n_CSE_5_u: 0.497 +/- 0.268
cs2_CSE_5: 0.445 +/- 0.266
n_CSE_6_u: 0.524 +/- 0.277
cs2_CSE_6: 0.485 +/- 0.283
n_CSE_7_u: 0.487 +/- 0.276
cs2_CSE_7: 0.503 +/- 0.275
n_CSE_8_u: 0.448 +/- 0.283
cs2_CSE_8: 0.509 +/- 0.291
n_CSE_9_u: 0.532 +/- 0.274
cs2_CSE_9: 0.468 +/- 0.281
n_CSE_10_u: 0.446 +/- 0.269
cs2_CSE_10: 0.490 +/- 0.280
n_CSE_11_u: 0.473 +/- 0.277
cs2_CSE_11: 0.487 +/- 0.277
n_CSE_12_u: 0.478 +/- 0.272
cs2_CSE_12: 0.484 +/- 0.279
n_CSE_13_u: 0.506 +/- 0.283
cs2_CSE_13: 0.512 +/- 0.282
n_CSE_14_u: 0.530 +/- 0.287
cs2_CSE_14: 0.491 +/- 0.287
n_CSE_15_u: 0.499 +/- 0.282
cs2_CSE_15: 0.529 +/- 0.282
n_CSE_16_u: 0.535 +/- 0.291
cs2_CSE_16: 0.557 +/- 0.279
n_CSE_17_u: 0.448 +/- 0.271
cs2_CSE_17: 0.475 +/- 0.269
n_CSE_18_u: 0.532 +/- 0.298
cs2_CSE_18: 0.533 +/- 0.269
n_CSE_19_u: 0.497 +/- 0.280
cs2_CSE_19: 0.473 +/- 0.285
n_CSE_20_u: 0.488 +/- 0.271
cs2_CSE_20: 0.488 +/- 0.270
n_CSE_21_u: 0.521 +/- 0.303
cs2_CSE_21: 0.560 +/- 0.272
n_CSE_22_u: 0.508 +/- 0.274
cs2_CSE_22: 0.512 +/- 0.296
n_CSE_23_u: 0.554 +/- 0.281
cs2_CSE_23: 0.486 +/- 0.288
n_CSE_24_u: 0.481 +/- 0.281
cs2_CSE_24: 0.517 +/- 0.265
n_CSE_25_u: 0.552 +/- 0.285
cs2_CSE_25: 0.459 +/- 0.280
n_CSE_26_u: 0.523 +/- 0.289
cs2_CSE_26: 0.487 +/- 0.278
n_CSE_27_u: 0.518 +/- 0.283
cs2_CSE_27: 0.492 +/- 0.287
n_CSE_28_u: 0.498 +/- 0.278
cs2_CSE_28: 0.490 +/- 0.290
n_CSE_29_u: 0.452 +/- 0.270
cs2_CSE_29: 0.564 +/- 0.285
n_CSE_30_u: 0.509 +/- 0.277
cs2_CSE_30: 0.458 +/- 0.281
n_CSE_31_u: 0.505 +/- 0.270
cs2_CSE_31: 0.526 +/- 0.283
n_CSE_32_u: 0.480 +/- 0.284
cs2_CSE_32: 0.500 +/- 0.272
n_CSE_33_u: 0.515 +/- 0.285
cs2_CSE_33: 0.440 +/- 0.276
n_CSE_34_u: 0.504 +/- 0.277
cs2_CSE_34: 0.512 +/- 0.269
n_CSE_35_u: 0.445 +/- 0.264
cs2_CSE_35: 0.524 +/- 0.298
n_CSE_36_u: 0.502 +/- 0.296
cs2_CSE_36: 0.526 +/- 0.255
n_CSE_37_u: 0.479 +/- 0.276
cs2_CSE_37: 0.484 +/- 0.273
n_CSE_38_u: 0.497 +/- 0.300
cs2_CSE_38: 0.496 +/- 0.274
n_CSE_39_u: 0.472 +/- 0.275
cs2_CSE_39: 0.475 +/- 0.284
cs2_CSE_40: 0.479 +/- 0.276
mass_1_GW170817: 1.641 +/- 0.213
mass_2_GW170817: 1.235 +/- 0.137
mass_J0030: 1.448 +/- 0.267
mass_J0740: 1.935 +/- 0.260
Log probability: -700645.297 +/- 2714890.971
Local acceptance: 0.915 +/- 0.279
Global acceptance: 0.019 +/- 0.138
Max loss: 157.728, Min loss: 8.546
Production summary
==========
E_sym: 36.611 +/- 4.325
L_sym: 90.429 +/- 51.446
K_sym: -76.226 +/- 100.640
Q_sym: -8.433 +/- 436.798
Z_sym: -418.195 +/- 985.189
K_sat: 232.204 +/- 40.482
Q_sat: 164.187 +/- 413.111
Z_sat: -644.799 +/- 1048.103
nbreak: 0.240 +/- 0.041
n_CSE_0_u: 0.516 +/- 0.255
cs2_CSE_0: 0.667 +/- 0.234
n_CSE_1_u: 0.441 +/- 0.258
cs2_CSE_1: 0.653 +/- 0.234
n_CSE_2_u: 0.559 +/- 0.243
cs2_CSE_2: 0.517 +/- 0.279
n_CSE_3_u: 0.473 +/- 0.263
cs2_CSE_3: 0.518 +/- 0.246
n_CSE_4_u: 0.394 +/- 0.270
cs2_CSE_4: 0.505 +/- 0.260
n_CSE_5_u: 0.551 +/- 0.236
cs2_CSE_5: 0.371 +/- 0.238
n_CSE_6_u: 0.576 +/- 0.277
cs2_CSE_6: 0.409 +/- 0.262
n_CSE_7_u: 0.498 +/- 0.267
cs2_CSE_7: 0.533 +/- 0.259
n_CSE_8_u: 0.417 +/- 0.286
cs2_CSE_8: 0.531 +/- 0.285
n_CSE_9_u: 0.523 +/- 0.263
cs2_CSE_9: 0.449 +/- 0.282
n_CSE_10_u: 0.378 +/- 0.229
cs2_CSE_10: 0.469 +/- 0.270
n_CSE_11_u: 0.489 +/- 0.270
cs2_CSE_11: 0.508 +/- 0.266
n_CSE_12_u: 0.447 +/- 0.249
cs2_CSE_12: 0.448 +/- 0.274
n_CSE_13_u: 0.559 +/- 0.262
cs2_CSE_13: 0.519 +/- 0.290
n_CSE_14_u: 0.593 +/- 0.274
cs2_CSE_14: 0.461 +/- 0.269
n_CSE_15_u: 0.499 +/- 0.264
cs2_CSE_15: 0.567 +/- 0.275
n_CSE_16_u: 0.617 +/- 0.288
cs2_CSE_16: 0.566 +/- 0.257
n_CSE_17_u: 0.392 +/- 0.269
cs2_CSE_17: 0.445 +/- 0.266
n_CSE_18_u: 0.560 +/- 0.295
cs2_CSE_18: 0.546 +/- 0.264
n_CSE_19_u: 0.470 +/- 0.244
cs2_CSE_19: 0.422 +/- 0.284
n_CSE_20_u: 0.457 +/- 0.261
cs2_CSE_20: 0.497 +/- 0.256
n_CSE_21_u: 0.581 +/- 0.303
cs2_CSE_21: 0.623 +/- 0.243
n_CSE_22_u: 0.541 +/- 0.260
cs2_CSE_22: 0.522 +/- 0.305
n_CSE_23_u: 0.643 +/- 0.246
cs2_CSE_23: 0.443 +/- 0.272
n_CSE_24_u: 0.493 +/- 0.268
cs2_CSE_24: 0.526 +/- 0.261
n_CSE_25_u: 0.653 +/- 0.258
cs2_CSE_25: 0.461 +/- 0.265
n_CSE_26_u: 0.541 +/- 0.288
cs2_CSE_26: 0.444 +/- 0.262
n_CSE_27_u: 0.559 +/- 0.279
cs2_CSE_27: 0.448 +/- 0.296
n_CSE_28_u: 0.525 +/- 0.282
cs2_CSE_28: 0.490 +/- 0.283
n_CSE_29_u: 0.407 +/- 0.238
cs2_CSE_29: 0.647 +/- 0.269
n_CSE_30_u: 0.520 +/- 0.267
cs2_CSE_30: 0.476 +/- 0.265
n_CSE_31_u: 0.530 +/- 0.254
cs2_CSE_31: 0.545 +/- 0.261
n_CSE_32_u: 0.453 +/- 0.261
cs2_CSE_32: 0.518 +/- 0.273
n_CSE_33_u: 0.534 +/- 0.275
cs2_CSE_33: 0.379 +/- 0.246
n_CSE_34_u: 0.493 +/- 0.273
cs2_CSE_34: 0.468 +/- 0.257
n_CSE_35_u: 0.344 +/- 0.240
cs2_CSE_35: 0.576 +/- 0.286
n_CSE_36_u: 0.501 +/- 0.301
cs2_CSE_36: 0.549 +/- 0.230
n_CSE_37_u: 0.410 +/- 0.270
cs2_CSE_37: 0.444 +/- 0.252
n_CSE_38_u: 0.506 +/- 0.310
cs2_CSE_38: 0.466 +/- 0.277
n_CSE_39_u: 0.414 +/- 0.264
cs2_CSE_39: 0.478 +/- 0.278
cs2_CSE_40: 0.500 +/- 0.262
mass_1_GW170817: 1.684 +/- 0.134
mass_2_GW170817: 1.197 +/- 0.123
mass_J0030: 1.417 +/- 0.271
mass_J0740: 1.879 +/- 0.214
Log probability: -3449.450 +/- 182545.495
Local acceptance: 0.958 +/- 0.201
Global acceptance: 0.012 +/- 0.107
S has been successful, now we will do some postprocessing. Sampling time: roughly 30 mins
Saving the final results
Number of samples generated in training: 120000
Number of samples generated in production: 120000
Number of samples generated: 240000
Time taken for TOV map: 58.50034284591675 s
Making the final cornerplot
Traceback (most recent call last):
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/inference/inference.py", line 367, in <module>
    main(args)
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/inference/inference.py", line 360, in main
    utils_plotting.plot_corner(outdir, corner_samples, keys_to_plot)
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/inference/utils_plotting.py", line 62, in plot_corner
    samples = np.reshape(samples, (len(keys), -1))
  File "/home/twouters2/miniconda3/envs/jose/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 285, in reshape
    return _wrapfunc(a, 'reshape', newshape, order=order)
  File "/home/twouters2/miniconda3/envs/jose/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 56, in _wrapfunc
    return _wrapit(obj, method, *args, **kwds)
  File "/home/twouters2/miniconda3/envs/jose/lib/python3.10/site-packages/numpy/core/fromnumeric.py", line 45, in _wrapit
    result = getattr(asarray(obj), method)(*args, **kwds)
ValueError: cannot reshape array of size 1 into shape (8,newaxis)



Postprocessing now
2024-12-20 12:13:02.485646: W external/xla/xla/service/gpu/nvptx_compiler.cc:836] The NVIDIA driver's CUDA version is 12.5 which is older than the PTX compiler version (12.6.85). Because the driver is older than the PTX compiler version, XLA is disabling parallel compilation, which may slow down compilation. You should update your NVIDIA driver or use the NVIDIA-provided CUDA forward compatibility packages.
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Traceback (most recent call last):
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/inference/postprocessing.py", line 18, in <module>
    from paper_jose.inference.inference import prior_list
ImportError: cannot import name 'prior_list' from 'paper_jose.inference.inference' (/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/inference/inference.py)



Postprocessing done
DONE

JOB STATISTICS
==============
Job ID: 9125914
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 00:33:12
CPU Efficiency: 5.79% of 09:33:36 core-walltime
Job Wall-clock time: 00:31:52
Memory Utilized: 2.28 GB
Memory Efficiency: 11.40% of 20.00 GB
