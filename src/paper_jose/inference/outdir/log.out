Wed Dec 11 22:00:50 CET 2024
NVIDIA A100-SXM4-40GB
2024-12-11 22:00:54.572617: W external/xla/xla/service/gpu/nvptx_compiler.cc:836] The NVIDIA driver's CUDA version is 12.5 which is older than the PTX compiler version (12.6.85). Because the driver is older than the PTX compiler version, XLA is disabling parallel compilation, which may slow down compilation. You should update your NVIDIA driver or use the NVIDIA-provided CUDA forward compatibility packages.

Global Sampling:  95%|█████████▌| 19/20 [20:04<01:01, 61.43s/it]Warning: weights not properly specified, assuming constant weights instead.
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Loading data necessary for the event J0030
Not sampling NICER data now
Sanity checking: likelihoods_list = [<paper_jose.utils.NICERLikelihood object at 0x148c539b14b0>]
len(likelihoods_list) = 1
We are going to give these kwargs to Jim:
{'n_loop_training': 10, 'n_loop_production': 20, 'n_chains': 500, 'n_local_steps': 2, 'n_global_steps': 10, 'n_epochs': 10, 'train_thinning': 1, 'output_thinning': 1}
No sample transforms provided. Using prior parameters as sampling parameters
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']

Global Tuning:   0%|          | 0/10 [00:00<?, ?it/s]
Global Tuning:   0%|          | 0/10 [00:03<?, ?it/s]
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/inference/inference.py", line 290, in <module>
    main(args)
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/inference/inference.py", line 230, in main
    jim.sample(jax.random.PRNGKey(6))
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/jim/src/jimgw/jim.py", line 119, in sample
    self.sampler.sample(initial_position, None)  # type: ignore
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/flowMC/src/flowMC/Sampler.py", line 204, in sample
    ) = strategy(
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/flowMC/src/flowMC/strategy/global_tuning.py", line 92, in __call__
    ) = local_sampler.sample(
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/flowMC/src/flowMC/proposal/MALA.py", line 144, in sample
    logp = self.logpdf_vmap(initial_position, data)
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/jim/src/jimgw/jim.py", line 103, in posterior
    return self.likelihood.evaluate(named_params, data) + prior
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/utils.py", line 531, in evaluate
    all_log_likelihoods = jnp.array([likelihood.evaluate(params, data) for likelihood in self.likelihoods_list])
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/utils.py", line 531, in <listcomp>
    all_log_likelihoods = jnp.array([likelihood.evaluate(params, data) for likelihood in self.likelihoods_list])
  File "/gpfs/home6/twouters2/projects/jax_tov_eos/paper_jose/src/paper_jose/utils.py", line 375, in evaluate
    logy_maryland = self.maryland_posterior.log_prob(mr_grid)
  File "/home/twouters2/miniconda3/envs/jose/lib/python3.10/site-packages/flowjax/distributions.py", line 107, in log_prob
    lps = self._vectorize(self._log_prob)(x, condition)
  File "/home/twouters2/miniconda3/envs/jose/lib/python3.10/site-packages/jax/_src/numpy/vectorize.py", line 340, in wrapped
    result = vectorized_func(*squeezed_args)
  File "/home/twouters2/miniconda3/envs/jose/lib/python3.10/site-packages/jax/_src/numpy/vectorize.py", line 140, in wrapped
    out = func(*args)
  File "/home/twouters2/miniconda3/envs/jose/lib/python3.10/site-packages/jax/_src/numpy/vectorize.py", line 183, in new_func
    return func(*args, **kwargs, **static_kwargs)
  File "/home/twouters2/miniconda3/envs/jose/lib/python3.10/site-packages/flowjax/distributions.py", line 195, in _wrapper
    raise ValueError(
ValueError: Expected trailing dimensions matching (2,) for x; got (100,).
DONE

JOB STATISTICS
==============
Job ID: 9007851
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 00:01:17
CPU Efficiency: 5.48% of 00:23:24 core-walltime
Job Wall-clock time: 00:01:18
Memory Utilized: 883.50 MB
Memory Efficiency: 8.63% of 10.00 GB

Global Sampling: 100%|██████████| 20/20 [21:04<00:00, 61.14s/it]
Global Sampling: 100%|██████████| 20/20 [21:04<00:00, 63.24s/it]
Training summary
==========
E_sym: 36.724 +/- 4.783
L_sym: 101.790 +/- 52.895
K_sym: -101.662 +/- 111.635
Q_sym: -2.039 +/- 449.085
Z_sym: -510.016 +/- 1143.769
K_sat: 223.266 +/- 43.468
Q_sat: 300.827 +/- 452.381
Z_sat: -474.912 +/- 1147.157
nbreak: 0.244 +/- 0.046
n_CSE_0_u: 0.506 +/- 0.284
cs2_CSE_0: 0.495 +/- 0.273
n_CSE_1_u: 0.501 +/- 0.288
cs2_CSE_1: 0.487 +/- 0.282
n_CSE_2_u: 0.503 +/- 0.286
cs2_CSE_2: 0.502 +/- 0.283
n_CSE_3_u: 0.497 +/- 0.284
cs2_CSE_3: 0.511 +/- 0.285
n_CSE_4_u: 0.497 +/- 0.284
cs2_CSE_4: 0.492 +/- 0.282
n_CSE_5_u: 0.508 +/- 0.282
cs2_CSE_5: 0.501 +/- 0.285
n_CSE_6_u: 0.500 +/- 0.283
cs2_CSE_6: 0.503 +/- 0.287
n_CSE_7_u: 0.505 +/- 0.286
cs2_CSE_7: 0.499 +/- 0.288
cs2_CSE_8: 0.498 +/- 0.287
Log probability: -50.284 +/- 0.523
Local acceptance: 0.836 +/- 0.370
Global acceptance: 0.169 +/- 0.375
Max loss: 43.064, Min loss: 33.074
Production summary
==========
E_sym: 36.609 +/- 4.922
L_sym: 102.216 +/- 53.383
K_sym: -101.696 +/- 115.263
Q_sym: 13.255 +/- 465.635
Z_sym: -487.297 +/- 1173.017
K_sat: 222.920 +/- 43.259
Q_sat: 303.018 +/- 461.935
Z_sat: -513.658 +/- 1166.315
nbreak: 0.243 +/- 0.046
n_CSE_0_u: 0.507 +/- 0.285
cs2_CSE_0: 0.488 +/- 0.277
n_CSE_1_u: 0.497 +/- 0.291
cs2_CSE_1: 0.476 +/- 0.287
n_CSE_2_u: 0.503 +/- 0.287
cs2_CSE_2: 0.484 +/- 0.292
n_CSE_3_u: 0.513 +/- 0.286
cs2_CSE_3: 0.505 +/- 0.284
n_CSE_4_u: 0.508 +/- 0.288
cs2_CSE_4: 0.494 +/- 0.290
n_CSE_5_u: 0.495 +/- 0.286
cs2_CSE_5: 0.494 +/- 0.288
n_CSE_6_u: 0.495 +/- 0.280
cs2_CSE_6: 0.502 +/- 0.287
n_CSE_7_u: 0.511 +/- 0.290
cs2_CSE_7: 0.495 +/- 0.290
cs2_CSE_8: 0.501 +/- 0.293
Log probability: -50.237 +/- 0.452
Local acceptance: 0.799 +/- 0.401
Global acceptance: 0.172 +/- 0.377
Time taken: 2073.9596688747406 s
Saving the final results
Number of samples generated in training: 60000
Number of samples generated in production: 120000
Number of samples generated: 180000
Time taken for TOV map: 61.33568072319031 s
DONE
DONE

JOB STATISTICS
==============
Job ID: 9007225
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 00:36:56
CPU Efficiency: 5.61% of 10:57:54 core-walltime
Job Wall-clock time: 00:36:33
Memory Utilized: 2.25 GB
Memory Efficiency: 22.55% of 10.00 GB
