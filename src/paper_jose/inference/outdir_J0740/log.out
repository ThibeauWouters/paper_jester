Tue Apr 15 20:33:39 CEST 2025
NVIDIA H100
Warning: weights not properly specified, assuming constant weights instead.
GPU found?
[CudaDevice(id=0)]
Using the broad EOS prior
Using the regular nbreak prior: U[1.0, 2.0] * 0.16
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
Loading data necessary for the event J0740 and sampling the with NICER masses
Not sampling PREX or CREX data now
Sanity checking: likelihoods_list = [<paper_jose.utils.NICERLikelihood_with_masses object at 0x151019d9e230>]
len(likelihoods_list) = 1
Fixed params loaded inside the MicroToMacroTransform:
    E_sat: -16.0
We are going to give these kwargs to Jim:
{'n_loop_training': 20, 'n_loop_production': 20, 'n_chains': 1000, 'n_local_steps': 2, 'n_global_steps': 100, 'n_epochs': 20, 'train_thinning': 1, 'output_thinning': 5}
We are going to sample the following parameters:
['E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_J0740']
No sample transforms provided. Using prior parameters as sampling parameters
Jim received the local sampler name: MALA
['n_dim', 'n_chains', 'n_local_steps', 'n_global_steps', 'n_loop', 'output_thinning', 'verbose']
log_prob
[-2.62098424e+02  1.04378239e-01 -3.96928676e+00]
Sampling seed is set to: 11
Global Tuning:   0%|          | 0/20 [00:00<?, ?it/s]Global Tuning:   5%|▌         | 1/20 [02:27<46:43, 147.53s/it]Global Tuning:  10%|█         | 2/20 [03:38<30:39, 102.21s/it]Global Tuning:  15%|█▌        | 3/20 [04:45<24:25, 86.21s/it] Global Tuning:  20%|██        | 4/20 [05:52<20:59, 78.71s/it]Global Tuning:  25%|██▌       | 5/20 [06:58<18:33, 74.21s/it]Global Tuning:  30%|███       | 6/20 [08:05<16:46, 71.88s/it]Global Tuning:  35%|███▌      | 7/20 [09:15<15:22, 70.99s/it]Global Tuning:  40%|████      | 8/20 [10:23<14:02, 70.17s/it]Global Tuning:  45%|████▌     | 9/20 [11:31<12:43, 69.42s/it]Global Tuning:  50%|█████     | 10/20 [12:39<11:29, 68.94s/it]Global Tuning:  55%|█████▌    | 11/20 [13:49<10:25, 69.50s/it]Global Tuning:  60%|██████    | 12/20 [14:56<09:08, 68.52s/it]Global Tuning:  65%|██████▌   | 13/20 [16:03<07:57, 68.25s/it]Global Tuning:  70%|███████   | 14/20 [17:11<06:48, 68.12s/it]Global Tuning:  75%|███████▌  | 15/20 [18:18<05:38, 67.70s/it]Global Tuning:  80%|████████  | 16/20 [19:25<04:29, 67.38s/it]Global Tuning:  85%|████████▌ | 17/20 [20:32<03:22, 67.41s/it]Global Tuning:  90%|█████████ | 18/20 [21:39<02:14, 67.38s/it]Global Tuning:  95%|█████████▌| 19/20 [22:48<01:07, 67.70s/it]Global Tuning: 100%|██████████| 20/20 [23:55<00:00, 67.50s/it]Global Tuning: 100%|██████████| 20/20 [23:55<00:00, 71.77s/it]
Compiling MALA body
Global Sampling:   0%|          | 0/20 [00:00<?, ?it/s]Global Sampling:   5%|▌         | 1/20 [01:06<21:09, 66.82s/it]Global Sampling:  10%|█         | 2/20 [02:10<19:32, 65.12s/it]Global Sampling:  15%|█▌        | 3/20 [03:15<18:23, 64.90s/it]Global Sampling:  20%|██        | 4/20 [04:23<17:36, 66.00s/it]Global Sampling:  25%|██▌       | 5/20 [05:31<16:41, 66.74s/it]Global Sampling:  30%|███       | 6/20 [06:39<15:41, 67.26s/it]Global Sampling:  35%|███▌      | 7/20 [07:50<14:51, 68.60s/it]Global Sampling:  40%|████      | 8/20 [08:57<13:36, 68.07s/it]Global Sampling:  45%|████▌     | 9/20 [10:05<12:26, 67.89s/it]Global Sampling:  50%|█████     | 10/20 [11:12<11:16, 67.69s/it]Global Sampling:  55%|█████▌    | 11/20 [12:20<10:11, 67.90s/it]Global Sampling:  60%|██████    | 12/20 [13:26<08:58, 67.33s/it]Global Sampling:  65%|██████▌   | 13/20 [14:33<07:50, 67.17s/it]Global Sampling:  70%|███████   | 14/20 [15:39<06:40, 66.68s/it]Global Sampling:  75%|███████▌  | 15/20 [16:45<05:32, 66.58s/it]Global Sampling:  80%|████████  | 16/20 [17:52<04:26, 66.67s/it]Global Sampling:  85%|████████▌ | 17/20 [18:59<03:20, 66.68s/it]Global Sampling:  90%|█████████ | 18/20 [20:06<02:13, 66.94s/it]Global Sampling:  95%|█████████▌| 19/20 [21:10<01:05, 65.93s/it]Global Sampling: 100%|██████████| 20/20 [22:17<00:00, 66.45s/it]Global Sampling: 100%|██████████| 20/20 [22:17<00:00, 66.89s/it]
Training summary
==========
E_sym: 36.539 +/- 4.897
L_sym: 103.148 +/- 54.159
K_sym: -95.974 +/- 114.284
Q_sym: 20.552 +/- 459.079
Z_sym: -498.826 +/- 1147.181
K_sat: 225.954 +/- 43.159
Q_sat: 328.642 +/- 459.633
Z_sat: -464.232 +/- 1146.309
nbreak: 0.246 +/- 0.045
n_CSE_0_u: 0.478 +/- 0.294
cs2_CSE_0: 0.653 +/- 0.235
n_CSE_1_u: 0.478 +/- 0.295
cs2_CSE_1: 0.544 +/- 0.285
n_CSE_2_u: 0.478 +/- 0.294
cs2_CSE_2: 0.514 +/- 0.287
n_CSE_3_u: 0.478 +/- 0.295
cs2_CSE_3: 0.503 +/- 0.287
n_CSE_4_u: 0.478 +/- 0.294
cs2_CSE_4: 0.496 +/- 0.285
n_CSE_5_u: 0.476 +/- 0.294
cs2_CSE_5: 0.500 +/- 0.287
n_CSE_6_u: 0.478 +/- 0.295
cs2_CSE_6: 0.498 +/- 0.286
n_CSE_7_u: 0.480 +/- 0.294
cs2_CSE_7: 0.499 +/- 0.287
cs2_CSE_8: 0.501 +/- 0.287
mass_J0740: 2.065 +/- 0.090
Log probability: -50.372 +/- 19.951
Local acceptance: 0.968 +/- 0.176
Global acceptance: 0.125 +/- 0.331
Max loss: 42.682, Min loss: 33.699
Production summary
==========
E_sym: 36.638 +/- 4.848
L_sym: 101.290 +/- 54.738
K_sym: -98.426 +/- 113.876
Q_sym: 17.605 +/- 456.668
Z_sym: -447.737 +/- 1161.510
K_sat: 230.828 +/- 44.726
Q_sat: 382.974 +/- 465.756
Z_sat: -484.290 +/- 1158.107
nbreak: 0.240 +/- 0.047
n_CSE_0_u: 0.476 +/- 0.295
cs2_CSE_0: 0.633 +/- 0.248
n_CSE_1_u: 0.448 +/- 0.310
cs2_CSE_1: 0.547 +/- 0.285
n_CSE_2_u: 0.469 +/- 0.294
cs2_CSE_2: 0.521 +/- 0.282
n_CSE_3_u: 0.464 +/- 0.295
cs2_CSE_3: 0.475 +/- 0.289
n_CSE_4_u: 0.473 +/- 0.293
cs2_CSE_4: 0.509 +/- 0.289
n_CSE_5_u: 0.474 +/- 0.291
cs2_CSE_5: 0.503 +/- 0.288
n_CSE_6_u: 0.496 +/- 0.302
cs2_CSE_6: 0.508 +/- 0.286
n_CSE_7_u: 0.497 +/- 0.295
cs2_CSE_7: 0.507 +/- 0.294
cs2_CSE_8: 0.513 +/- 0.288
mass_J0740: 2.062 +/- 0.083
Log probability: -49.145 +/- 0.989
Local acceptance: 0.946 +/- 0.227
Global acceptance: 0.077 +/- 0.267
S has been successful, now we will do some postprocessing. Sampling time: roughly 47 mins
Saving the final results
Number of samples generated in training: 420000
Number of samples generated in production: 420000
Number of samples generated: 840000
Time taken for TOV map: 2.3014492988586426 s
DONE entire script
suffix
J0740
Checking the convergence for outdir_J0740
list(data.keys())
['log_prob', 'E_sym', 'L_sym', 'K_sym', 'Q_sym', 'Z_sym', 'K_sat', 'Q_sat', 'Z_sat', 'nbreak', 'n_CSE_0_u', 'cs2_CSE_0', 'n_CSE_1_u', 'cs2_CSE_1', 'n_CSE_2_u', 'cs2_CSE_2', 'n_CSE_3_u', 'cs2_CSE_3', 'n_CSE_4_u', 'cs2_CSE_4', 'n_CSE_5_u', 'cs2_CSE_5', 'n_CSE_6_u', 'cs2_CSE_6', 'n_CSE_7_u', 'cs2_CSE_7', 'cs2_CSE_8', 'mass_J0740']
Key: E_sym
    rhat = 1.0619277331044257
    ess = 10021.296185204501
Key: L_sym
    rhat = 1.07095892203657
    ess = 8599.133176354937
Key: K_sym
    rhat = 1.0705580915929962
    ess = 8816.571439116013
Key: Q_sym
    rhat = 1.0657483057389
    ess = 9423.580548010987
Key: Z_sym
    rhat = 1.0701023372489455
    ess = 8958.223165693422
Key: K_sat
    rhat = 1.079174085216411
    ess = 7929.692817901197
Key: Q_sat
    rhat = 1.0722282023958813
    ess = 8709.587865858
Key: Z_sat
    rhat = 1.0758812476428647
    ess = 9075.866464894918
Key: nbreak
    rhat = 1.0780055755715816
    ess = 8005.1811245914905
Key: n_CSE_0_u
    rhat = 1.0693317995430605
    ess = 8914.495286604051
Key: cs2_CSE_0
    rhat = 1.0990290759544517
    ess = 6395.75590105562
Key: n_CSE_1_u
    rhat = 1.0832468637287744
    ess = 7507.961606319814
Key: cs2_CSE_1
    rhat = 1.0660786421307336
    ess = 9457.714444701984
Key: n_CSE_2_u
    rhat = 1.0691622091922441
    ess = 9132.83112425354
Key: cs2_CSE_2
    rhat = 1.0546911250636595
    ess = 11483.229480780448
Key: n_CSE_3_u
    rhat = 1.0680186945332795
    ess = 9083.371108123014
Key: cs2_CSE_3
    rhat = 1.067719572153546
    ess = 9180.045099188415
Key: n_CSE_4_u
    rhat = 1.063786097325231
    ess = 9828.321432982904
Key: cs2_CSE_4
    rhat = 1.0635449482460586
    ess = 9655.165643375001
Key: n_CSE_5_u
    rhat = 1.0667488879674578
    ess = 9164.790348712268
Key: cs2_CSE_5
    rhat = 1.0601048377063464
    ess = 10377.626392342836
Key: n_CSE_6_u
    rhat = 1.0743857044858938
    ess = 8368.490227611892
Key: cs2_CSE_6
    rhat = 1.0630193935934285
    ess = 9911.957276231435
Key: n_CSE_7_u
    rhat = 1.0672212659977263
    ess = 9235.415043980986
Key: cs2_CSE_7
    rhat = 1.0721118928437223
    ess = 8619.294507630642
Key: cs2_CSE_8
    rhat = 1.0662698567164306
    ess = 9278.881921104376
Key: mass_J0740
    rhat = 1.0713932124858843
    ess = 8933.915826896116
Making plots for outdir_J0740
Number of samples: 10000
Creating NS plot . . .
  0%|          | 0/3001 [00:00<?, ?it/s]  4%|▎         | 110/3001 [00:00<00:02, 1093.91it/s]  7%|▋         | 221/3001 [00:00<00:02, 1102.29it/s] 11%|█         | 332/3001 [00:00<00:03, 811.62it/s]  15%|█▍        | 446/3001 [00:00<00:02, 915.75it/s] 19%|█▊        | 559/3001 [00:00<00:02, 981.70it/s] 22%|██▏       | 673/3001 [00:00<00:02, 1028.66it/s] 26%|██▌       | 787/3001 [00:00<00:02, 1061.98it/s] 30%|██▉       | 896/3001 [00:00<00:02, 836.47it/s]  34%|███▎      | 1010/3001 [00:01<00:02, 913.19it/s] 37%|███▋      | 1125/3001 [00:01<00:01, 975.05it/s] 41%|████▏     | 1240/3001 [00:01<00:01, 1022.97it/s] 45%|████▌     | 1356/3001 [00:01<00:01, 1059.74it/s] 49%|████▉     | 1472/3001 [00:01<00:01, 1087.58it/s] 53%|█████▎    | 1584/3001 [00:01<00:01, 787.26it/s]  57%|█████▋    | 1698/3001 [00:01<00:01, 867.90it/s] 60%|██████    | 1813/3001 [00:01<00:01, 936.12it/s] 64%|██████▍   | 1927/3001 [00:02<00:01, 988.86it/s] 68%|██████▊   | 2042/3001 [00:02<00:00, 1030.36it/s] 72%|███████▏  | 2157/3001 [00:02<00:00, 1061.63it/s] 76%|███████▌  | 2271/3001 [00:02<00:00, 1083.61it/s] 80%|███████▉  | 2386/3001 [00:02<00:00, 1102.24it/s] 83%|████████▎ | 2499/3001 [00:02<00:00, 748.60it/s]  87%|████████▋ | 2614/3001 [00:02<00:00, 836.25it/s] 91%|█████████ | 2728/3001 [00:02<00:00, 908.63it/s] 95%|█████████▍| 2843/3001 [00:02<00:00, 968.00it/s] 99%|█████████▊| 2958/3001 [00:03<00:00, 1014.20it/s]100%|██████████| 3001/3001 [00:03<00:00, 962.07it/s] 
Bad counter: 1
Creating NS plot . . . DONE
Making histograms . . .
Reading Hauke data
Loading weights from /home/twouters2/hauke_eos/weights/J0740.txt
Weights at these bad indices
[0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 2.58272939e-05
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 3.68338059e-07]
Shape of mtov_list: (99941,)
Shape of r14_list: (99941,)
Shape of l14_list: (99941,)
Shape of ntov_list: (0,)
Shape of p3nsat_list: (99941,)
np.shape(weights)
(99941,)
Reading Hauke data DONE
Creating histograms . . .
  0%|          | 0/10000 [00:00<?, ?it/s] 51%|█████     | 5054/10000 [00:00<00:00, 50534.02it/s]100%|██████████| 10000/10000 [00:00<00:00, 50752.45it/s]
Negative counter: 4
Mass at 2 nsat: 1.21-0.80+1.31
MTOV credible interval for Jester



2.38-0.42+0.70 (at 0.95 HDI prob)



R1.4 credible interval for Jester



13.79-1.73+1.26 (at 0.95 HDI prob)



R1.4 credible interval for Jester



13.79-1.73+1.26 (at 0.95 HDI prob)



R1.4: 13.79-1.73+1.26
n_TOV: 5.1579 - 2.0361 + 1.7179
p3nsat credible interval for Jester



117.76-58.80+150.13 (at 0.95 HDI prob)



p3nsat: 117.76-58.80+150.13
Going to make the Hauke combination plot for outdir = outdir_J0740
  0%|          | 0/3001 [00:00<?, ?it/s]  9%|▉         | 275/3001 [00:00<00:00, 2747.25it/s] 18%|█▊        | 550/3001 [00:00<00:00, 2742.49it/s] 27%|██▋       | 825/3001 [00:00<00:00, 2734.50it/s] 37%|███▋      | 1099/3001 [00:00<00:00, 2732.53it/s] 46%|████▌     | 1373/3001 [00:00<00:00, 2727.39it/s] 55%|█████▍    | 1647/3001 [00:00<00:00, 2730.74it/s] 64%|██████▍   | 1921/3001 [00:01<00:00, 1131.70it/s] 73%|███████▎  | 2198/3001 [00:01<00:00, 1396.17it/s] 83%|████████▎ | 2478/3001 [00:01<00:00, 1658.78it/s] 92%|█████████▏| 2755/3001 [00:01<00:00, 1892.16it/s]100%|██████████| 3001/3001 [00:01<00:00, 1966.37it/s]
DONE

JOB STATISTICS
==============
Job ID: 11199623
Cluster: snellius
User/Group: twouters2/twouters2
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 00:49:45
CPU Efficiency: 6.31% of 13:08:48 core-walltime
Job Wall-clock time: 00:49:18
Memory Utilized: 2.86 GB
Memory Efficiency: 14.28% of 20.00 GB (20.00 GB/node)
